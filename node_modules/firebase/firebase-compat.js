!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()}(this,(function(){"use strict";!function(e){if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};p.prototype.append=function(e,t){e=h(e),t=d(t);var n=this.map[e];this.map[e]=n?n+","+t:t},p.prototype.delete=function(e){delete this.map[h(e)]},p.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},p.prototype.set=function(e,t){this.map[h(e)]=d(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),f(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),f(e)},n&&(p.prototype[Symbol.iterator]=p.prototype.entries);var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},v.call(w.prototype),v.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},I.error=function(){var e=new I(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];I.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new I(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=w,e.Response=I,e.fetch=function(e,t){return new Promise((function(n,i){var s=new w(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,r={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;n(new I(i,r))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&r&&(o.responseType="blob"),s.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),o.send(void 0===s._bodyInit?null:s._bodyInit)}))},e.fetch.polyfill=!0}function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function _(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(r&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&r&&a(e))this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(_)}),this.text=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=m(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function w(e,t){var n,r,i=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),u.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function I(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){var t={exports:{}};return e(t,t.exports),t.exports}var n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")(),i=function(e){try{return!!e()}catch(e){return!0}},s=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),o={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,c={f:a&&!o.call({1:2},1)?function(e){var t=a(this,e);return!!t&&t.enumerable}:o},u=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},l={}.toString,h=function(e){return l.call(e).slice(8,-1)},d="".split,f=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==h(e)?d.call(e,""):Object(e)}:Object,p=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},g=function(e){return f(p(e))},m=function(e){return"object"==typeof e?null!==e:"function"==typeof e},_=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},y={}.hasOwnProperty,v=function(e,t){return y.call(e,t)},w=r.document,b=m(w)&&m(w.createElement),I=function(e){return b?w.createElement(e):{}},T=!s&&!i((function(){return 7!=Object.defineProperty(I("div"),"a",{get:function(){return 7}}).a})),E=Object.getOwnPropertyDescriptor,S={f:s?E:function(e,t){if(e=g(e),t=_(t,!0),T)try{return E(e,t)}catch(e){}if(v(e,t))return u(!c.f.call(e,t),e[t])}},C=function(e){if(!m(e))throw TypeError(String(e)+" is not an object");return e},k=Object.defineProperty,R={f:s?k:function(e,t,n){if(C(e),t=_(t,!0),C(n),T)try{return k(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},N=s?function(e,t,n){return R.f(e,t,u(1,n))}:function(e,t,n){return e[t]=n,e},A=function(e,t){try{N(r,e,t)}catch(n){r[e]=t}return t},P="__core-js_shared__",x=r[P]||A(P,{}),D=Function.toString;"function"!=typeof x.inspectSource&&(x.inspectSource=function(e){return D.call(e)});var O,L,M,F=x.inspectSource,U=r.WeakMap,q="function"==typeof U&&/native code/.test(F(U)),j=!1,V=t((function(e){(e.exports=function(e,t){return x[e]||(x[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.1",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),B=0,W=Math.random(),$=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++B+W).toString(36)},z=V("keys"),K=function(e){return z[e]||(z[e]=$(e))},H={},G=r.WeakMap;if(q){var Q=x.state||(x.state=new G),Y=Q.get,J=Q.has,X=Q.set;O=function(e,t){return t.facade=e,X.call(Q,e,t),t},L=function(e){return Y.call(Q,e)||{}},M=function(e){return J.call(Q,e)}}else{var Z=K("state");H[Z]=!0,O=function(e,t){return t.facade=e,N(e,Z,t),t},L=function(e){return v(e,Z)?e[Z]:{}},M=function(e){return v(e,Z)}}var ee,te={set:O,get:L,has:M,enforce:function(e){return M(e)?L(e):O(e,{})},getterFor:function(e){return function(t){var n;if(!m(t)||(n=L(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},ne=t((function(e){var t=te.get,n=te.enforce,i=String(String).split("String");(e.exports=function(e,t,s,o){var a,c=!!o&&!!o.unsafe,u=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof s&&("string"!=typeof t||v(s,"name")||N(s,"name",t),(a=n(s)).source||(a.source=i.join("string"==typeof t?t:""))),e!==r?(c?!l&&e[t]&&(u=!0):delete e[t],u?e[t]=s:N(e,t,s)):u?e[t]=s:A(t,s)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||F(this)}))})),re=r,ie=function(e){return"function"==typeof e?e:void 0},se=function(e,t){return arguments.length<2?ie(re[e])||ie(r[e]):re[e]&&re[e][t]||r[e]&&r[e][t]},oe=Math.ceil,ae=Math.floor,ce=function(e){return isNaN(e=+e)?0:(e>0?ae:oe)(e)},ue=Math.min,le=function(e){return e>0?ue(ce(e),9007199254740991):0},he=Math.max,de=Math.min,fe=function(e){return function(t,n,r){var i,s=g(t),o=le(s.length),a=function(e,t){var n=ce(e);return n<0?he(n+t,0):de(n,t)}(r,o);if(e&&n!=n){for(;o>a;)if((i=s[a++])!=i)return!0}else for(;o>a;a++)if((e||a in s)&&s[a]===n)return e||a||0;return!e&&-1}},pe={includes:fe(!0),indexOf:fe(!1)}.indexOf,ge=function(e,t){var n,r=g(e),i=0,s=[];for(n in r)!v(H,n)&&v(r,n)&&s.push(n);for(;t.length>i;)v(r,n=t[i++])&&(~pe(s,n)||s.push(n));return s},me=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_e=me.concat("length","prototype"),ye={f:Object.getOwnPropertyNames||function(e){return ge(e,_e)}},ve={f:Object.getOwnPropertySymbols},we=se("Reflect","ownKeys")||function(e){var t=ye.f(C(e)),n=ve.f;return n?t.concat(n(e)):t},be=function(e,t){for(var n=we(t),r=R.f,i=S.f,s=0;s<n.length;s++){var o=n[s];v(e,o)||r(e,o,i(t,o))}},Ie=/#|\.prototype\./,Te=function(e,t){var n=Se[Ee(e)];return n==ke||n!=Ce&&("function"==typeof t?i(t):!!t)},Ee=Te.normalize=function(e){return String(e).replace(Ie,".").toLowerCase()},Se=Te.data={},Ce=Te.NATIVE="N",ke=Te.POLYFILL="P",Re=Te,Ne=S.f,Ae=function(e,t){var n,i,s,o,a,c=e.target,u=e.global,l=e.stat;if(n=u?r:l?r[c]||A(c,{}):(r[c]||{}).prototype)for(i in t){if(o=t[i],s=e.noTargetGet?(a=Ne(n,i))&&a.value:n[i],!Re(u?i:c+(l?".":"#")+i,e.forced)&&void 0!==s){if(typeof o==typeof s)continue;be(o,s)}(e.sham||s&&s.sham)&&N(o,"sham",!0),ne(n,i,o,e)}},Pe=function(e){return Object(p(e))},xe=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),De=K("IE_PROTO"),Oe=Object.prototype,Le=xe?Object.getPrototypeOf:function(e){return e=Pe(e),v(e,De)?e[De]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Oe:null},Me=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return C(n),function(e){if(!m(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),Fe=Object.keys||function(e){return ge(e,me)},Ue=s?Object.defineProperties:function(e,t){C(e);for(var n,r=Fe(t),i=r.length,s=0;i>s;)R.f(e,n=r[s++],t[n]);return e},qe=se("document","documentElement"),je=K("IE_PROTO"),Ve=function(){},Be=function(e){return"<script>"+e+"</"+"script>"},We=function(){try{ee=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;We=ee?function(e){e.write(Be("")),e.close();var t=e.parentWindow.Object;return e=null,t}(ee):((t=I("iframe")).style.display="none",qe.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Be("document.F=Object")),e.close(),e.F);for(var n=me.length;n--;)delete We.prototype[me[n]];return We()};H[je]=!0;var $e=Object.create||function(e,t){var n;return null!==e?(Ve.prototype=C(e),n=new Ve,Ve.prototype=null,n[je]=e):n=We(),void 0===t?n:Ue(n,t)},ze=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())})),Ke=ze&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,He=V("wks"),Ge=r.Symbol,Qe=Ke?Ge:Ge&&Ge.withoutSetter||$,Ye=function(e){return v(He,e)||(ze&&v(Ge,e)?He[e]=Ge[e]:He[e]=Qe("Symbol."+e)),He[e]},Je={},Xe=Ye("iterator"),Ze=Array.prototype,et=function(e){return void 0!==e&&(Je.Array===e||Ze[Xe]===e)},tt=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},nt=function(e,t,n){if(tt(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},rt={};rt[Ye("toStringTag")]="z";var it="[object z]"===String(rt),st=Ye("toStringTag"),ot="Arguments"==h(function(){return arguments}()),at=it?h:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),st))?n:ot?h(t):"Object"==(r=h(t))&&"function"==typeof t.callee?"Arguments":r},ct=Ye("iterator"),ut=function(e){if(null!=e)return e[ct]||e["@@iterator"]||Je[at(e)]},lt=function(e){var t=e.return;if(void 0!==t)return C(t.call(e)).value},ht=function(e,t){this.stopped=e,this.result=t},dt=function(e,t,n){var r,i,s,o,a,c,u,l=n&&n.that,h=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),p=nt(t,l,1+h+f),g=function(e){return r&&lt(r),new ht(!0,e)},m=function(e){return h?(C(e),f?p(e[0],e[1],g):p(e[0],e[1])):f?p(e,g):p(e)};if(d)r=e;else{if("function"!=typeof(i=ut(e)))throw TypeError("Target is not iterable");if(et(i)){for(s=0,o=le(e.length);o>s;s++)if((a=m(e[s]))&&a instanceof ht)return a;return new ht(!1)}r=i.call(e)}for(c=r.next;!(u=c.call(r)).done;){try{a=m(u.value)}catch(e){throw lt(r),e}if("object"==typeof a&&a&&a instanceof ht)return a}return new ht(!1)},ft=function(e,t){var n=this;if(!(n instanceof ft))return new ft(e,t);Me&&(n=Me(new Error(void 0),Le(n))),void 0!==t&&N(n,"message",String(t));var r=[];return dt(e,r.push,{that:r}),N(n,"errors",r),n};ft.prototype=$e(Error.prototype,{constructor:u(5,ft),message:u(5,""),name:u(5,"AggregateError")}),Ae({global:!0},{AggregateError:ft});var pt=it?{}.toString:function(){return"[object "+at(this)+"]"};it||ne(Object.prototype,"toString",pt,{unsafe:!0});var gt=r.Promise,mt=function(e,t,n){for(var r in t)ne(e,r,t[r],n);return e},_t=R.f,yt=Ye("toStringTag"),vt=function(e,t,n){e&&!v(e=n?e:e.prototype,yt)&&_t(e,yt,{configurable:!0,value:t})},wt=Ye("species"),bt=function(e){var t=se(e),n=R.f;s&&t&&!t[wt]&&n(t,wt,{configurable:!0,get:function(){return this}})},It=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Tt=Ye("iterator"),Et=!1;try{var St=0,Ct={next:function(){return{done:!!St++}},return:function(){Et=!0}};Ct[Tt]=function(){return this},Array.from(Ct,(function(){throw 2}))}catch(Wd){}var kt,Rt,Nt,At=function(e,t){if(!t&&!Et)return!1;var n=!1;try{var r={};r[Tt]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Pt=Ye("species"),xt=function(e,t){var n,r=C(e).constructor;return void 0===r||null==(n=C(r)[Pt])?t:tt(n)},Dt=se("navigator","userAgent")||"",Ot=/(iphone|ipod|ipad).*applewebkit/i.test(Dt),Lt="process"==h(r.process),Mt=r.location,Ft=r.setImmediate,Ut=r.clearImmediate,qt=r.process,jt=r.MessageChannel,Vt=r.Dispatch,Bt=0,Wt={},$t="onreadystatechange",zt=function(e){if(Wt.hasOwnProperty(e)){var t=Wt[e];delete Wt[e],t()}},Kt=function(e){return function(){zt(e)}},Ht=function(e){zt(e.data)},Gt=function(e){r.postMessage(e+"",Mt.protocol+"//"+Mt.host)};Ft&&Ut||(Ft=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Wt[++Bt]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},kt(Bt),Bt},Ut=function(e){delete Wt[e]},Lt?kt=function(e){qt.nextTick(Kt(e))}:Vt&&Vt.now?kt=function(e){Vt.now(Kt(e))}:jt&&!Ot?(Nt=(Rt=new jt).port2,Rt.port1.onmessage=Ht,kt=nt(Nt.postMessage,Nt,1)):r.addEventListener&&"function"==typeof postMessage&&!r.importScripts&&Mt&&"file:"!==Mt.protocol&&!i(Gt)?(kt=Gt,r.addEventListener("message",Ht,!1)):kt=$t in I("script")?function(e){qe.appendChild(I("script")).onreadystatechange=function(){qe.removeChild(this),zt(e)}}:function(e){setTimeout(Kt(e),0)});var Qt,Yt,Jt,Xt,Zt,en,tn,nn,rn={set:Ft,clear:Ut},sn=S.f,on=rn.set,an=r.MutationObserver||r.WebKitMutationObserver,cn=r.document,un=r.process,ln=r.Promise,hn=sn(r,"queueMicrotask"),dn=hn&&hn.value;dn||(Qt=function(){var e,t;for(Lt&&(e=un.domain)&&e.exit();Yt;){t=Yt.fn,Yt=Yt.next;try{t()}catch(e){throw Yt?Xt():Jt=void 0,e}}Jt=void 0,e&&e.enter()},!Ot&&!Lt&&an&&cn?(Zt=!0,en=cn.createTextNode(""),new an(Qt).observe(en,{characterData:!0}),Xt=function(){en.data=Zt=!Zt}):ln&&ln.resolve?(tn=ln.resolve(void 0),nn=tn.then,Xt=function(){nn.call(tn,Qt)}):Xt=Lt?function(){un.nextTick(Qt)}:function(){on.call(r,Qt)});var fn,pn,gn=dn||function(e){var t={fn:e,next:void 0};Jt&&(Jt.next=t),Yt||(Yt=t,Xt()),Jt=t},mn=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=tt(t),this.reject=tt(n)},_n={f:function(e){return new mn(e)}},yn=function(e,t){if(C(e),m(t)&&t.constructor===e)return t;var n=_n.f(e);return(0,n.resolve)(t),n.promise},vn=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},wn=r.process,bn=wn&&wn.versions,In=bn&&bn.v8;In?pn=(fn=In.split("."))[0]+fn[1]:Dt&&(!(fn=Dt.match(/Edge\/(\d+)/))||fn[1]>=74)&&(fn=Dt.match(/Chrome\/(\d+)/))&&(pn=fn[1]);var Tn,En,Sn,Cn,kn=pn&&+pn,Rn=rn.set,Nn=Ye("species"),An="Promise",Pn=te.get,xn=te.set,Dn=te.getterFor(An),On=gt,Ln=r.TypeError,Mn=r.document,Fn=r.process,Un=se("fetch"),qn=_n.f,jn=qn,Vn=!!(Mn&&Mn.createEvent&&r.dispatchEvent),Bn="function"==typeof PromiseRejectionEvent,Wn="unhandledrejection",$n=Re(An,(function(){if(!(F(On)!==String(On))){if(66===kn)return!0;if(!Lt&&!Bn)return!0}if(kn>=51&&/native code/.test(On))return!1;var e=On.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[Nn]=t,!(e.then((function(){}))instanceof t)})),zn=$n||!At((function(e){On.all(e).catch((function(){}))})),Kn=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},Hn=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;gn((function(){for(var r=e.value,i=1==e.state,s=0;n.length>s;){var o,a,c,u=n[s++],l=i?u.ok:u.fail,h=u.resolve,d=u.reject,f=u.domain;try{l?(i||(2===e.rejection&&Jn(e),e.rejection=1),!0===l?o=r:(f&&f.enter(),o=l(r),f&&(f.exit(),c=!0)),o===u.promise?d(Ln("Promise-chain cycle")):(a=Kn(o))?a.call(o,h,d):h(o)):d(r)}catch(e){f&&!c&&f.exit(),d(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Qn(e)}))}},Gn=function(e,t,n){var i,s;Vn?((i=Mn.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),r.dispatchEvent(i)):i={promise:t,reason:n},!Bn&&(s=r["on"+e])?s(i):e===Wn&&function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Qn=function(e){Rn.call(r,(function(){var t,n=e.facade,r=e.value;if(Yn(e)&&(t=vn((function(){Lt?Fn.emit("unhandledRejection",r,n):Gn(Wn,n,r)})),e.rejection=Lt||Yn(e)?2:1,t.error))throw t.value}))},Yn=function(e){return 1!==e.rejection&&!e.parent},Jn=function(e){Rn.call(r,(function(){var t=e.facade;Lt?Fn.emit("rejectionHandled",t):Gn("rejectionhandled",t,e.value)}))},Xn=function(e,t,n){return function(r){e(t,r,n)}},Zn=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Hn(e,!0))},er=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Ln("Promise can't be resolved itself");var r=Kn(t);r?gn((function(){var n={done:!1};try{r.call(t,Xn(er,n,e),Xn(Zn,n,e))}catch(t){Zn(n,t,e)}})):(e.value=t,e.state=1,Hn(e,!1))}catch(t){Zn({done:!1},t,e)}}};$n&&(On=function(e){It(this,On,An),tt(e),Tn.call(this);var t=Pn(this);try{e(Xn(er,t),Xn(Zn,t))}catch(e){Zn(t,e)}},(Tn=function(e){xn(this,{type:An,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=mt(On.prototype,{then:function(e,t){var n=Dn(this),r=qn(xt(this,On));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Lt?Fn.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&Hn(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),En=function(){var e=new Tn,t=Pn(e);this.promise=e,this.resolve=Xn(er,t),this.reject=Xn(Zn,t)},_n.f=qn=function(e){return e===On||e===Sn?new En(e):jn(e)},"function"==typeof gt&&(Cn=gt.prototype.then,ne(gt.prototype,"then",(function(e,t){var n=this;return new On((function(e,t){Cn.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof Un&&Ae({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return yn(On,Un.apply(r,arguments))}}))),Ae({global:!0,wrap:!0,forced:$n},{Promise:On}),vt(On,An,!1),bt(An),Sn=se(An),Ae({target:An,stat:!0,forced:$n},{reject:function(e){var t=qn(this);return t.reject.call(void 0,e),t.promise}}),Ae({target:An,stat:!0,forced:$n},{resolve:function(e){return yn(this,e)}}),Ae({target:An,stat:!0,forced:zn},{all:function(e){var t=this,n=qn(t),r=n.resolve,i=n.reject,s=vn((function(){var n=tt(t.resolve),s=[],o=0,a=1;dt(e,(function(e){var c=o++,u=!1;s.push(void 0),a++,n.call(t,e).then((function(e){u||(u=!0,s[c]=e,--a||r(s))}),i)})),--a||r(s)}));return s.error&&i(s.value),n.promise},race:function(e){var t=this,n=qn(t),r=n.reject,i=vn((function(){var i=tt(t.resolve);dt(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}}),Ae({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=_n.f(t),r=n.resolve,i=n.reject,s=vn((function(){var n=tt(t.resolve),i=[],s=0,o=1;dt(e,(function(e){var a=s++,c=!1;i.push(void 0),o++,n.call(t,e).then((function(e){c||(c=!0,i[a]={status:"fulfilled",value:e},--o||r(i))}),(function(e){c||(c=!0,i[a]={status:"rejected",reason:e},--o||r(i))}))})),--o||r(i)}));return s.error&&i(s.value),n.promise}});var tr="No one promise resolved";Ae({target:"Promise",stat:!0},{any:function(e){var t=this,n=_n.f(t),r=n.resolve,i=n.reject,s=vn((function(){var n=tt(t.resolve),s=[],o=0,a=1,c=!1;dt(e,(function(e){var u=o++,l=!1;s.push(void 0),a++,n.call(t,e).then((function(e){l||c||(c=!0,r(e))}),(function(e){l||c||(l=!0,s[u]=e,--a||i(new(se("AggregateError"))(s,tr)))}))})),--a||i(new(se("AggregateError"))(s,tr))}));return s.error&&i(s.value),n.promise}});var nr=!!gt&&i((function(){gt.prototype.finally.call({then:function(){}},(function(){}))}));Ae({target:"Promise",proto:!0,real:!0,forced:nr},{finally:function(e){var t=xt(this,se("Promise")),n="function"==typeof e;return this.then(n?function(n){return yn(t,e()).then((function(){return n}))}:e,n?function(n){return yn(t,e()).then((function(){throw n}))}:e)}}),"function"!=typeof gt||gt.prototype.finally||ne(gt.prototype,"finally",se("Promise").prototype.finally);var rr,ir,sr,or=function(e){return function(t,n){var r,i,s=String(p(t)),o=ce(n),a=s.length;return o<0||o>=a?e?"":void 0:(r=s.charCodeAt(o))<55296||r>56319||o+1===a||(i=s.charCodeAt(o+1))<56320||i>57343?e?s.charAt(o):r:e?s.slice(o,o+2):i-56320+(r-55296<<10)+65536}},ar={codeAt:or(!1),charAt:or(!0)},cr=Ye("iterator"),ur=!1;[].keys&&("next"in(sr=[].keys())?(ir=Le(Le(sr)))!==Object.prototype&&(rr=ir):ur=!0),null==rr&&(rr={}),v(rr,cr)||N(rr,cr,(function(){return this}));var lr={IteratorPrototype:rr,BUGGY_SAFARI_ITERATORS:ur},hr=lr.IteratorPrototype,dr=function(){return this},fr=lr.IteratorPrototype,pr=lr.BUGGY_SAFARI_ITERATORS,gr=Ye("iterator"),mr="keys",_r="values",yr="entries",vr=function(){return this},wr=function(e,t,n,r,i,s,o){!function(e,t,n){var r=t+" Iterator";e.prototype=$e(hr,{next:u(1,n)}),vt(e,r,!1),Je[r]=dr}(n,t,r);var a,c,l,h=function(e){if(e===i&&m)return m;if(!pr&&e in p)return p[e];switch(e){case mr:case _r:case yr:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",f=!1,p=e.prototype,g=p[gr]||p["@@iterator"]||i&&p[i],m=!pr&&g||h(i),_="Array"==t&&p.entries||g;if(_&&(a=Le(_.call(new e)),fr!==Object.prototype&&a.next&&(Le(a)!==fr&&(Me?Me(a,fr):"function"!=typeof a[gr]&&N(a,gr,vr)),vt(a,d,!0))),i==_r&&g&&g.name!==_r&&(f=!0,m=function(){return g.call(this)}),p[gr]!==m&&N(p,gr,m),Je[t]=m,i)if(c={values:h(_r),keys:s?m:h(mr),entries:h(yr)},o)for(l in c)(pr||f||!(l in p))&&ne(p,l,c[l]);else Ae({target:t,proto:!0,forced:pr||f},c);return c},br=ar.charAt,Ir="String Iterator",Tr=te.set,Er=te.getterFor(Ir);wr(String,"String",(function(e){Tr(this,{type:Ir,string:String(e),index:0})}),(function(){var e,t=Er(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=br(n,r),t.index+=e.length,{value:e,done:!1})}));var Sr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Cr=Ye("unscopables"),kr=Array.prototype;null==kr[Cr]&&R.f(kr,Cr,{configurable:!0,value:$e(null)});var Rr=function(e){kr[Cr][e]=!0},Nr="Array Iterator",Ar=te.set,Pr=te.getterFor(Nr),xr=wr(Array,"Array",(function(e,t){Ar(this,{type:Nr,target:g(e),index:0,kind:t})}),(function(){var e=Pr(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");Je.Arguments=Je.Array,Rr("keys"),Rr("values"),Rr("entries");var Dr=Ye("iterator"),Or=Ye("toStringTag"),Lr=xr.values;for(var Mr in Sr){var Fr=r[Mr],Ur=Fr&&Fr.prototype;if(Ur){if(Ur[Dr]!==Lr)try{N(Ur,Dr,Lr)}catch(Wd){Ur[Dr]=Lr}if(Ur[Or]||N(Ur,Or,Mr),Sr[Mr])for(var qr in xr)if(Ur[qr]!==xr[qr])try{N(Ur,qr,xr[qr])}catch(Wd){Ur[qr]=xr[qr]}}}re.Promise;Ae({target:"Promise",stat:!0},{try:function(e){var t=_n.f(this),n=vn(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var jr=Array.isArray||function(e){return"Array"==h(e)},Vr=Ye("species"),Br=function(e,t){var n;return jr(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!jr(n.prototype)?m(n)&&null===(n=n[Vr])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Wr=[].push,$r=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,o=7==e,a=5==e||s;return function(c,u,l,h){for(var d,p,g=Pe(c),m=f(g),_=nt(u,l,3),y=le(m.length),v=0,w=h||Br,b=t?w(c,y):n||o?w(c,0):void 0;y>v;v++)if((a||v in m)&&(p=_(d=m[v],v,g),e))if(t)b[v]=p;else if(p)switch(e){case 3:return!0;case 5:return d;case 6:return v;case 2:Wr.call(b,d)}else switch(e){case 4:return!1;case 7:Wr.call(b,d)}return s?-1:r||i?i:b}},zr={forEach:$r(0),map:$r(1),filter:$r(2),some:$r(3),every:$r(4),find:$r(5),findIndex:$r(6),filterOut:$r(7)},Kr=Object.defineProperty,Hr={},Gr=function(e){throw e},Qr=function(e,t){if(v(Hr,e))return Hr[e];t||(t={});var n=[][e],r=!!v(t,"ACCESSORS")&&t.ACCESSORS,o=v(t,0)?t[0]:Gr,a=v(t,1)?t[1]:void 0;return Hr[e]=!!n&&!i((function(){if(r&&!s)return!0;var e={length:-1};r?Kr(e,1,{enumerable:!0,get:Gr}):e[1]=1,n.call(e,o,a)}))},Yr=zr.find,Jr="find",Xr=!0,Zr=Qr(Jr);Jr in[]&&Array(1).find((function(){Xr=!1})),Ae({target:"Array",proto:!0,forced:Xr||!Zr},{find:function(e){return Yr(this,e,arguments.length>1?arguments[1]:void 0)}}),Rr(Jr);var ei=Function.call,ti=function(e,t,n){return nt(ei,r[e].prototype[t],n)},ni=(ti("Array","find"),zr.findIndex),ri="findIndex",ii=!0,si=Qr(ri);ri in[]&&Array(1).findIndex((function(){ii=!1})),Ae({target:"Array",proto:!0,forced:ii||!si},{findIndex:function(e){return ni(this,e,arguments.length>1?arguments[1]:void 0)}}),Rr(ri);ti("Array","findIndex");var oi=function(e,t,n,r){try{return r?t(C(n)[0],n[1]):t(n)}catch(t){throw lt(e),t}},ai=function(e,t,n){var r=_(t);r in e?R.f(e,r,u(0,n)):e[r]=n},ci=!At((function(e){Array.from(e)}));Ae({target:"Array",stat:!0,forced:ci},{from:function(e){var t,n,r,i,s,o,a=Pe(e),c="function"==typeof this?this:Array,u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,d=ut(a),f=0;if(h&&(l=nt(l,u>2?arguments[2]:void 0,2)),null==d||c==Array&&et(d))for(n=new c(t=le(a.length));t>f;f++)o=h?l(a[f],f):a[f],ai(n,f,o);else for(s=(i=d.call(a)).next,n=new c;!(r=s.call(i)).done;f++)o=h?oi(i,l,[r.value,f],!0):r.value,ai(n,f,o);return n.length=f,n}});re.Array.from;var ui=zr.some,li=function(e,t){var n=[][e];return!!n&&i((function(){n.call(null,t||function(){throw 1},1)}))}("some"),hi=Qr("some");Ae({target:"Array",proto:!0,forced:!li||!hi},{some:function(e){return ui(this,e,arguments.length>1?arguments[1]:void 0)}});ti("Array","some");var di,fi="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,pi=R.f,gi=r.Int8Array,mi=gi&&gi.prototype,_i=r.Uint8ClampedArray,yi=_i&&_i.prototype,vi=gi&&Le(gi),wi=mi&&Le(mi),bi=Object.prototype,Ii=(bi.isPrototypeOf,Ye("toStringTag")),Ti=$("TYPED_ARRAY_TAG"),Ei=fi&&!!Me&&"Opera"!==at(r.opera),Si={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ci={BigInt64Array:8,BigUint64Array:8},ki=function(e){if(!m(e))return!1;var t=at(e);return v(Si,t)||v(Ci,t)};for(di in Si)r[di]||(Ei=!1);if((!Ei||"function"!=typeof vi||vi===Function.prototype)&&(vi=function(){throw TypeError("Incorrect invocation")},Ei))for(di in Si)r[di]&&Me(r[di],vi);if((!Ei||!wi||wi===bi)&&(wi=vi.prototype,Ei))for(di in Si)r[di]&&Me(r[di].prototype,wi);if(Ei&&Le(yi)!==wi&&Me(yi,wi),s&&!v(wi,Ii))for(di in!0,pi(wi,Ii,{get:function(){return m(this)?this[Ti]:void 0}}),Si)r[di]&&N(r[di],Ti,di);var Ri=function(e){if(ki(e))return e;throw TypeError("Target is not a typed array")},Ni=function(e,t,n){if(s){if(n)for(var i in Si){var o=r[i];o&&v(o.prototype,e)&&delete o.prototype[e]}wi[e]&&!n||ne(wi,e,n?t:Ei&&mi[e]||t)}},Ai=Ye("iterator"),Pi=r.Uint8Array,xi=xr.values,Di=xr.keys,Oi=xr.entries,Li=Ri,Mi=Ni,Fi=Pi&&Pi.prototype[Ai],Ui=!!Fi&&("values"==Fi.name||null==Fi.name),qi=function(){return xi.call(Li(this))};Mi("entries",(function(){return Oi.call(Li(this))})),Mi("keys",(function(){return Di.call(Li(this))})),Mi("values",qi,!Ui),Mi(Ai,qi,!Ui);var ji=Object.assign,Vi=Object.defineProperty,Bi=!ji||i((function(){if(s&&1!==ji({b:1},ji(Vi({},"a",{enumerable:!0,get:function(){Vi(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=ji({},e)[n]||Fe(ji({},t)).join("")!=r}))?function(e,t){for(var n=Pe(e),r=arguments.length,i=1,o=ve.f,a=c.f;r>i;)for(var u,l=f(arguments[i++]),h=o?Fe(l).concat(o(l)):Fe(l),d=h.length,p=0;d>p;)u=h[p++],s&&!a.call(l,u)||(n[u]=l[u]);return n}:ji;Ae({target:"Object",stat:!0,forced:Object.assign!==Bi},{assign:Bi});re.Object.assign;var Wi=c.f,$i=function(e){return function(t){for(var n,r=g(t),i=Fe(r),o=i.length,a=0,c=[];o>a;)n=i[a++],s&&!Wi.call(r,n)||c.push(e?[n,r[n]]:r[n]);return c}},zi={entries:$i(!0),values:$i(!1)},Ki=zi.entries;Ae({target:"Object",stat:!0},{entries:function(e){return Ki(e)}});re.Object.entries;var Hi=zi.values;Ae({target:"Object",stat:!0},{values:function(e){return Hi(e)}});re.Object.values;var Gi=Ye("match"),Qi=function(e){if(function(e){var t;return m(e)&&(void 0!==(t=e[Gi])?!!t:"RegExp"==h(e))}(e))throw TypeError("The method doesn't accept regular expressions");return e},Yi=Ye("match"),Ji=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Yi]=!1,"/./"[e](t)}catch(e){}}return!1};Ae({target:"String",proto:!0,forced:!Ji("includes")},{includes:function(e){return!!~String(p(this)).indexOf(Qi(e),arguments.length>1?arguments[1]:void 0)}});ti("String","includes");var Xi,Zi=S.f,es="".startsWith,ts=Math.min,ns=Ji("startsWith"),rs=!(ns||(Xi=Zi(String.prototype,"startsWith"),!Xi||Xi.writable));Ae({target:"String",proto:!0,forced:!rs&&!ns},{startsWith:function(e){var t=String(p(this));Qi(e);var n=le(ts(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return es?es.call(t,r,n):t.slice(n,n+r.length)===r}});ti("String","startsWith");Ae({target:"String",proto:!0},{repeat:"".repeat||function(e){var t=String(p(this)),n="",r=ce(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}});ti("String","repeat");var is=Ye("species"),ss=Ye("isConcatSpreadable"),os=9007199254740991,as="Maximum allowed index exceeded",cs=kn>=51||!i((function(){var e=[];return e[ss]=!1,e.concat()[0]!==e})),us=function(e){return kn>=51||!i((function(){var t=[];return(t.constructor={})[is]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}("concat"),ls=function(e){if(!m(e))return!1;var t=e[ss];return void 0!==t?!!t:jr(e)};Ae({target:"Array",proto:!0,forced:!cs||!us},{concat:function(e){var t,n,r,i,s,o=Pe(this),a=Br(o,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(ls(s=-1===t?o:arguments[t])){if(c+(i=le(s.length))>os)throw TypeError(as);for(n=0;n<i;n++,c++)n in s&&ai(a,c,s[n])}else{if(c>=os)throw TypeError(as);ai(a,c++,s)}return a.length=c,a}});var hs=ye.f,ds={}.toString,fs="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ps={f:function(e){return fs&&"[object Window]"==ds.call(e)?function(e){try{return hs(e)}catch(e){return fs.slice()}}(e):hs(g(e))}},gs={f:Ye},ms=R.f,_s=function(e){var t=re.Symbol||(re.Symbol={});v(t,e)||ms(t,e,{value:gs.f(e)})},ys=zr.forEach,vs=K("hidden"),ws="Symbol",bs=Ye("toPrimitive"),Is=te.set,Ts=te.getterFor(ws),Es=Object.prototype,Ss=r.Symbol,Cs=se("JSON","stringify"),ks=S.f,Rs=R.f,Ns=ps.f,As=c.f,Ps=V("symbols"),xs=V("op-symbols"),Ds=V("string-to-symbol-registry"),Os=V("symbol-to-string-registry"),Ls=V("wks"),Ms=r.QObject,Fs=!Ms||!Ms.prototype||!Ms.prototype.findChild,Us=s&&i((function(){return 7!=$e(Rs({},"a",{get:function(){return Rs(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=ks(Es,t);r&&delete Es[t],Rs(e,t,n),r&&e!==Es&&Rs(Es,t,r)}:Rs,qs=function(e,t){var n=Ps[e]=$e(Ss.prototype);return Is(n,{type:ws,tag:e,description:t}),s||(n.description=t),n},js=Ke?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Ss},Vs=function(e,t,n){e===Es&&Vs(xs,t,n),C(e);var r=_(t,!0);return C(n),v(Ps,r)?(n.enumerable?(v(e,vs)&&e[vs][r]&&(e[vs][r]=!1),n=$e(n,{enumerable:u(0,!1)})):(v(e,vs)||Rs(e,vs,u(1,{})),e[vs][r]=!0),Us(e,r,n)):Rs(e,r,n)},Bs=function(e,t){C(e);var n=g(t),r=Fe(n).concat(Ks(n));return ys(r,(function(t){s&&!Ws.call(n,t)||Vs(e,t,n[t])})),e},Ws=function(e){var t=_(e,!0),n=As.call(this,t);return!(this===Es&&v(Ps,t)&&!v(xs,t))&&(!(n||!v(this,t)||!v(Ps,t)||v(this,vs)&&this[vs][t])||n)},$s=function(e,t){var n=g(e),r=_(t,!0);if(n!==Es||!v(Ps,r)||v(xs,r)){var i=ks(n,r);return!i||!v(Ps,r)||v(n,vs)&&n[vs][r]||(i.enumerable=!0),i}},zs=function(e){var t=Ns(g(e)),n=[];return ys(t,(function(e){v(Ps,e)||v(H,e)||n.push(e)})),n},Ks=function(e){var t=e===Es,n=Ns(t?xs:g(e)),r=[];return ys(n,(function(e){!v(Ps,e)||t&&!v(Es,e)||r.push(Ps[e])})),r};if(ze||(ne((Ss=function(){if(this instanceof Ss)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=$(e),n=function(e){this===Es&&n.call(xs,e),v(this,vs)&&v(this[vs],t)&&(this[vs][t]=!1),Us(this,t,u(1,e))};return s&&Fs&&Us(Es,t,{configurable:!0,set:n}),qs(t,e)}).prototype,"toString",(function(){return Ts(this).tag})),ne(Ss,"withoutSetter",(function(e){return qs($(e),e)})),c.f=Ws,R.f=Vs,S.f=$s,ye.f=ps.f=zs,ve.f=Ks,gs.f=function(e){return qs(Ye(e),e)},s&&(Rs(Ss.prototype,"description",{configurable:!0,get:function(){return Ts(this).description}}),ne(Es,"propertyIsEnumerable",Ws,{unsafe:!0}))),Ae({global:!0,wrap:!0,forced:!ze,sham:!ze},{Symbol:Ss}),ys(Fe(Ls),(function(e){_s(e)})),Ae({target:ws,stat:!0,forced:!ze},{for:function(e){var t=String(e);if(v(Ds,t))return Ds[t];var n=Ss(t);return Ds[t]=n,Os[n]=t,n},keyFor:function(e){if(!js(e))throw TypeError(e+" is not a symbol");if(v(Os,e))return Os[e]},useSetter:function(){Fs=!0},useSimple:function(){Fs=!1}}),Ae({target:"Object",stat:!0,forced:!ze,sham:!s},{create:function(e,t){return void 0===t?$e(e):Bs($e(e),t)},defineProperty:Vs,defineProperties:Bs,getOwnPropertyDescriptor:$s}),Ae({target:"Object",stat:!0,forced:!ze},{getOwnPropertyNames:zs,getOwnPropertySymbols:Ks}),Ae({target:"Object",stat:!0,forced:i((function(){ve.f(1)}))},{getOwnPropertySymbols:function(e){return ve.f(Pe(e))}}),Cs){var Hs=!ze||i((function(){var e=Ss();return"[null]"!=Cs([e])||"{}"!=Cs({a:e})||"{}"!=Cs(Object(e))}));Ae({target:"JSON",stat:!0,forced:Hs},{stringify:function(e,t,n){for(var r,i=[e],s=1;arguments.length>s;)i.push(arguments[s++]);if(r=t,(m(t)||void 0!==e)&&!js(e))return jr(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!js(t))return t}),i[1]=t,Cs.apply(null,i)}})}Ss.prototype[bs]||N(Ss.prototype,bs,Ss.prototype.valueOf),vt(Ss,ws),H[vs]=!0,_s("asyncIterator");var Gs=R.f,Qs=r.Symbol;if(s&&"function"==typeof Qs&&(!("description"in Qs.prototype)||void 0!==Qs().description)){var Ys={},Js=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Js?new Qs(e):void 0===e?Qs():Qs(e);return""===e&&(Ys[t]=!0),t};be(Js,Qs);var Xs=Js.prototype=Qs.prototype;Xs.constructor=Js;var Zs=Xs.toString,eo="Symbol(test)"==String(Qs("test")),to=/^Symbol\((.*)\)[^)]+$/;Gs(Xs,"description",{configurable:!0,get:function(){var e=m(this)?this.valueOf():this,t=Zs.call(e);if(v(Ys,e))return"";var n=eo?t.slice(7,-1):t.replace(to,"$1");return""===n?void 0:n}}),Ae({global:!0,forced:!0},{Symbol:Js})}_s("hasInstance"),_s("isConcatSpreadable"),_s("iterator"),_s("match"),_s("matchAll"),_s("replace"),_s("search"),_s("species"),_s("split"),_s("toPrimitive"),_s("toStringTag"),_s("unscopables"),vt(r.JSON,"JSON",!0),vt(Math,"Math",!0),Ae({global:!0},{Reflect:{}}),vt(r.Reflect,"Reflect",!0);re.Symbol;_s("asyncDispose"),_s("dispose"),_s("observable"),_s("patternMatch"),_s("replaceAll");gs.f("iterator");var no=!i((function(){return Object.isExtensible(Object.preventExtensions({}))})),ro=t((function(e){var t=R.f,n=$("meta"),r=0,i=Object.isExtensible||function(){return!0},s=function(e){t(e,n,{value:{objectID:"O"+ ++r,weakData:{}}})},o=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!m(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!v(e,n)){if(!i(e))return"F";if(!t)return"E";s(e)}return e[n].objectID},getWeakData:function(e,t){if(!v(e,n)){if(!i(e))return!0;if(!t)return!1;s(e)}return e[n].weakData},onFreeze:function(e){return no&&o.REQUIRED&&i(e)&&!v(e,n)&&s(e),e}};H[n]=!0})),io=function(e,t,n){var s=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=s?"set":"add",c=r[e],u=c&&c.prototype,l=c,h={},d=function(e){var t=u[e];ne(u,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!m(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!m(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!m(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(Re(e,"function"!=typeof c||!(o||u.forEach&&!i((function(){(new c).entries().next()})))))l=n.getConstructor(t,e,s,a),ro.REQUIRED=!0;else if(Re(e,!0)){var f=new l,p=f[a](o?{}:-0,1)!=f,g=i((function(){f.has(1)})),_=At((function(e){new c(e)})),y=!o&&i((function(){for(var e=new c,t=5;t--;)e[a](t,t);return!e.has(-0)}));_||((l=t((function(t,n){It(t,l,e);var r=function(e,t,n){var r,i;return Me&&"function"==typeof(r=t.constructor)&&r!==n&&m(i=r.prototype)&&i!==n.prototype&&Me(e,i),e}(new c,t,l);return null!=n&&dt(n,r[a],{that:r,AS_ENTRIES:s}),r}))).prototype=u,u.constructor=l),(g||y)&&(d("delete"),d("has"),s&&d("get")),(y||p)&&d(a),o&&u.clear&&delete u.clear}return h[e]=l,Ae({global:!0,forced:l!=c},h),vt(l,e),o||n.setStrong(l,e,s),l},so=R.f,oo=ro.fastKey,ao=te.set,co=te.getterFor,uo={getConstructor:function(e,t,n,r){var i=e((function(e,o){It(e,i,t),ao(e,{type:t,index:$e(null),first:void 0,last:void 0,size:0}),s||(e.size=0),null!=o&&dt(o,e[r],{that:e,AS_ENTRIES:n})})),o=co(t),a=function(e,t,n){var r,i,a=o(e),u=c(e,t);return u?u.value=n:(a.last=u={index:i=oo(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=u),r&&(r.next=u),s?a.size++:e.size++,"F"!==i&&(a.index[i]=u)),e},c=function(e,t){var n,r=o(e),i=oo(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return mt(i.prototype,{clear:function(){for(var e=o(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,s?e.size=0:this.size=0},delete:function(e){var t=this,n=o(t),r=c(t,e);if(r){var i=r.next,a=r.previous;delete n.index[r.index],r.removed=!0,a&&(a.next=i),i&&(i.previous=a),n.first==r&&(n.first=i),n.last==r&&(n.last=a),s?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=o(this),r=nt(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),mt(i.prototype,n?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),s&&so(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",i=co(t),s=co(r);wr(e,t,(function(e,t){ao(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=s(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),bt(t)}},lo=(io("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),uo),re.Map,function(e){var t,n,r,i,s=arguments.length,o=s>1?arguments[1]:void 0;return tt(this),(t=void 0!==o)&&tt(o),null==e?new this:(n=[],t?(r=0,i=nt(o,s>2?arguments[2]:void 0,2),dt(e,(function(e){n.push(i(e,r++))}))):dt(e,n.push,{that:n}),new this(n))});Ae({target:"Map",stat:!0},{from:lo});var ho=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)};Ae({target:"Map",stat:!0},{of:ho});var fo=function(){for(var e,t=C(this),n=tt(t.delete),r=!0,i=0,s=arguments.length;i<s;i++)e=n.call(t,arguments[i]),r=r&&e;return!!r};Ae({target:"Map",proto:!0,real:!0,forced:j},{deleteAll:function(){return fo.apply(this,arguments)}});Ae({target:"Map",proto:!0,real:!0,forced:j},{emplace:function(e,t){var n=C(this),r=n.has(e)&&"update"in t?t.update(n.get(e),e,n):t.insert(e,n);return n.set(e,r),r}});var po=function(e){return Map.prototype.entries.call(e)};Ae({target:"Map",proto:!0,real:!0,forced:j},{every:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return!dt(n,(function(e,n,i){if(!r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{filter:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Map"))),s=tt(i.set);return dt(n,(function(e,n){r(n,e,t)&&s.call(i,e,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{find:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n,i){if(r(n,e,t))return i(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{findKey:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n,i){if(r(n,e,t))return i(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",stat:!0},{groupBy:function(e,t){var n=new this;tt(t);var r=tt(n.has),i=tt(n.get),s=tt(n.set);return dt(e,(function(e){var o=t(e);r.call(n,o)?i.call(n,o).push(e):s.call(n,o,[e])})),n}});Ae({target:"Map",proto:!0,real:!0,forced:j},{includes:function(e){return dt(po(C(this)),(function(t,n,r){if(function(e,t){return e===t||e!=e&&t!=t}(n,e))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;tt(t);var r=tt(n.set);return dt(e,(function(e){r.call(n,t(e),e)})),n}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{keyOf:function(e){return dt(po(C(this)),(function(t,n,r){if(n===e)return r(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{mapKeys:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Map"))),s=tt(i.set);return dt(n,(function(e,n){s.call(i,r(n,e,t),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{mapValues:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Map"))),s=tt(i.set);return dt(n,(function(e,n){s.call(i,e,r(n,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{merge:function(e){for(var t=C(this),n=tt(t.set),r=0;r<arguments.length;)dt(arguments[r++],n,{that:t,AS_ENTRIES:!0});return t}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{reduce:function(e){var t=C(this),n=po(t),r=arguments.length<2,i=r?void 0:arguments[1];if(tt(e),dt(n,(function(n,s){r?(r=!1,i=s):i=e(i,s,n,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty map with no initial value");return i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{some:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n,i){if(r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{update:function(e,t){var n=C(this),r=arguments.length;tt(t);var i=n.has(e);if(!i&&r<3)throw TypeError("Updating absent value");var s=i?n.get(e):tt(r>2?arguments[2]:void 0)(e,n);return n.set(e,t(s,e,n)),n}});var go=function(e,t){var n,r=C(this),i=arguments.length>2?arguments[2]:void 0;if("function"!=typeof t&&"function"!=typeof i)throw TypeError("At least one callback required");return r.has(e)?(n=r.get(e),"function"==typeof t&&(n=t(n),r.set(e,n))):"function"==typeof i&&(n=i(),r.set(e,n)),n};Ae({target:"Map",proto:!0,real:!0,forced:j},{upsert:go}),Ae({target:"Map",proto:!0,real:!0,forced:j},{updateOrInsert:go});io("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),uo),re.Set;Ae({target:"Set",stat:!0},{from:lo}),Ae({target:"Set",stat:!0},{of:ho});var mo=function(){for(var e=C(this),t=tt(e.add),n=0,r=arguments.length;n<r;n++)t.call(e,arguments[n]);return e};Ae({target:"Set",proto:!0,real:!0,forced:j},{addAll:function(){return mo.apply(this,arguments)}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{deleteAll:function(){return fo.apply(this,arguments)}});var _o=function(e){return Set.prototype.values.call(e)};Ae({target:"Set",proto:!0,real:!0,forced:j},{every:function(e){var t=C(this),n=_o(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return!dt(n,(function(e,n){if(!r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{difference:function(e){var t=C(this),n=new(xt(t,se("Set")))(t),r=tt(n.delete);return dt(e,(function(e){r.call(n,e)})),n}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{filter:function(e){var t=C(this),n=_o(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Set"))),s=tt(i.add);return dt(n,(function(e){r(e,e,t)&&s.call(i,e)}),{IS_ITERATOR:!0}),i}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{find:function(e){var t=C(this),n=_o(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n){if(r(e,e,t))return n(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{intersection:function(e){var t=C(this),n=new(xt(t,se("Set"))),r=tt(t.has),i=tt(n.add);return dt(e,(function(e){r.call(t,e)&&i.call(n,e)})),n}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{isDisjointFrom:function(e){var t=C(this),n=tt(t.has);return!dt(e,(function(e,r){if(!0===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{isSubsetOf:function(e){var t=function(e){var t=ut(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return C(t.call(e))}(this),n=C(e),r=n.has;return"function"!=typeof r&&(n=new(se("Set"))(e),r=tt(n.has)),!dt(t,(function(e,t){if(!1===r.call(n,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{isSupersetOf:function(e){var t=C(this),n=tt(t.has);return!dt(e,(function(e,r){if(!1===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{join:function(e){var t=C(this),n=_o(t),r=void 0===e?",":String(e),i=[];return dt(n,i.push,{that:i,IS_ITERATOR:!0}),i.join(r)}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{map:function(e){var t=C(this),n=_o(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Set"))),s=tt(i.add);return dt(n,(function(e){s.call(i,r(e,e,t))}),{IS_ITERATOR:!0}),i}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{reduce:function(e){var t=C(this),n=_o(t),r=arguments.length<2,i=r?void 0:arguments[1];if(tt(e),dt(n,(function(n){r?(r=!1,i=n):i=e(i,n,n,t)}),{IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty set with no initial value");return i}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{some:function(e){var t=C(this),n=_o(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n){if(r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{symmetricDifference:function(e){var t=C(this),n=new(xt(t,se("Set")))(t),r=tt(n.delete),i=tt(n.add);return dt(e,(function(e){r.call(n,e)||i.call(n,e)})),n}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{union:function(e){var t=C(this),n=new(xt(t,se("Set")))(t);return dt(e,tt(n.add),{that:n}),n}});var yo=Math.floor;Ae({target:"Number",stat:!0},{isInteger:function(e){return!m(e)&&isFinite(e)&&yo(e)===e}});re.Number.isInteger;Ae({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});re.Number.isNaN;
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var vo=function(e,t){return(vo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var wo=function(){return(wo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function bo(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Io(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function To(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function Eo(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function So(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function Co(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ko=!1,Ro="${JSCORE_VERSION}",No=function(e,t){if(!e)throw Ao(t)},Ao=function(e){return new Error("Firebase Database ("+Ro+") INTERNAL ASSERT FAILED: "+e)},Po=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},xo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var s=e[i],o=i+1<e.length,a=o?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,l=s>>2,h=(3&s)<<4|a>>4,d=(15&a)<<2|u>>6,f=63&u;c||(f=64,o||(d=64)),r.push(n[l],n[h],n[d],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Po(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(s=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{s=e[n++];var a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var s=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,c=++i<e.length?n[e.charAt(i)]:64;if(++i,null==s||null==o||null==a||null==c)throw Error();var u=s<<2|o>>4;if(r.push(u),64!==a){var l=o<<4&240|a>>2;if(r.push(l),64!==c){var h=a<<6&192|c;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Do=function(e){var t=Po(e);return xo.encodeByteArray(t,!0)},Oo=function(e){try{return xo.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Lo(e){return Mo(void 0,e)}function Mo(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Mo(e[n],t[n]));return e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var Fo=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Uo(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=wo({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[xo.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),xo.encodeString(JSON.stringify(s),!1),""].join(".")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function qo(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function jo(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qo())}function Vo(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function Bo(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function Wo(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function $o(){var e=qo();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function zo(){return!0===ko}function Ko(){return"indexedDB"in self&&null!=indexedDB}function Ho(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function Go(){return!(!navigator||!navigator.cookieEnabled)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Qo=function(e){function t(n,r,i){var s=e.call(this,r)||this;return s.code=n,s.customData=i,s.name="FirebaseError",Object.setPrototypeOf(s,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,Yo.prototype.create),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}vo(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error),Yo=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,s=this.errors[e],o=s?Jo(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").",c=new Qo(i,a,r);return c},e}();function Jo(e,t){return e.replace(Xo,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var Xo=/\{\$([^}]+)}/g;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Zo(e){return JSON.parse(e)}function ea(e){return JSON.stringify(e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ta=function(e){var t={},n={},r={},i="";try{var s=e.split(".");t=Zo(Oo(s[0])||""),n=Zo(Oo(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},na=function(e){var t=ta(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},ra=function(e){var t=ta(e).claims;return"object"==typeof t&&!0===t.admin};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function ia(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function sa(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function oa(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function aa(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ca(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var s=i[r];n(s[0],s[1])}return t.length?"&"+t.join("&"):""}function ua(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("="),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function la(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ha=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var s,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(s=l^c&(u^l),o=1518500249):(s=c^u^l,o=1859775393):r<60?(s=c&u|l&(c|u),o=2400959708):(s=c^u^l,o=3395469782);i=(a<<5|a>>>27)+s+h+o+n[r]&4294967295;h=l,l=u,u=4294967295&(c<<30|c>>>2),c=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,s=this.inbuf_;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++r,++s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++r,++s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function da(e,t){var n=new fa(e,t);return n.subscribe.bind(n)}var fa=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=pa),void 0===r.error&&(r.error=pa),void 0===r.complete&&(r.complete=pa);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),s},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function pa(){}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ga=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function ma(e,t){return e+" failed: "+t+" argument "}function _a(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(ma(e,t)+"must be a valid function.")}function ya(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(ma(e,t)+"must be a valid context object.")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var va=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;r++,No(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},wa=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function ba(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=2);var r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Ia(e){return e&&e._delegate?e._delegate:e}var Ta=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),Ea="[DEFAULT]",Sa=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Set}return e.prototype.get=function(e){void 0===e&&(e=Ea);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Fo;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=wo({identifier:Ea,optional:!1},e),n=t.identifier,r=t.optional,i=this.normalizeInstanceIdentifier(n);if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e))try{this.getOrInitializeService({instanceIdentifier:Ea})}catch(e){}try{for(var r=Eo(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var s=So(i.value,2),o=s[0],a=s[1],c=this.normalizeInstanceIdentifier(o);try{var u=this.getOrInitializeService({instanceIdentifier:c});a.resolve(u)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=Ea),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return Io(this,void 0,void 0,(function(){var e;return To(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Co(Co([],So(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),So(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=Ea),this.instances.has(e)},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.instanceIdentifier,i=void 0===r?Ea:r,s=e.options,o=void 0===s?{}:s,a=this.normalizeInstanceIdentifier(i);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var c=this.getOrInitializeService({instanceIdentifier:a,options:o});try{for(var u=Eo(this.instancesDeferred.entries()),l=u.next();!l.done;l=u.next()){var h=So(l.value,2),d=h[0],f=h[1];a===this.normalizeInstanceIdentifier(d)&&f.resolve(c)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}return this.invokeOnInitCallbacks(c,a),c},e.prototype.onInit=function(e){var t=this;return this.onInitCallbacks.add(e),function(){t.onInitCallbacks.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,r;try{for(var i=Eo(this.onInitCallbacks),s=i.next();!s.done;s=i.next()){var o=s.value;try{o(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Ea?void 0:t),options:i}),this.instances.set(n,s),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:Ea:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Ca,ka,Ra=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Sa(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}(),Na=[];
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ka||(ka={}));var Aa={debug:ka.DEBUG,verbose:ka.VERBOSE,info:ka.INFO,warn:ka.WARN,error:ka.ERROR,silent:ka.SILENT},Pa=ka.INFO,xa=((Ca={})[ka.DEBUG]="log",Ca[ka.VERBOSE]="log",Ca[ka.INFO]="info",Ca[ka.WARN]="warn",Ca[ka.ERROR]="error",Ca),Da=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),s=xa[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[s].apply(console,Co(["["+i+"]  "+e.name+":"],n))}},Oa=function(){function e(e){this.name=e,this._logLevel=Pa,this._logHandler=Da,this._userLogHandler=null,Na.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in ka))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?Aa[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.DEBUG],e)),this._logHandler.apply(this,Co([this,ka.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.VERBOSE],e)),this._logHandler.apply(this,Co([this,ka.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.INFO],e)),this._logHandler.apply(this,Co([this,ka.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.WARN],e)),this._logHandler.apply(this,Co([this,ka.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.ERROR],e)),this._logHandler.apply(this,Co([this,ka.ERROR],e))},e}();
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class La{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Ma="@firebase/app-exp",Fa=new Oa("@firebase/app"),Ua="[DEFAULT]",qa={[Ma]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics-exp":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/auth-exp":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions-exp":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations-exp":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging-exp":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance-exp":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config-exp":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js","firebase-exp":"fire-js-all"},ja=new Map,Va=new Map;function Ba(e,t){try{e.container.addComponent(t)}catch(n){Fa.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Wa(e,t){e.container.addOrOverwriteComponent(t)}function $a(e){const t=e.name;if(Va.has(t))return Fa.debug(`There were multiple attempts to register component ${t}.`),!1;Va.set(t,e);for(const t of ja.values())Ba(t,e);return!0}function za(e,t){return e.container.getProvider(t)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Ka=new Yo("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Ha{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ta("app-exp",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ka.create("app-deleted",{appName:this._name})}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Ga="9.0.0-beta.2";function Qa(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:Ua,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw Ka.create("bad-app-name",{appName:String(r)});if(ja.has(r))throw Ka.create("duplicate-app",{appName:r});const i=new Ra(r);for(const e of Va.values())i.addComponent(e);const s=new Ha(e,n,i);return ja.set(r,s),s}async function Ya(e){const t=e.name;ja.has(t)&&(ja.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function Ja(e,t,n){var r;let i=null!==(r=qa[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Fa.warn(e.join(" "))}$a(new Ta(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function Xa(e,t){if(null!==e&&"function"!=typeof e)throw Ka.create("invalid-log-argument");!function(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=Aa[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var o=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:ka[n].toLowerCase(),message:o,args:i,type:t.name})}},r=0,i=Na;r<i.length;r++)n(i[r])}(e,t)}function Za(e){var t;t=e,Na.forEach((function(e){e.setLogLevel(t)}))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ec;$a(new Ta("platform-logger",(e=>new La(e)),"PRIVATE")),Ja(Ma,"0.0.900-exp.d92a36260",ec),Ja("fire-js","");var tc=Object.freeze({__proto__:null,SDK_VERSION:Ga,_DEFAULT_ENTRY_NAME:Ua,_addComponent:Ba,_addOrOverwriteComponent:Wa,_apps:ja,_clearComponents:function(){Va.clear()},_components:Va,_getProvider:za,_registerComponent:$a,_removeServiceInstance:function(e,t,n="[DEFAULT]"){za(e,t).clearInstance(n)},deleteApp:Ya,getApp:function(e="[DEFAULT]"){const t=ja.get(e);if(!t)throw Ka.create("no-app",{appName:e});return t},getApps:function(){return Array.from(ja.values())},initializeApp:Qa,onLog:Xa,registerVersion:Ja,setLogLevel:Za});
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nc{constructor(e,t){this._delegate=e,this.firebase=t,Ba(e,new Ta("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),Ya(this._delegate))))}_getService(e,t="[DEFAULT]"){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t="[DEFAULT]"){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ba(this._delegate,e)}_addOrOverwriteComponent(e){Wa(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const rc=new Yo("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const ic=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function e(){const t=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){const t={},n={__esModule:!0,initializeApp:function(r,i={}){const s=Qa(r,i),o=new e(s,n);return t[s.name]=o,o},app:r,registerVersion:Ja,setLogLevel:Za,onLog:Xa,apps:null,SDK_VERSION:Ga,INTERNAL:{registerComponent:function(t){const i=t.name,s=i.replace("-compat","");if($a(t)&&"PUBLIC"===t.type){const o=(e=r())=>{if("function"!=typeof e[s])throw rc.create("invalid-app-argument",{appName:i});return e[s]()};void 0!==t.serviceProps&&Mo(o,t.serviceProps),n[s]=o,e.prototype[s]=function(...e){return this._getService.bind(this,i).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[s]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:tc}};function r(e){if(!ia(t,e=e||Ua))throw rc.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),r.App=e,n}(nc);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Mo(t,e)},createSubscribe:da,ErrorFactory:Yo,deepExtend:Mo}),t}(),sc=new Oa("@firebase/app-compat");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){sc.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&sc.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const oc=ic;!
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){Ja("@firebase/app-compat","0.0.900-exp.d92a36260",e)}();
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
oc.registerVersion("firebase-exp","9.0.0-beta.2","app-compat");const ac=
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "useAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"Auth can only be initialized once per app."}},cc=new Yo("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),uc=new Oa("@firebase/auth-exp");function lc(e,...t){uc.logLevel<=ka.ERROR&&uc.error(`Auth (9.0.0-beta.2): ${e}`,...t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function hc(e,...t){throw fc(e,...t)}function dc(e,...t){return fc(e,...t)}function fc(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return cc.create(e,...t)}function pc(e,t,...n){if(!e)throw fc(t,...n)}function gc(e){const t="INTERNAL ASSERTION FAILED: "+e;throw lc(t),new Error(t)}function mc(e,t){e||gc(t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const _c=new Map;function yc(e){mc(e instanceof Function,"Expected a class definition");let t=_c.get(e);return t?(mc(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,_c.set(e,t),t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function vc(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function wc(){return"http:"===bc()||"https:"===bc()}function bc(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Ic{constructor(e,t){this.shortDelay=e,this.longDelay=t,mc(t>e,"Short delay should be less than long delay!"),this.isMobile=jo()||Wo()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(wc()||Bo()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Tc(e,t){mc(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ec{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void gc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void gc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void gc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Sc={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded"},Cc=new Ic(3e4,6e4);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function kc(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Rc(e,t,n,r,i={}){return Nc(e,i,(()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=ca(Object.assign({key:e.config.apiKey},s)).slice(1),a=new(Ec.headers());return a.set("Content-Type","application/json"),a.set("X-Client-Version",e._getSdkClientVersion()),e.languageCode&&a.set("X-Firebase-Locale",e.languageCode),Ec.fetch()(Pc(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Nc(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Sc),t);try{const t=new xc(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Dc(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=(i.ok?s.errorMessage:s.error.message).split(" : ")[0];if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw Dc(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw Dc(e,"email-already-in-use",s);hc(e,r[t]||t.toLowerCase().replace(/[_\s]+/g,"-"))}}catch(t){if(t instanceof Qo)throw t;hc(e,"network-request-failed")}}async function Ac(e,t,n,r,i={}){const s=await Rc(e,t,n,r,i);return"mfaPendingCredential"in s&&hc(e,"multi-factor-auth-required",{serverResponse:s}),s}function Pc(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Tc(e.config,i):`${e.config.apiScheme}://${i}`}class xc{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(dc(this.auth,"timeout"))),Cc.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Dc(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=dc(e,t,r);return i.customData._tokenResponse=n,i}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Oc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Lc(e){return 1e3*Number(e)}function Mc(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return lc("JWT malformed, contained fewer than 3 sections"),null;try{const e=Oo(n);return e?JSON.parse(e):(lc("Failed to decode base64 JWT payload"),null)}catch(e){return lc("Caught error parsing JWT payload as JSON",e),null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Fc(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof Qo&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Uc{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qc{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oc(this.lastLoginAt),this.creationTime=Oc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function jc(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Fc(e,async function(e,t){return Rc(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));pc(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=bo(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new qc(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Vc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pc(e.idToken,"internal-error"),pc(void 0!==e.idToken,"internal-error"),pc(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Mc(e);return pc(t,"internal-error"),pc(void 0!==t.exp,"internal-error"),pc(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return pc(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){const n=await Nc(e,{},(()=>{const n=ca({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Pc(e,r,"/v1/token",`key=${i}`);return Ec.fetch()(s,{method:"POST",headers:{"X-Client-Version":e._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Vc;return n&&(pc("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(pc("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(pc("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vc,this.toJSON())}_performRefresh(){return gc("not implemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Bc(e,t){pc("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Wc{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=bo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Uc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new qc(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Fc(this,this.stsTokenManager.getToken(this.auth,e));return pc(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Ia(e),r=await n.getIdToken(t),i=Mc(r);pc(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Oc(Lc(i.auth_time)),issuedAtTime:Oc(Lc(i.iat)),expirationTime:Oc(Lc(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Ia(e);await jc(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(pc(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new Wc(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){pc(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await jc(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Fc(this,async function(e,t){return Rc(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,_=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:y,emailVerified:v,isAnonymous:w,providerData:b,stsTokenManager:I}=t;pc(y&&I,e,"internal-error");const T=Vc.fromJSON(this.name,I);pc("string"==typeof y,e,"internal-error"),Bc(l,e.name),Bc(h,e.name),pc("boolean"==typeof v,e,"internal-error"),pc("boolean"==typeof w,e,"internal-error"),Bc(d,e.name),Bc(f,e.name),Bc(p,e.name),Bc(g,e.name),Bc(m,e.name),Bc(_,e.name);const E=new Wc({uid:y,auth:e,email:h,emailVerified:v,displayName:l,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:_});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t,n=!1){const r=new Vc;r.updateFromServerResponse(t);const i=new Wc({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await jc(i),i}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $c{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}$c.type="NONE";const zc=$c;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Kc(e,t,n){return`firebase:${e}:${t}:${n}`}class Hc{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Kc(this.userKey,r.apiKey,i),this.fullPersistenceKey=Kc("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Wc._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Hc(yc(zc),e,n);let r=yc(zc);for(const e of t)if(await e._isAvailable()){r=e;break}let i=null;const s=Kc(n,e.config.apiKey,e.name);for(const n of t)try{const t=await n._get(s);if(t){const s=Wc._fromJSON(e,t);n!==r&&(i=s);break}}catch(e){}return i&&await r._set(s,i.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new Hc(r,e,n)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Gc(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Xc(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qc(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(eu(t))return"Blackberry";if(tu(t))return"Webos";if(Yc(t))return"Safari";if((t.includes("chrome/")||Jc(t))&&!t.includes("edge/"))return"Chrome";if(Zc(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Qc(e=qo()){return/firefox\//i.test(e)}function Yc(e=qo()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Jc(e=qo()){return/crios\//i.test(e)}function Xc(e=qo()){return/iemobile/i.test(e)}function Zc(e=qo()){return/android/i.test(e)}function eu(e=qo()){return/blackberry/i.test(e)}function tu(e=qo()){return/webos/i.test(e)}function nu(e=qo()){return/iphone|ipad|ipod/i.test(e)}function ru(e=qo()){return nu(e)||Zc(e)||tu(e)||eu(e)||/windows phone/i.test(e)||Xc(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function iu(e,t=[]){let n;switch(e){case"Browser":n=Gc(qo());break;case"Worker":n=`${Gc(qo())}-${e}`;break;default:n=e}return`${n}/JsCore/9.0.0-beta.2/${t.length?t.join(","):"FirebaseCore-web"}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class su{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new au(this),this.idTokenSubscription=new au(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.redirectInitializerError=null,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cc,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=yc(t)),this._initializationPromise=this.queue((async()=>{var n;this._deleted||(this.persistenceManager=await Hc.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this._deleted||(this._isInitialized=!0)))})),this._initializationPromise.then((()=>{if(this.redirectInitializerError)throw this.redirectInitializerError}))}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(pc(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){this.redirectInitializerError=e,await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await jc(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Ia(e):null;return t&&pc(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&pc(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(yc(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Yo("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&yc(e)||this._popupRedirectResolver;pc(t,this,"argument-error"),this.redirectPersistenceManager=await Hc.create(this,[yc(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next,s=this._isInitialized?Promise.resolve():this._initializationPromise;return pc(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pc(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iu(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function ou(e){return Ia(e)}class au{constructor(e){this.auth=e,this.observer=null,this.addObserver=da((e=>this.observer=e))}get next(){return pc(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function cu(e,t,n){const r=ou(e);pc(r._canInitEmulator,r,"emulator-config-failed"),pc(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=uu(t),{host:o,port:a}=function(e){const t=uu(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:lu(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:lu(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),function(e){function t(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"==typeof window||"undefined"==typeof document||e||("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(i)}function uu(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function lu(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class hu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return gc("not implemented")}_getIdTokenResponse(e){return gc("not implemented")}_linkToIdToken(e,t){return gc("not implemented")}_getReauthenticationResolver(e){return gc("not implemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function du(e,t){return Rc(e,"POST","/v1/accounts:resetPassword",kc(e,t))}async function fu(e,t){return Rc(e,"POST","/v1/accounts:update",t)}async function pu(e,t){return Rc(e,"POST","/v1/accounts:sendOobCode",kc(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class gu extends hu{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new gu(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new gu(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithPassword",kc(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithEmailLink",kc(e,t))}(e,{email:this._email,oobCode:this._password});default:hc(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return fu(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithEmailLink",kc(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:hc(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function mu(e,t){return Ac(e,"POST","/v1/accounts:signInWithIdp",kc(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _u extends hu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _u(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=bo(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new _u(n,r);return Object.assign(s,i),s}_getIdTokenResponse(e){return mu(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,mu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mu(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ca(t)}return e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const yu={USER_NOT_FOUND:"user-not-found"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class vu extends hu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new vu({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new vu({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithPhoneNumber",kc(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Ac(e,"POST","/v1/accounts:signInWithPhoneNumber",kc(e,t));if(n.temporaryProof)throw Dc(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithPhoneNumber",kc(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),yu)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new vu({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wu{constructor(e){var t,n,r,i,s,o;const a=ua(la(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);pc(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=ua(la(e)).link,n=t?ua(la(t)).deep_link_id:null,r=ua(la(e)).deep_link_id;return(r?ua(la(r)).link:null)||r||n||t||e}(e);try{return new wu(t)}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bu{constructor(){this.providerId=bu.PROVIDER_ID}static credential(e,t){return gu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=wu.parseLink(t);return pc(n,"argument-error"),gu._fromEmailAndCode(e,n.code,n.tenantId)}}bu.PROVIDER_ID="password",bu.EMAIL_PASSWORD_SIGN_IN_METHOD="password",bu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Iu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Tu extends Iu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Eu extends Tu{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return pc("providerId"in t&&"signInMethod"in t,"argument-error"),_u._fromParams(t)}credential(e){return this._credential(e)}_credential(e){return pc(e.idToken||e.accessToken,"argument-error"),_u._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Eu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Eu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new Eu(o)._credential({idToken:t,accessToken:n,rawNonce:s,pendingToken:i})}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Su extends Tu{constructor(){super("facebook.com")}static credential(e){return _u._fromParams({providerId:Su.PROVIDER_ID,signInMethod:Su.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Su.credentialFromTaggedObject(e)}static credentialFromError(e){return Su.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Su.credential(e.oauthAccessToken)}catch(e){return null}}}Su.FACEBOOK_SIGN_IN_METHOD="facebook.com",Su.PROVIDER_ID="facebook.com";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Cu extends Tu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _u._fromParams({providerId:Cu.PROVIDER_ID,signInMethod:Cu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cu.credentialFromTaggedObject(e)}static credentialFromError(e){return Cu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Cu.credential(t,n)}catch(e){return null}}}Cu.GOOGLE_SIGN_IN_METHOD="google.com",Cu.PROVIDER_ID="google.com";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class ku extends Tu{constructor(){super("github.com")}static credential(e){return _u._fromParams({providerId:ku.PROVIDER_ID,signInMethod:ku.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ku.credentialFromTaggedObject(e)}static credentialFromError(e){return ku.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ku.credential(e.oauthAccessToken)}catch(e){return null}}}ku.GITHUB_SIGN_IN_METHOD="github.com",ku.PROVIDER_ID="github.com";class Ru extends hu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return mu(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,mu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mu(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new Ru(n,i):null}static _create(e,t){return new Ru(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Nu extends Tu{constructor(){super("twitter.com")}static credential(e,t){return _u._fromParams({providerId:Nu.PROVIDER_ID,signInMethod:Nu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Nu.credentialFromTaggedObject(e)}static credentialFromError(e){return Nu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Nu.credential(t,n)}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Au(e,t){return Ac(e,"POST","/v1/accounts:signUp",kc(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Nu.TWITTER_SIGN_IN_METHOD="twitter.com",Nu.PROVIDER_ID="twitter.com";class Pu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Wc._fromIdTokenResponse(e,n,r),s=xu(n);return new Pu({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=xu(n);return new Pu({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function xu(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Du extends Qo{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,this.name="FirebaseError",Object.setPrototypeOf(this,Du.prototype),this.appName=e.name,this.code=t.code,this.tenantId=null!==(i=e.tenantId)&&void 0!==i?i:void 0,this.serverResponse=t.customData.serverResponse}static _fromErrorAndOperation(e,t,n,r){return new Du(e,t,n,r)}}function Ou(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Du._fromErrorAndOperation(e,n,t,r);throw n}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Lu(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Mu(e,t){const n=Ia(e);await Uu(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return Rc(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=Lu(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Fu(e,t,n=!1){const r=await Fc(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Pu._forOperation(e,"link",r)}async function Uu(e,t,n){await jc(t);const r=!1===e?"provider-already-linked":"no-such-provider";pc(Lu(t.providerData).has(n)===e,t.auth,r)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function qu(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await Fc(e,Ou(r,i,t,e),n);pc(s.idToken,r,"internal-error");const o=Mc(s.idToken);pc(o,r,"internal-error");const{sub:a}=o;return pc(e.uid===a,r,"user-mismatch"),Pu._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&hc(r,"user-mismatch"),e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function ju(e,t,n=!1){const r="signIn",i=await Ou(e,r,t),s=await Pu._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function Vu(e,t){return ju(ou(e),t)}async function Bu(e,t){const n=Ia(e);return await Uu(!1,n,t.providerId),Fu(n,t)}async function Wu(e,t){return qu(Ia(e),t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function $u(e,t){const n=ou(e),r=await async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithCustomToken",kc(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Pu._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zu{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Ku._fromServerResponse(e,t):hc(e,"internal-error")}}class Ku extends zu{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Ku(t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Hu(e,t,n){var r;pc((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),pc(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(pc(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iosBundleId=n.iOS.bundleId),n.android&&(pc(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Gu(e,t,n){const r=Ia(e),i={requestType:"PASSWORD_RESET",email:t};n&&Hu(r,i,n),await async function(e,t){return pu(e,t)}(r,i)}async function Qu(e,t){await async function(e,t){return Rc(e,"POST","/v1/accounts:update",kc(e,t))}(Ia(e),{oobCode:t})}async function Yu(e,t){const n=Ia(e),r=await du(n,{oobCode:t}),i=r.requestType;switch(pc(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":pc(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":pc(r.mfaInfo,n,"internal-error");default:pc(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=zu._fromServerResponse(ou(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Ju(e,t,n){const r=Ia(e),i={requestType:"EMAIL_SIGNIN",email:t};pc(n.handleCodeInApp,r,"argument-error"),n&&Hu(r,i,n),await async function(e,t){return pu(e,t)}(r,i)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Xu(e,t){const n={identifier:t,continueUri:wc()?vc():"http://localhost"},{signinMethods:r}=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){return Rc(e,"POST","/v1/accounts:createAuthUri",kc(e,t))}(Ia(e),n);return r||[]}async function Zu(e,t){const n=Ia(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Hu(n.auth,r,t);const{email:i}=await async function(e,t){return pu(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function el(e,t,n){const r=Ia(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Hu(r.auth,i,n);const{email:s}=await async function(e,t){return pu(e,t)}(r.auth,i);s!==e.email&&await e.reload()}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function tl(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=Ia(e),i={idToken:await r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=await Fc(r,async function(e,t){return Rc(e,"POST","/v1/accounts:update",t)}(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find((({providerId:e})=>"password"===e));o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}async function nl(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await Fc(e,fu(r,i));await e._updateTokensIfNecessary(s,!0)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rl{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class il extends rl{constructor(e,t,n,r){super(e,t,n),this.username=r}}class sl extends rl{constructor(e,t){super(e,"facebook.com",t)}}class ol extends il{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class al extends rl{constructor(e,t){super(e,"google.com",t)}}class cl extends il{constructor(e,t,n){super(e,"twitter.com",t,n)}}function ul(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=Mc(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new rl(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new sl(s,i);case"github.com":return new ol(s,i);case"google.com":return new al(s,i);case"twitter.com":return new cl(s,i,e.screenName||null);case"custom":case"anonymous":return new rl(s,null);default:return new rl(s,r,i)}}(n)}class ll{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new ll("enroll",e)}static _fromMfaPendingCredential(e){return new ll("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return ll._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return ll._fromIdtoken(e.multiFactorSession.idToken)}return null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hl{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=ou(e),r=(t.serverResponse.mfaInfo||[]).map((e=>zu._fromServerResponse(n,e)));pc(t.serverResponse.mfaPendingCredential,n,"internal-error");const i=ll._fromMfaPendingCredential(t.serverResponse.mfaPendingCredential);return new hl(i,r,(async e=>{const r=await e._process(n,i);delete t.serverResponse.mfaInfo,delete t.serverResponse.mfaPendingCredential;const s=Object.assign(Object.assign({},t.serverResponse),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Pu._fromIdTokenResponse(n,t.operationType,s);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return pc(t.user,n,"internal-error"),Pu._forOperation(t.user,t.operationType,s);default:hc(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class dl{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>zu._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new dl(e)}async getSession(){return ll._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,r=await this.getSession(),i=await Fc(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken(),r=await Fc(this.user,(i=this.user.auth,s={idToken:n,mfaEnrollmentId:t},Rc(i,"POST","/v2/accounts/mfaEnrollment:withdraw",Object.assign({tenantId:i.tenantId},s))));var i,s;this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(r);try{await this.user.reload()}catch(e){if("auth/user-token-expired"!==e.code)throw e}}}const fl=new WeakMap;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class pl{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){pc(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const gl="__sak";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ml{constructor(e,t){this.storage=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gl,"1"),this.storage.removeItem(gl),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _l extends ml{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=qo();return Yc(e)||nu(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=ru(),this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);$o()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_l.type="LOCAL";const yl=_l;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class vl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new vl(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vl.receivers=[];class wl{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e="",t=20){return`${e}${Math.floor(Math.random()*Math.pow(10,t))}`}();r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function bl(){return window}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Il(){return void 0!==bl().WorkerGlobalScope&&"function"==typeof bl().importScripts}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Tl="firebaseLocalStorageDb",El="firebaseLocalStorage",Sl="fbase_key";class Cl{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function kl(e,t){return e.transaction([El],t?"readwrite":"readonly").objectStore(El)}function Rl(){const e=indexedDB.open(Tl,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(El,{keyPath:Sl})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;if(!n.objectStoreNames.contains(El))return await function(){const e=indexedDB.deleteDatabase(Tl);return new Cl(e).toPromise()}(),Rl();t(n)}))}))}async function Nl(e,t,n){const r=kl(e,!0).put({[Sl]:t,value:n});return new Cl(r).toPromise()}function Al(e,t){const n=kl(e,!0).delete(t);return new Cl(n).toPromise()}class Pl{constructor(){this.type="LOCAL",this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Rl()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Il()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vl._getInstance(Il()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new wl(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rl();return await Nl(e,gl,"1"),await Al(e,gl),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Nl(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=kl(e,!1).get(t),r=await new Cl(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Al(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=kl(e,!1).getAll();return new Cl(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Pl.type="LOCAL";const xl=Pl;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Dl{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ll(e);default:return!1}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ll(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(dc(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ol(e))}saveEventToCache(e){this.cachedEventUids.add(Ol(e)),this.lastProcessedEventTime=Date.now()}}function Ol(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ll({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function Ml(e){return`${e||""}${Math.floor(1e9*Math.random())}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Fl=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ul=/^https?/;async function ql(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Rc(e,"GET","/v1/projects",{})}(e);for(const e of t)try{if(jl(e))return}catch(e){}hc(e,"unauthorized-domain")}function jl(e){const t=vc(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Ul.test(n))return!1;if(Fl.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Vl(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=n,r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Bl(e){return`__${e}${Math.floor(1e6*Math.random())}`}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Wl=new Ic(3e4,6e4);function $l(){const e=bl().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let zl=null;function Kl(e){return zl=zl||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){$l(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{$l(),n(dc(e,"network-request-failed"))},timeout:Wl.get()})}if(null===(i=null===(r=bl().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=bl().gapi)||void 0===s?void 0:s.load)){const t=Bl("iframefcb");return bl()[t]=()=>{gapi.load?o():n(dc(e,"network-request-failed"))},Vl(`https://apis.google.com/js/api.js?onload=${t}`)}o()}})).catch((e=>{throw zl=null,e}))}(e),zl}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Hl=new Ic(5e3,15e3),Gl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},Ql=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yl(e){const t=e.config;pc(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Tc(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ga},i=Ql.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${ca(r).slice(1)}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Jl extends ml{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Jl.type="SESSION";const Xl=Jl,Zl={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function th(e,t,n,r=500,i=600){const s=Math.min((window.screen.availHeight-i)/2,0).toString(),o=Math.min((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Zl),{width:r.toString(),height:i.toString(),top:s,left:o}),u=qo().toLowerCase();n&&(a=Jc(u)?"_blank":n),Qc(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=qo()){var t;return nu(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t||"",a),new eh(null);const h=window.open(t||"",a,l);pc(h,e,"popup-blocked");try{h.focus()}catch(e){}return new eh(h)}function nh(e,t){return t?yc(t):(pc(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rh extends hu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ih(e){return ju(e.auth,new rh(e),e.bypassAuthState)}function sh(e){const{auth:t,user:n}=e;return pc(n,t,"internal-error"),qu(n,new rh(e),e.bypassAuthState)}async function oh(e){const{auth:t,user:n}=e;return pc(n,t,"internal-error"),Fu(n,new rh(e),e.bypassAuthState)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ah{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ih;case"linkViaPopup":case"linkViaRedirect":return oh;case"reauthViaPopup":case"reauthViaRedirect":return sh;default:hc(this.auth,"internal-error")}}resolve(e){mc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ch=new Map;class uh extends ah{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ch.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=dh(t),r="true"===await hh(e)._get(n);return await hh(e)._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}ch.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function lh(e,t){return hh(e)._set(dh(t),"true")}function hh(e){return yc(e._redirectPersistence)}function dh(e){return Kc("pendingRedirect",e.config.apiKey,e.name)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function fh(e,t,n){return async function(e,t,n){const r=ou(e);pc(t instanceof Iu,e,"argument-error");const i=nh(r,n);return await lh(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function ph(e,t,n){return async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);await lh(i,r.auth);const s=await _h(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function gh(e,t,n){return async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);await Uu(!1,r,t.providerId),await lh(i,r.auth);const s=await _h(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function mh(e,t,n=!1){const r=ou(e),i=nh(r,t),s=new uh(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function _h(e){const t=Ml(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const yh="__/auth/handler",vh="emulator/auth/handler";function wh(e,t,n,r,i,s){pc(e.config.authDomain,e,"auth-domain-config-required"),pc(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ga,eventId:i};if(t instanceof Iu){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",oa(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Tu){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${yh}`;return Tc(e,vh)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}?${ca(a).slice(1)}`}const bh="webStorageSupport";const Ih=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xl,this._completeRedirectFn=mh}async _openPopup(e,t,n,r){var i;mc(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return th(e,wh(e,t,n,vc(),r),Ml())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=wh(e,t,n,vc(),r),bl().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(mc(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await async function(e){const t=await Kl(e),n=bl().gapi;return pc(n,e,"internal-error"),t.open({where:document.body,url:Yl(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Gl,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=dc(e,"network-request-failed"),s=bl().setTimeout((()=>{r(i)}),Hl.get());function o(){bl().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new Dl(e);return t.register("authEvent",(t=>{pc(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(bh,{type:bh},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),hc(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ql(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ru()||Yc()||nu()}};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Th=1e12;class Eh{constructor(e){this.auth=e,this.counter=Th,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Sh(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Th;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Th;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Th;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Sh{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;pc(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Ch=Bl("rcb"),kh=new Ic(3e4,6e4);class Rh{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!bl().grecaptcha}load(e,t=""){return pc(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(bl().grecaptcha):new Promise(((n,r)=>{const i=bl().setTimeout((()=>{r(dc(e,"network-request-failed"))}),kh.get());bl()[Ch]=()=>{bl().clearTimeout(i),delete bl()[Ch];const s=bl().grecaptcha;if(!s)return void r(dc(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};Vl(`https://www.google.com/recaptcha/api.js??${ca({onload:Ch,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(dc(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!bl().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Nh{async load(e){return new Eh(e)}clearedOneInstance(){}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Ah="recaptcha",Ph={theme:"light",type:"image"};class xh{constructor(e,t=Object.assign({},Ph),n){this.parameters=t,this.type=Ah,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ou(n),this.isInvisible="invisible"===this.parameters.size,pc("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof e?document.getElementById(e):e;pc(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Nh:new Rh,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){pc(!this.parameters.sitekey,this.auth,"argument-error"),pc(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),pc("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=bl()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){pc(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){pc(wc()&&!Il(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e){return(await Rc(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);pc(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return pc(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Dh{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=vu._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Oh(e,t,n){var r;const i=await n.verify();try{let s;if(pc("string"==typeof i,e,"argument-error"),pc(n.type===Ah,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){pc("enroll"===t.type,e,"internal-error");return(await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e,t){return Rc(e,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo}{pc("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;pc(n,e,"missing-multi-factor-info");return(await function(e,t){return Rc(e,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Rc(e,"POST","/v1/accounts:sendVerificationCode",kc(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Lh{constructor(e){this.providerId=Lh.PROVIDER_ID,this.auth=ou(e)}verifyPhoneNumber(e,t){return Oh(this.auth,e,Ia(t))}static credential(e,t){return vu._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Lh.credentialFromTaggedObject(t)}static credentialFromError(e){return Lh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?vu._fromTokenResponse(t,n):null}}Lh.PROVIDER_ID="phone",Lh.PHONE_SIGN_IN_METHOD="phone";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Mh=new Ic(2e3,1e4);class Fh extends ah{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Fh.currentPopupAction&&Fh.currentPopupAction.cancel(),Fh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pc(e,this.auth,"internal-error"),e}async onExecution(){mc(1===this.filter.length,"Popup operations only handle one event");const e=Ml();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(dc(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(dc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(dc(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,Mh.get())};e()}}Fh.currentPopupAction=null;class Uh extends class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return gc("unexpected MultiFactorSessionType")}}}{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Uh(e)}_finalizeEnroll(e,t,n){return function(e,t){return Rc(e,"POST","/v2/accounts/mfaEnrollment:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return Rc(e,"POST","/v2/accounts/mfaSignIn:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class qh{constructor(){}static assertion(e){return Uh._fromCredential(e)}}var jh;
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Vh(){return window}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */jh="Browser",$a(new Ta("auth-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(e=>{pc(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),pc(!(null==i?void 0:i.includes(":")),"argument-error",{appName:e.name});const n={apiKey:r,authDomain:i,clientPlatform:jh,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iu(jh)},s=new su(e,n);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(yc);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(s,t),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),$a(new Ta("auth-internal",(e=>(e=>new pl(e))(ou(e.getProvider("auth-exp").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Ja("@firebase/auth-exp","0.0.900-exp.d92a36260",function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(jh));async function Bh(e,t,n){var r;const{BuildInfo:i}=Vh();mc(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(mc(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return nu()?o.ibi=i.packageName:Zc()?o.apn=i.packageName:hc(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,wh(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function Wh(e){const{cordova:t}=Vh();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(e=qo()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}class $h extends Dl{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function zh(e){const t=await Gh()._get(Qh(e));return t&&await Gh()._remove(Qh(e)),t}function Kh(e,t){var n,r;const i=function(e){const t=Yh(e),n=t.link?decodeURIComponent(t.link):void 0,r=Yh(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Yh(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=Yh(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null==s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?dc(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Hh(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}function Gh(){return yc(yl)}function Qh(e){return Kc("authEvent",e.config.apiKey,e.name)}function Yh(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return ua(n.join("?"))}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Jh=class{constructor(){this._redirectPersistence=Xl,this._shouldInitProactively=!0,this.eventManagers=new Map,this._completeRedirectFn=mh}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new $h(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){hc(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,c,u,l;const h=Vh();pc("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),pc(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),pc("function"==typeof(null===(s=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),pc("function"==typeof(null===(c=null===(a=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===c?void 0:c.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),pc("function"==typeof(null===(l=null===(u=null==h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),ch.clear();const s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:Hh(),postBody:null,tenantId:e.tenantId,error:dc(e,"no-auth-event")}}(e,n,r);await function(e,t){return Gh()._set(Qh(e),t)}(e,s);const o=await Bh(e,s,t);return async function(e,t,n){const{cordova:r}=Vh();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function c(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout((()=>{o(dc(e,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(c),document.addEventListener("resume",u,!1),Zc()&&document.addEventListener("visibilitychange",l,!1),i=()=>{t.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",l,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await Wh(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(){return Promise.resolve()}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=Vh(),s=setTimeout((async()=>{await zh(e),t.onEvent(Xh())}),500),o=async n=>{clearTimeout(s);const r=await zh(e);let i=null;r&&(null==n?void 0:n.url)&&(i=Kh(r,n.url)),t.onEvent(i||Xh())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,o);const a=r,c=`${i.packageName.toLowerCase()}://`;Vh().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"==typeof a)try{a(e)}catch(e){console.error(e)}}}};function Xh(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:dc("no-auth-event")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Zh(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function ed(e=qo()){return!("file:"!==Zh()&&"ionic:"!==Zh()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function td(e=qo()){return $o()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=qo()){return/Edge\/\d+/.test(e)}(e)}function nd(){try{const e=self.localStorage,t=Ml();if(e)return e.setItem(t,"1"),e.removeItem(t),!td()||Ko()}catch(e){return rd()&&Ko()}return!1}function rd(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function id(){return("http:"===Zh()||"https:"===Zh()||Bo()||ed())&&!(Wo()||Vo())&&nd()&&!rd()}function sd(){return ed()&&"undefined"!=typeof document}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const od={LOCAL:"local",NONE:"none",SESSION:"session"},ad=pc,cd="persistence";async function ud(e){await e._initializationPromise;const t=ld(),n=Kc(cd,e.config.apiKey,e.name);(null==t?void 0:t.sessionStorage)&&t.sessionStorage.setItem(n,e._getPersistence())}function ld(){return"undefined"!=typeof window?window:null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const hd=pc,dd=yc(Ih),fd=yc(Jh);class pd{constructor(){this.underlyingResolver=null,this._redirectPersistence=Xl,this._completeRedirectFn=mh}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return sd()||dd._shouldInitProactively}get assertedUnderlyingResolver(){return hd(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!sd()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?fd:dd}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function gd(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===t.code){t.resolver=new vd(e,function(e,t){var n;const r=Ia(e),i=t;return pc(t.operationType,r,"argument-error"),pc(null===(n=i.serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),hl._fromError(r,i)}(e,t))}else if(r){const e=md(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}function md(e){const{_tokenResponse:t}=e instanceof Qo?e.customData:e;if(!t)return null;if(!(e instanceof Qo)&&"temporaryProof"in t&&"phoneNumber"in t)return Lh.credentialFromResult(e);const n=t.providerId;if(!n||"password"===n)return null;let r;switch(n){case"google.com":r=Cu;break;case"facebook.com":r=Su;break;case"github.com":r=ku;break;case"twitter.com":r=Nu;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?Ru._create(n,o):_u._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new Eu(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof Qo?r.credentialFromError(e):r.credentialFromResult(e)}async function _d(e,t){let n;try{n=await t}catch(t){throw t instanceof Qo&&gd(e,t),t}const{operationType:r,user:i}=n;return{operationType:r,credential:(s=n,md(s)),additionalUserInfo:ul(n),user:wd.getOrCreate(i)};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var s}async function yd(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>_d(e,n.confirm(t))}}class vd{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return _d(this.auth.unwrap(),this.resolver.resolveSignIn(e))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wd{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=Ia(e);return fl.has(t)||fl.set(t,dl._fromUser(t)),fl.get(t)}(e)}static getOrCreate(e){return wd.USER_MAP.has(e)||wd.USER_MAP.set(e,new wd(e)),wd.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return _d(this.auth,Bu(this._delegate,e))}async linkWithPhoneNumber(e,t){return yd(this.auth,async function(e,t,n){const r=Ia(e);await Uu(!1,r,"phone");const i=await Oh(r.auth,t,Ia(n));return new Dh(i,(e=>Bu(r,e)))}(this._delegate,e,t))}async linkWithPopup(e){return _d(this.auth,async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);return new Fh(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,pd))}async linkWithRedirect(e){return await ud(ou(this.auth)),gh(this._delegate,e,pd)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return _d(this.auth,Wu(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return yd(this.auth,async function(e,t,n){const r=Ia(e),i=await Oh(r.auth,t,Ia(n));return new Dh(i,(e=>Wu(r,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return _d(this.auth,async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);return new Fh(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,pd))}async reauthenticateWithRedirect(e){return await ud(ou(this.auth)),ph(this._delegate,e,pd)}sendEmailVerification(e){return Zu(this._delegate,e)}async unlink(e){return await Mu(this._delegate,e),this}updateEmail(e){return function(e,t){return nl(Ia(e),t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return nl(Ia(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){await Fu(Ia(e),t)}(this._delegate,e)}updateProfile(e){return tl(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return el(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}wd.USER_MAP=new WeakMap;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const bd=pc;class Id{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;bd(n,"invalid-api-key",{appName:e.name});let r=[zc];if("undefined"!=typeof window){r=function(e,t){const n=ld();if(!(null==n?void 0:n.sessionStorage))return[];const r=Kc(cd,e,t);switch(n.sessionStorage.getItem(r)){case od.NONE:return[zc];case od.LOCAL:return[xl,Xl];case od.SESSION:return[Xl];default:return[]}}(n,e.name);for(const e of[xl,yl])r.includes(e)||r.push(e)}bd(n,"invalid-api-key",{appName:e.name});const i="undefined"!=typeof window?pd:void 0;this._delegate=t.initialize({options:{persistence:r,popupRedirectResolver:i}}),this._delegate._updateErrorMap(ac),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?wd.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){cu(this._delegate,e,t)}applyActionCode(e){return Qu(this._delegate,e)}checkActionCode(e){return Yu(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await du(Ia(e),{oobCode:t,newPassword:n})}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return _d(this._delegate,async function(e,t,n){const r=ou(e),i=await Au(r,{returnSecureToken:!0,email:t,password:n}),s=await Pu._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Xu(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=wu.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){bd(id(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await ou(e)._initializationPromise,mh(e,t,!1)}(this._delegate,pd);return e?_d(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){ou(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=Td(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=Td(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return Ju(this._delegate,e,t)}sendPasswordResetEmail(e,t){return Gu(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){ad(Object.values(od).includes(t),e,"invalid-persistence-type"),Wo()?ad(t!==od.SESSION,e,"unsupported-persistence-type"):Vo()?ad(t===od.NONE,e,"unsupported-persistence-type"):rd()?ad(t===od.NONE||t===od.LOCAL&&Ko(),e,"unsupported-persistence-type"):ad(t===od.NONE||nd(),e,"unsupported-persistence-type")}(this._delegate,e),e){case od.SESSION:t=Xl;break;case od.LOCAL:t=await yc(xl)._isAvailable()?xl:yl;break;case od.NONE:t=zc;break;default:return hc("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return _d(this._delegate,async function(e){var t;const n=ou(e);if(null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Pu({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Au(n,{returnSecureToken:!0}),i=await Pu._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return _d(this._delegate,Vu(this._delegate,e))}signInWithCustomToken(e){return _d(this._delegate,$u(this._delegate,e))}signInWithEmailAndPassword(e,t){return _d(this._delegate,function(e,t,n){return Vu(Ia(e),bu.credential(t,n))}(this._delegate,e,t))}signInWithEmailLink(e,t){return _d(this._delegate,async function(e,t,n){const r=Ia(e),i=bu.credentialWithLink(t,n||vc());return pc(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Vu(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return yd(this._delegate,async function(e,t,n){const r=ou(e),i=await Oh(r,t,Ia(n));return new Dh(i,(e=>Vu(r,e)))}(this._delegate,e,t))}async signInWithPopup(e){return bd(id(),this._delegate,"operation-not-supported-in-this-environment"),_d(this._delegate,async function(e,t,n){const r=ou(e);pc(t instanceof Iu,e,"argument-error");const i=nh(r,n);return new Fh(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,pd))}async signInWithRedirect(e){return bd(id(),this._delegate,"operation-not-supported-in-this-environment"),await ud(this._delegate),fh(this._delegate,e,pd)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await Yu(Ia(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function Td(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&wd.getOrCreate(e)),error:t,complete:n}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ed{constructor(){this.providerId="phone",this._delegate=new Lh(unwrap(oc.auth()))}static credential(e,t){return Lh.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Ed.PHONE_SIGN_IN_METHOD=Lh.PHONE_SIGN_IN_METHOD,Ed.PROVIDER_ID=Lh.PROVIDER_ID;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Sd=pc;class Cd{constructor(e,t,n=oc.app()){var r;Sd(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new xh(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var kd;(kd=oc).INTERNAL.registerComponent(new Ta("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth-exp");return new Id(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:bu,FacebookAuthProvider:Su,GithubAuthProvider:ku,GoogleAuthProvider:Cu,OAuthProvider:Eu,PhoneAuthProvider:Ed,PhoneMultiFactorGenerator:qh,RecaptchaVerifier:Cd,TwitterAuthProvider:Nu,Auth:{Persistence:od},AuthCredential:hu}).setInstantiationMode("LAZY").setMultipleInstances(!1)),kd.registerVersion("@firebase/auth-compat","0.0.900-exp.d92a36260");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Rd="";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Nd{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ea(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Zo(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ad{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ia(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Pd=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Nd(t)}}catch(e){}return new Ad},xd=Pd("localStorage"),Dd=Pd("sessionStorage"),Od=new Oa("@firebase/database"),Ld=function(){let e=1;return function(){return e++}}(),Md=function(e){const t=va(e),n=new ha;n.update(t);const r=n.digest();return xo.encodeByteArray(r)},Fd=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=Fd.apply(null,r):t+="object"==typeof r?ea(r):r,t+=" "}return t};let Ud=null,qd=!0;const jd=function(e,t){No(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Od.logLevel=ka.VERBOSE,Ud=Od.log.bind(Od),t&&Dd.set("logging_enabled",!0)):"function"==typeof e?Ud=e:(Ud=null,Dd.remove("logging_enabled"))},Vd=function(...e){if(!0===qd&&(qd=!1,null===Ud&&!0===Dd.get("logging_enabled")&&jd(!0)),Ud){const t=Fd.apply(null,e);Ud(t)}},Bd=function(e){return function(...t){Vd(e,...t)}},Wd=function(...e){const t="FIREBASE INTERNAL ERROR: "+Fd(...e);Od.error(t)},$d=function(...e){const t=`FIREBASE FATAL ERROR: ${Fd(...e)}`;throw Od.error(t),new Error(t)},zd=function(...e){const t="FIREBASE WARNING: "+Fd(...e);Od.warn(t)},Kd=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Hd="[MIN_NAME]",Gd="[MAX_NAME]",Qd=function(e,t){if(e===t)return 0;if(e===Hd||t===Gd)return-1;if(t===Hd||e===Gd)return 1;{const n=of(e),r=of(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Yd=function(e,t){return e===t?0:e<t?-1:1},Jd=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+ea(t))},Xd=function(e){if("object"!=typeof e||null===e)return ea(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=ea(t[r]),n+=":",n+=Xd(e[t[r]]);return n+="}",n},Zd=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function ef(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const tf=function(e){No(!Kd(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const nf=new RegExp("^-?(0*)\\d{1,10}$"),rf=-2147483648,sf=2147483647,of=function(e){if(nf.test(e)){const t=Number(e);if(t>=rf&&t<=sf)return t}return null},af=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw zd("Exception was thrown by user callback.",t),e}),Math.floor(0))}},cf=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class uf{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){zd(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lf{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Vd("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',zd(e)}}class hf{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}hf.OWNER="owner";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const df=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ff="websocket",pf="long_polling";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class gf{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=xd.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&xd.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function mf(e,t,n){let r;if(No("string"==typeof t,"typeof type must == string"),No("object"==typeof n,"typeof params must == object"),t===ff)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==pf)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return ef(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _f{constructor(){this.counters_={}}incrementCounter(e,t=1){ia(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Lo(this.counters_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const yf={},vf={};function wf(e){const t=e.toString();return yf[t]||(yf[t]=new _f),yf[t]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class bf{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&af((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const If="start";class Tf{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Bd(e),this.stats_=wf(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),mf(t,pf,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new bf(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Ef(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===If)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&df.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Tf.forceAllow_=!0}static forceDisallow(){Tf.forceDisallow_=!0}static isAvailable(){return!!Tf.forceAllow_||!(Tf.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Do(t),r=Zd(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ea(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Ef{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Ld(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Ef.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Vd("frame writing exception"),e.stack&&Vd(e.stack),Vd(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Vd("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Vd("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Sf=null;"undefined"!=typeof MozWebSocket?Sf=MozWebSocket:"undefined"!=typeof WebSocket&&(Sf=WebSocket);class Cf{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Bd(this.connId),this.stats_=wf(t),this.connURL=Cf.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&df.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),mf(e,ff,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,xd.set("previous_websocket_failure",!0);try{if(zo());else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Sf(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Cf.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Sf&&!Cf.forceDisallow_}static previouslyFailed(){return xd.isInMemoryStorage||!0===xd.get("previous_websocket_failure")}markConnectionHealthy(){xd.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Zo(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(No(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Zd(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Cf.responsesRequiredToBeHealthy=2,Cf.healthyTimeout=3e4;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class kf{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Tf,Cf]}initTransports_(e){const t=Cf&&Cf.isAvailable();let n=t&&!Cf.previouslyFailed();if(e.webSocketOnly&&(t||zd("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Cf];else{const e=this.transports_=[];for(const t of kf.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Rf{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Bd("c:"+this.id+":"),this.transportManager_=new kf(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=cf((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Jd("t",e),n=Jd("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Jd("t",e),n=Jd("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Jd("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Wd("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Wd("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&zd("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),cf((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):cf((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(xd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Nf{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Af{constructor(e){this.allowedEvents_=e,this.listeners_={},No(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){No(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Pf extends Af{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||jo()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Pf}getInitialEvent(e){return No("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xf{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Df(){return new xf("")}function Of(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Lf(e){return e.pieces_.length-e.pieceNum_}function Mf(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new xf(e.pieces_,t)}function Ff(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Uf(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function qf(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new xf(t,0)}function jf(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof xf)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new xf(n,0)}function Vf(e){return e.pieceNum_>=e.pieces_.length}function Bf(e,t){const n=Of(e),r=Of(t);if(null===n)return t;if(n===r)return Bf(Mf(e),Mf(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Wf(e,t){const n=Uf(e,0),r=Uf(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=Qd(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function $f(e,t){if(Lf(e)!==Lf(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function zf(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Lf(e)>Lf(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Kf{constructor(e,t){this.errorPrefix_=t,this.parts_=Uf(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=wa(this.parts_[e]);Hf(this)}}function Hf(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Gf(e))}function Gf(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Qf extends Af{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Qf}getInitialEvent(e){return No("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Yf=1e3;class Jf extends Nf{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Jf.nextPersistentConnectionId_++,this.log_=Bd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Yf,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!zo())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Qf.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Pf.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(ea(i)),No(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Fo,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),No(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;Jf.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&ia(e,"w")){const n=sa(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();zd(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||ra(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=na(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ea(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Wd("Unrecognized action received from server: "+ea(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){No(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Yf,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Yf,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Yf),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Jf.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){No(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?Vd("getToken() completed but was canceled"):(Vd("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new Rf(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{zd(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&zd(e),a())}}}interrupt(e){Vd("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Vd("Resuming connection for reason: "+e),delete this.interruptReasons_[e],oa(this.interruptReasons_)&&(this.reconnectDelay_=Yf,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Xd(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new xf(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Vd("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Vd("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+Rd.replace(/\./g,"-")]=1,jo()?e["framework.cordova"]=1:Wo()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Pf.getInstance().currentlyOnline();return oa(this.interruptReasons_)&&e}}Jf.nextPersistentConnectionId_=0,Jf.nextConnectionId_=0;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Xf{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Xf(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Zf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Xf(Hd,e),r=new Xf(Hd,t);return 0!==this.compare(n,r)}minPost(){return Xf.MIN}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let ep;class tp extends Zf{static get __EMPTY_NODE(){return ep}static set __EMPTY_NODE(e){ep=e}compare(e,t){return Qd(e.name,t.name)}isDefinedOn(e){throw Ao("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Xf.MIN}maxPost(){return new Xf(Gd,ep)}makePost(e,t){return No("string"==typeof e,"KeyIndex indexValue must always be a string."),new Xf(e,ep)}toString(){return".key"}}const np=new tp;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rp{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ip{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ip.RED,this.left=null!=r?r:sp.EMPTY_NODE,this.right=null!=i?i:sp.EMPTY_NODE}copy(e,t,n,r,i){return new ip(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return sp.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return sp.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ip.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ip.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ip.RED=!0,ip.BLACK=!1;class sp{constructor(e,t=sp.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new sp(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ip.BLACK,null,null))}remove(e){return new sp(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ip.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new rp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new rp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new rp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new rp(this.root_,null,this.comparator_,!0,e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function op(e,t){return Qd(e.name,t.name)}function ap(e,t){return Qd(e,t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let cp;sp.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new ip(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const up=function(e){return"number"==typeof e?"number:"+tf(e):"string:"+e},lp=function(e){if(e.isLeafNode()){const t=e.val();No("string"==typeof t||"number"==typeof t||"object"==typeof t&&ia(t,".sv"),"Priority must be a string or number.")}else No(e===cp||e.isEmpty(),"priority of unexpected type.");No(e===cp||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let hp,dp,fp;class pp{constructor(e,t=pp.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,No(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),lp(this.priorityNode_)}static set __childrenNodeConstructor(e){hp=e}static get __childrenNodeConstructor(){return hp}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new pp(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:pp.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Vf(e)?this:".priority"===Of(e)?this.priorityNode_:pp.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:pp.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Of(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(No(".priority"!==n||1===Lf(e),".priority must be the last token in a path"),this.updateImmediateChild(n,pp.__childrenNodeConstructor.EMPTY_NODE.updateChild(Mf(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+up(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?tf(this.value_):this.value_,this.lazyHash_=Md(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===pp.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof pp.__childrenNodeConstructor?-1:(No(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=pp.VALUE_TYPE_ORDER.indexOf(t),i=pp.VALUE_TYPE_ORDER.indexOf(n);return No(r>=0,"Unknown leaf type: "+t),No(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}pp.VALUE_TYPE_ORDER=["object","boolean","number","string"];const gp=new class extends Zf{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Qd(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Xf.MIN}maxPost(){return new Xf(Gd,new pp("[PRIORITY-POST]",fp))}makePost(e,t){const n=dp(e);return new Xf(t,new pp("[PRIORITY-POST]",n))}toString(){return".priority"}},mp=Math.log(2);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _p{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/mp,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const yp=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new ip(a,o.node,ip.BLACK,null,null);{const c=parseInt(s/2,10)+t,u=i(t,c),l=i(c+1,r);return o=e[c],a=n?n(o):o,new ip(a,o.node,ip.BLACK,u,l)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const u=i(s+1,a),l=e[s],h=n?n(l):l;c(new ip(h,l.node,r,null,u))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,ip.BLACK):(a(r,ip.BLACK),a(r,ip.RED))}return s}(new _p(e.length));return new sp(r||t,s)};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let vp;const wp={};class bp{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return No(wp&&gp,"ChildrenNode.ts has not been loaded"),vp=vp||new bp({".priority":wp},{".priority":gp}),vp}get(e){const t=sa(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof sp?t:null}hasIndex(e){return ia(this.indexSet_,e.toString())}addIndex(e,t){No(e!==np,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Xf.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?yp(n,e.getCompare()):wp;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=s,new bp(u,c)}addToIndexes(e,t){const n=aa(this.indexes_,((n,r)=>{const i=sa(this.indexSet_,r);if(No(i,"Missing index implementation for "+r),n===wp){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Xf.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),yp(n,i.getCompare())}return wp}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Xf(e.name,r))),i.insert(e,e.node)}}));return new bp(n,this.indexSet_)}removeFromIndexes(e,t){const n=aa(this.indexes_,(n=>{if(n===wp)return n;{const r=t.get(e.name);return r?n.remove(new Xf(e.name,r)):n}}));return new bp(n,this.indexSet_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Ip;class Tp{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&lp(this.priorityNode_),this.children_.isEmpty()&&No(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ip||(Ip=new Tp(new sp(ap),null,bp.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ip}updatePriority(e){return this.children_.isEmpty()?this:new Tp(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Ip:t}}getChild(e){const t=Of(e);return null===t?this:this.getImmediateChild(t).getChild(Mf(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(No(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Xf(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?Ip:this.priorityNode_;return new Tp(r,s,i)}}updateChild(e,t){const n=Of(e);if(null===n)return t;{No(".priority"!==Of(e)||1===Lf(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Mf(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(gp,((s,o)=>{t[s]=o.val(e),n++,i&&Tp.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+up(this.getPriority().val())+":"),this.forEachChild(gp,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Md(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Xf(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Xf(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Xf(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Xf.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Xf.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ep?-1:0}withIndex(e){if(e===np||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Tp(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===np||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(gp),n=t.getIterator(gp);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===np?null:this.indexMap_.get(e.toString())}}Tp.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Ep=new class extends Tp{constructor(){super(new sp(ap),Tp.EMPTY_NODE,bp.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Tp.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Xf,{MIN:{value:new Xf(Hd,Tp.EMPTY_NODE)},MAX:{value:new Xf(Gd,Ep)}}),tp.__EMPTY_NODE=Tp.EMPTY_NODE,pp.__childrenNodeConstructor=Tp,cp=Ep,function(e){fp=e}(Ep);function Sp(e,t=null){if(null===e)return Tp.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),No(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new pp(e,Sp(t))}if(e instanceof Array){let n=Tp.EMPTY_NODE;return ef(e,((t,r)=>{if(ia(e,t)&&"."!==t.substring(0,1)){const e=Sp(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Sp(t))}{const n=[];let r=!1;if(ef(e,((e,t)=>{if("."!==e.substring(0,1)){const i=Sp(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Xf(e,i)))}})),0===n.length)return Tp.EMPTY_NODE;const i=yp(n,op,(e=>e.name),ap);if(r){const e=yp(n,gp.getCompare());return new Tp(i,Sp(t),new bp({".priority":e},{".priority":gp}))}return new Tp(i,Sp(t),bp.Default)}}!function(e){dp=e}(Sp);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Cp extends Zf{constructor(e){super(),this.indexPath_=e,No(!Vf(e)&&".priority"!==Of(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Qd(e.name,t.name):i}makePost(e,t){const n=Sp(e),r=Tp.EMPTY_NODE.updateChild(this.indexPath_,n);return new Xf(t,r)}maxPost(){const e=Tp.EMPTY_NODE.updateChild(this.indexPath_,Ep);return new Xf(Gd,e)}toString(){return Uf(this.indexPath_,0).join("/")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const kp=new class extends Zf{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Qd(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Xf.MIN}maxPost(){return Xf.MAX}makePost(e,t){const n=Sp(e);return new Xf(t,n)}toString(){return".value"}},Rp="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Np=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=Rp.charAt(n%64),n=Math.floor(n/64);No(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=Rp.charAt(t[i]);return No(20===o.length,"nextPushId: Length should be 20."),o}}(),Ap=function(e){if("2147483647"===e)return"-";const t=of(e);if(null!=t)return""+(t+1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);if(n.length<786)return n.push("-"),n.join("");let r=n.length-1;for(;r>=0&&"z"===n[r];)r--;if(-1===r)return Gd;const i=n[r],s=Rp.charAt(Rp.indexOf(i)+1);return n[r]=s,n.slice(0,r+1).join("")},Pp=function(e){if("-2147483648"===e)return Hd;const t=of(e);if(null!=t)return""+(t-1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=Rp.charAt(Rp.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function xp(e){return{type:"value",snapshotNode:e}}function Dp(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Op(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Lp(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Mp{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){No(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(Op(t,o)):No(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(Dp(t,n)):s.trackChildChange(Lp(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(gp,((e,r)=>{t.hasChild(e)||n.trackChildChange(Op(e,r))})),t.isLeafNode()||t.forEachChild(gp,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Lp(t,r,i))}else n.trackChildChange(Dp(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Tp.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Fp{constructor(e){this.indexedFilter_=new Mp(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Fp.getStartPost_(e),this.endPost_=Fp.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,s){return this.matches(new Xf(t,n))||(n=Tp.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=Tp.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(Tp.EMPTY_NODE);const i=this;return t.forEachChild(gp,((e,t)=>{i.matches(new Xf(e,t))||(r=r.updateImmediateChild(e,Tp.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Up{constructor(e){this.rangedFilter_=new Fp(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new Xf(t,n))||(n=Tp.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=Tp.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=Tp.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let i;if(i=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!i)break;r=r.updateImmediateChild(t.name,t.node),n++}}else{let e,n,i,s;if(r=t.withIndex(this.index_),r=r.updatePriority(Tp.EMPTY_NODE),this.reverse_){s=r.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();i=(e,n)=>t(n,e)}else s=r.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),i=this.index_.getCompare();let o=0,a=!1;for(;s.hasNext();){const t=s.getNext();!a&&i(e,t)<=0&&(a=!0);a&&o<this.limit_&&i(t,n)<=0?o++:r=r.updateImmediateChild(t.name,Tp.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;No(o.numChildren()===this.limit_,"");const a=new Xf(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let l=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=l&&(l.name===t||o.hasChild(l.name));)l=r.getChildAfterChild(this.index_,l,this.reverse_);const h=null==l?1:s(l,a);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(Lp(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(Op(t,e));const n=o.updateImmediateChild(t,Tp.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=i&&i.trackChildChange(Dp(l.name,l.node)),n.updateImmediateChild(l.name,l.node)):n}}return n.isEmpty()?e:u&&s(c,a)>=0?(null!=i&&(i.trackChildChange(Op(c.name,c.node)),i.trackChildChange(Dp(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,Tp.EMPTY_NODE)):e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=gp}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return No(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return No(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Hd}hasEnd(){return this.endSet_}getIndexEndValue(){return No(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return No(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Gd}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return No(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===gp}copy(){const e=new qp;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function jp(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Vp(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Bp(e,t){const n=e.copy();return n.index_=t,n}function Wp(e){const t={};if(e.isDefault())return t;let n;return e.index_===gp?n="$priority":e.index_===kp?n="$value":e.index_===np?n="$key":(No(e.index_ instanceof Cp,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=ea(n),e.startSet_&&(t.startAt=ea(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+ea(e.indexStartName_))),e.endSet_&&(t.endAt=ea(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+ea(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function $p(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==gp&&(t.i=e.index_.toString()),t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zp extends Nf{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Bd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(No(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=zp.getListenId_(e,n),o={};this.listens_[s]=o;const a=Wp(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),sa(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=zp.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Wp(e._queryParams),n=e._path.toString(),r=new Fo;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ca(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=Zo(o.responseText)}catch(e){zd("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&zd("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Kp{constructor(){this.rootNode_=Tp.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Hp(){return{value:null,children:new Map}}function Gp(e,t,n){if(Vf(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Of(t);e.children.has(r)||e.children.set(r,Hp());Gp(e.children.get(r),t=Mf(t),n)}}function Qp(e,t){if(Vf(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(gp,((t,n)=>{Gp(e,new xf(t),n)})),Qp(e,t)}}if(e.children.size>0){const n=Of(t);if(t=Mf(t),e.children.has(n)){Qp(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function Yp(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,((e,r)=>{Yp(r,new xf(t.toString()+"/"+e),n)}))}class Jp{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&ef(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Xp{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Jp(e);const n=1e4+2e4*Math.random();cf(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;ef(e,((e,r)=>{r>0&&ia(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),cf(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Zp;function eg(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Zp||(Zp={}));class tg{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Zp.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Vf(this.path)){if(null!=this.affectedTree.value)return No(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new xf(e));return new tg(Df(),t,this.revert)}}return No(Of(this.path)===e,"operationForChild called for unrelated child."),new tg(Mf(this.path),this.affectedTree,this.revert)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ng{constructor(e,t){this.source=e,this.path=t,this.type=Zp.LISTEN_COMPLETE}operationForChild(e){return Vf(this.path)?new ng(this.source,Df()):new ng(this.source,Mf(this.path))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rg{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Zp.OVERWRITE}operationForChild(e){return Vf(this.path)?new rg(this.source,Df(),this.snap.getImmediateChild(e)):new rg(this.source,Mf(this.path),this.snap)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ig{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Zp.MERGE}operationForChild(e){if(Vf(this.path)){const t=this.children.subtree(new xf(e));return t.isEmpty()?null:t.value?new rg(this.source,Df(),t.value):new ig(this.source,Df(),t)}return No(Of(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ig(this.source,Mf(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class sg{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Vf(e))return this.isFullyInitialized()&&!this.filtered_;const t=Of(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class og{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function ag(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Ao("Should only compare child_ events.");const r=new Xf(t.childName,t.snapshotNode),i=new Xf(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function cg(e,t){return{eventCache:e,serverCache:t}}function ug(e,t,n,r){return cg(new sg(t,n,r),e.serverCache)}function lg(e,t,n,r){return cg(e.eventCache,new sg(t,n,r))}function hg(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function dg(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let fg;class pg{constructor(e,t=(()=>(fg||(fg=new sp(Yd)),fg))()){this.value=e,this.children=t}static fromObject(e){let t=new pg(null);return ef(e,((e,n)=>{t=t.set(new xf(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Df(),value:this.value};if(Vf(e))return null;{const n=Of(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Mf(e),t);if(null!=i){return{path:jf(new xf(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Vf(e))return this;{const t=Of(e),n=this.children.get(t);return null!==n?n.subtree(Mf(e)):new pg(null)}}set(e,t){if(Vf(e))return new pg(t,this.children);{const n=Of(e),r=(this.children.get(n)||new pg(null)).set(Mf(e),t),i=this.children.insert(n,r);return new pg(this.value,i)}}remove(e){if(Vf(e))return this.children.isEmpty()?new pg(null):new pg(null,this.children);{const t=Of(e),n=this.children.get(t);if(n){const r=n.remove(Mf(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new pg(null):new pg(this.value,i)}return this}}get(e){if(Vf(e))return this.value;{const t=Of(e),n=this.children.get(t);return n?n.get(Mf(e)):null}}setTree(e,t){if(Vf(e))return t;{const n=Of(e),r=(this.children.get(n)||new pg(null)).setTree(Mf(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new pg(this.value,i)}}fold(e){return this.fold_(Df(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(jf(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Df(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Vf(e))return null;{const r=Of(e),i=this.children.get(r);return i?i.findOnPath_(Mf(e),jf(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Df(),t)}foreachOnPath_(e,t,n){if(Vf(e))return this;{this.value&&n(t,this.value);const r=Of(e),i=this.children.get(r);return i?i.foreachOnPath_(Mf(e),jf(t,r),n):new pg(null)}}foreach(e){this.foreach_(Df(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(jf(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class gg{constructor(e){this.writeTree_=e}static empty(){return new gg(new pg(null))}}function mg(e,t,n){if(Vf(t))return new gg(new pg(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Bf(i,t);return s=s.updateChild(o,n),new gg(e.writeTree_.set(i,s))}{const r=new pg(n),i=e.writeTree_.setTree(t,r);return new gg(i)}}}function _g(e,t,n){let r=e;return ef(n,((e,n)=>{r=mg(r,jf(t,e),n)})),r}function yg(e,t){if(Vf(t))return gg.empty();{const n=e.writeTree_.setTree(t,new pg(null));return new gg(n)}}function vg(e,t){return null!=wg(e,t)}function wg(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Bf(n.path,t)):null}function bg(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(gp,((e,n)=>{t.push(new Xf(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Xf(e,n.value))})),t}function Ig(e,t){if(Vf(t))return e;{const n=wg(e,t);return new gg(null!=n?new pg(n):e.writeTree_.subtree(t))}}function Tg(e){return e.writeTree_.isEmpty()}function Eg(e,t){return Sg(Df(),e.writeTree_,t)}function Sg(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(No(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Sg(jf(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(jf(e,".priority"),r)),n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Cg(e,t){return qg(t,e)}function kg(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));No(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&Rg(t,r.path)?i=!1:zf(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=Ag(e.allWrites,Ng,Df()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=yg(e.visibleWrites,r.path);else{ef(r.children,(t=>{e.visibleWrites=yg(e.visibleWrites,jf(r.path,t))}))}return!0}return!1}function Rg(e,t){if(e.snap)return zf(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&zf(jf(e.path,n),t))return!0;return!1}function Ng(e){return e.visible}function Ag(e,t,n){let r=gg.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)zf(n,e)?(t=Bf(n,e),r=mg(r,t,s.snap)):zf(e,n)&&(t=Bf(e,n),r=mg(r,Df(),s.snap.getChild(t)));else{if(!s.children)throw Ao("WriteRecord should have .snap or .children");if(zf(n,e))t=Bf(n,e),r=_g(r,t,s.children);else if(zf(e,n))if(t=Bf(e,n),Vf(t))r=_g(r,Df(),s.children);else{const e=sa(s.children,Of(t));if(e){const n=e.getChild(Mf(t));r=mg(r,Df(),n)}}}}}return r}function Pg(e,t,n,r,i){if(r||i){const s=Ig(e.visibleWrites,t);if(!i&&Tg(s))return n;if(i||null!=n||vg(s,Df())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(zf(e.path,t)||zf(t,e.path))};return Eg(Ag(e.allWrites,s,t),n||Tp.EMPTY_NODE)}return null}{const r=wg(e.visibleWrites,t);if(null!=r)return r;{const r=Ig(e.visibleWrites,t);if(Tg(r))return n;if(null!=n||vg(r,Df())){return Eg(r,n||Tp.EMPTY_NODE)}return null}}}function xg(e,t,n,r){return Pg(e.writeTree,e.treePath,t,n,r)}function Dg(e,t){return function(e,t,n){let r=Tp.EMPTY_NODE;const i=wg(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(gp,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=Ig(e.visibleWrites,t);return n.forEachChild(gp,((e,t)=>{const n=Eg(Ig(i,new xf(e)),t);r=r.updateImmediateChild(e,n)})),bg(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return bg(Ig(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Og(e,t,n,r){return function(e,t,n,r,i){No(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=jf(t,n);if(vg(e.visibleWrites,s))return null;{const t=Ig(e.visibleWrites,s);return Tg(t)?i.getChild(n):Eg(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Lg(e,t){return function(e,t){return wg(e.visibleWrites,t)}(e.writeTree,jf(e.treePath,t))}function Mg(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=Ig(e.visibleWrites,t),u=wg(c,Df());if(null!=u)a=u;else{if(null==n)return[];a=Eg(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function Fg(e,t,n){return function(e,t,n,r){const i=jf(t,n),s=wg(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return Eg(Ig(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function Ug(e,t){return qg(jf(e.treePath,t),e.writeTree)}function qg(e,t){return{treePath:e,writeTree:t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class jg{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;No("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),No(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Lp(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Op(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Dp(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ao("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Lp(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Vg=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Bg{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new sg(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Fg(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:dg(this.viewCache_),i=Mg(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Wg(e,t,n,r,i){const s=new jg;let o,a;if(n.type===Zp.OVERWRITE){const c=n;c.source.fromUser?o=Kg(e,t,c.path,c.snap,r,i,s):(No(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!Vf(c.path),o=zg(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===Zp.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const u=jf(n,r);Hg(t,Of(u))&&(a=Kg(e,a,u,c,i,s,o))})),r.foreach(((r,c)=>{const u=jf(n,r);Hg(t,Of(u))||(a=Kg(e,a,u,c,i,s,o))})),a}(e,t,c.path,c.children,r,i,s):(No(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=Qg(e,t,c.path,c.children,r,i,a,s))}else if(n.type===Zp.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=Lg(r,n))return t;{const a=new Bg(r,t,i),c=t.eventCache.getNode();let u;if(Vf(n)||".priority"===Of(n)){let n;if(t.serverCache.isFullyInitialized())n=xg(r,dg(t));else{const e=t.serverCache.getNode();No(e instanceof Tp,"serverChildren would be complete if leaf node"),n=Dg(r,e)}n=n,u=e.filter.updateFullNode(c,n,s)}else{const i=Of(n);let l=Fg(r,i,t.serverCache);null==l&&t.serverCache.isCompleteForChild(i)&&(l=c.getImmediateChild(i)),u=null!=l?e.filter.updateChild(c,i,l,Mf(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,Tp.EMPTY_NODE,Mf(n),a,s):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=xg(r,dg(t)),o.isLeafNode()&&(u=e.filter.updateFullNode(u,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=Lg(r,Df()),ug(t,u,o,e.filter.filtersNodes())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=Lg(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(Vf(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return zg(e,t,n,c.getNode().getChild(n),i,s,a,o);if(Vf(n)){let r=new pg(null);return c.getNode().forEachChild(np,((e,t)=>{r=r.set(new xf(e),t)})),Qg(e,t,n,r,i,s,a,o)}return t}{let u=new pg(null);return r.foreach(((e,t)=>{const r=jf(n,e);c.isCompleteForPath(r)&&(u=u.set(e,c.getNode().getChild(r)))})),Qg(e,t,n,u,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==Zp.LISTEN_COMPLETE)throw Ao("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=lg(t,s.getNode(),s.isFullyInitialized()||Vf(n),s.isFiltered());return $g(e,o,n,r,Vg,i)}(e,t,n.path,r,s)}const c=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=hg(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(xp(hg(t)))}}(t,o,c),{viewCache:o,changes:c}}function $g(e,t,n,r,i,s){const o=t.eventCache;if(null!=Lg(r,n))return t;{let a,c;if(Vf(n))if(No(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=dg(t),i=Dg(r,n instanceof Tp?n:Tp.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=xg(r,dg(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const u=Of(n);if(".priority"===u){No(1===Lf(n),"Can't have a priority with additional path components");const i=o.getNode();c=t.serverCache.getNode();const s=Og(r,n,i,c);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const l=Mf(n);let h;if(o.isCompleteForChild(u)){c=t.serverCache.getNode();const e=Og(r,n,o.getNode(),c);h=null!=e?o.getNode().getImmediateChild(u).updateChild(l,e):o.getNode().getImmediateChild(u)}else h=Fg(r,u,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),u,h,l,i,s):o.getNode()}}return ug(t,a,o.isFullyInitialized()||Vf(n),e.filter.filtersNodes())}}function zg(e,t,n,r,i,s,o,a){const c=t.serverCache;let u;const l=o?e.filter:e.filter.getIndexedFilter();if(Vf(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),e,null)}else{const e=Of(n);if(!c.isCompleteForPath(n)&&Lf(n)>1)return t;const i=Mf(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);u=".priority"===e?l.updatePriority(c.getNode(),s):l.updateChild(c.getNode(),e,s,i,Vg,null)}const h=lg(t,u,c.isFullyInitialized()||Vf(n),l.filtersNodes());return $g(e,h,n,i,new Bg(i,h,s),a)}function Kg(e,t,n,r,i,s,o){const a=t.eventCache;let c,u;const l=new Bg(i,t,s);if(Vf(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=ug(t,u,!0,e.filter.filtersNodes());else{const i=Of(n);if(".priority"===i)u=e.filter.updatePriority(t.eventCache.getNode(),r),c=ug(t,u,a.isFullyInitialized(),a.isFiltered());else{const s=Mf(n),u=a.getNode().getImmediateChild(i);let h;if(Vf(s))h=r;else{const e=l.getCompleteChild(i);h=null!=e?".priority"===Ff(s)&&e.getChild(qf(s)).isEmpty()?e:e.updateChild(s,r):Tp.EMPTY_NODE}if(u.equals(h))c=t;else{c=ug(t,e.filter.updateChild(a.getNode(),i,h,s,l,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function Hg(e,t){return e.eventCache.isCompleteForChild(t)}function Gg(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Qg(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,u=t;c=Vf(n)?r:new pg(null).setTree(n,r);const l=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const c=Gg(0,t.serverCache.getNode().getImmediateChild(n),r);u=zg(e,u,new xf(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!c){const c=Gg(0,t.serverCache.getNode().getImmediateChild(n),r);u=zg(e,u,new xf(n),c,i,s,o,a)}})),u}class Yg{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Mp(n.getIndex()),i=(s=n).loadsAllData()?new Mp(s.getIndex()):s.hasLimit()?new Up(s):new Fp(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(Tp.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Tp.EMPTY_NODE,a.getNode(),null),l=new sg(c,o.isFullyInitialized(),r.filtersNodes()),h=new sg(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=cg(h,l),this.eventGenerator_=new og(this.query_)}get query(){return this.query_}}function Jg(e,t){const n=dg(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Vf(t)&&!n.getImmediateChild(Of(t)).isEmpty())?n.getChild(t):null}function Xg(e){return 0===e.eventRegistrations_.length}function Zg(e,t,n){const r=[];if(n){No(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function em(e,t,n,r){t.type===Zp.MERGE&&null!==t.source.queryId&&(No(dg(e.viewCache_),"We should always have a full cache before handling merges"),No(hg(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=Wg(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,No(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),No(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),No(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,tm(e,s.changes,s.viewCache.eventCache.getNode(),null)}function tm(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),ag(e,i,"child_removed",t,r,n),ag(e,i,"child_added",t,r,n),ag(e,i,"child_moved",s,r,n),ag(e,i,"child_changed",t,r,n),ag(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let nm,rm;class im{constructor(){this.views=new Map}}function sm(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return No(null!=s,"SyncTree gave us an op for an invalid query."),em(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(em(s,t,n,r));return i}}function om(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=xg(n,i?r:null),s=!1;e?s=!0:r instanceof Tp?(e=Dg(n,r),s=!1):(e=Tp.EMPTY_NODE,s=!1);const o=cg(new sg(e,s,!1),new sg(r,i,!1));return new Yg(t,o)}return o}function am(e,t,n,r,i,s){const o=om(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(gp,((e,t)=>{r.push(Dp(e,t))}));return n.isFullyInitialized()&&r.push(xp(n.getNode())),tm(e,r,n.getNode(),t)}(o,n)}function cm(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=fm(e);if("default"===i)for(const[t,i]of e.views.entries())o=o.concat(Zg(i,n,r)),Xg(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{const t=e.views.get(i);t&&(o=o.concat(Zg(t,n,r)),Xg(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!fm(e)&&s.push(new(No(nm,"Reference.ts has not been loaded"),nm)(t._repo,t._path)),{removed:s,events:o}}function um(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function lm(e,t){let n=null;for(const r of e.views.values())n=n||Jg(r,t);return n}function hm(e,t){if(t._queryParams.loadsAllData())return pm(e);{const n=t._queryIdentifier;return e.views.get(n)}}function dm(e,t){return null!=hm(e,t)}function fm(e){return null!=pm(e)}function pm(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let gm=1;class mm{constructor(e){this.listenProvider_=e,this.syncPointTree_=new pg(null),this.pendingWriteTree_={visibleWrites:gg.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function _m(e,t,n,r,i){return function(e,t,n,r,i){No(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=mg(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Sm(e,new rg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function ym(e,t,n,r){!function(e,t,n,r){No(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=_g(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=pg.fromObject(n);return Sm(e,new ig({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function vm(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(kg(e.pendingWriteTree_,t)){let t=new pg(null);return null!=r.snap?t=t.set(Df(),!0):ef(r.children,(e=>{t=t.set(new xf(e),!0)})),Sm(e,new tg(r.path,t,n))}return[]}function wm(e,t,n){return Sm(e,new rg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function bm(e,t,n,r){const i=t._path,s=e.syncPointTree_.get(i);let o=[];if(s&&("default"===t._queryIdentifier||dm(s,t))){const a=cm(s,t,n,r);0===s.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));const c=a.removed;o=a.events;const u=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),l=e.syncPointTree_.findOnPath(i,((e,t)=>fm(t)));if(u&&!l){const t=e.syncPointTree_.subtree(i);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&fm(t)){return[pm(t)]}{let e=[];return t&&(e=um(t)),ef(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=Rm(e,r);e.listenProvider_.startListening(Om(i),Nm(e,i),s.hashFn,s.onComplete)}}}if(!l&&c.length>0&&!r)if(u){const n=null;e.listenProvider_.stopListening(Om(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(Am(t));e.listenProvider_.stopListening(Om(t),n)}));!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=Am(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return o}function Im(e,t,n){const r=t._path;let i=null,s=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=Bf(e,r);i=i||lm(t,n),s=s||fm(t)}));let o,a=e.syncPointTree_.get(r);if(a?(s=s||fm(a),i=i||lm(a,Df())):(a=new im,e.syncPointTree_=e.syncPointTree_.set(r,a)),null!=i)o=!0;else{o=!1,i=Tp.EMPTY_NODE;e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const n=lm(t,Df());n&&(i=i.updateImmediateChild(e,n))}))}const c=dm(a,t);if(!c&&!t._queryParams.loadsAllData()){const n=Am(t);No(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=gm++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=am(a,t,n,Cg(e.pendingWriteTree_,r),i,o);if(!c&&!s){const n=hm(a,t);u=u.concat(function(e,t,n){const r=t._path,i=Nm(e,t),s=Rm(e,n),o=e.listenProvider_.startListening(Om(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)No(!fm(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!Vf(e)&&t&&fm(t))return[pm(t).query];{let e=[];return t&&(e=e.concat(um(t).map((e=>e.query)))),ef(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(Om(r),Nm(e,r))}}return o}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,n))}return u}function Tm(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=lm(n,Bf(e,t));if(r)return r}));return Pg(r,t,i,n,!0)}function Em(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Bf(e,n);r=r||lm(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||lm(i,Df()):(i=new im,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new sg(r,!0,!1):null;return function(e){return hg(e.viewCache_)}(om(i,t,Cg(e.pendingWriteTree_,t._path),s?o.getNode():Tp.EMPTY_NODE,s))}function Sm(e,t){return Cm(t,e.syncPointTree_,null,Cg(e.pendingWriteTree_,Df()))}function Cm(e,t,n,r){if(Vf(e.path))return km(e,t,n,r);{const i=t.get(Df());null==n&&null!=i&&(n=lm(i,Df()));let s=[];const o=Of(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=Ug(r,o);s=s.concat(Cm(a,c,e,t))}return i&&(s=s.concat(sm(i,e,r,n))),s}}function km(e,t,n,r){const i=t.get(Df());null==n&&null!=i&&(n=lm(i,Df()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=Ug(r,t),c=e.operationForChild(t);c&&(s=s.concat(km(c,i,o,a)))})),i&&(s=s.concat(sm(i,e,r,n))),s}function Rm(e,t){const n=t.query,r=Nm(e,n);return{hashFn:()=>(function(e){return e.viewCache_.serverCache.getNode()}(t)||Tp.EMPTY_NODE).hash(),onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=Pm(e,n);if(r){const n=xm(r),i=n.path,s=n.queryId,o=Bf(i,t);return Dm(e,i,new ng(eg(s),o))}return[]}(e,n._path,r):function(e,t){return Sm(e,new ng({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return bm(e,n,null,r)}}}}function Nm(e,t){const n=Am(t);return e.queryToTagMap.get(n)}function Am(e){return e._path.toString()+"$"+e._queryIdentifier}function Pm(e,t){return e.tagToQueryMap.get(t)}function xm(e){const t=e.indexOf("$");return No(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new xf(e.substr(0,t))}}function Dm(e,t,n){const r=e.syncPointTree_.get(t);No(r,"Missing sync point for query tag that we're tracking");return sm(r,n,Cg(e.pendingWriteTree_,t),null)}function Om(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(No(rm,"Reference.ts has not been loaded"),rm)(e._repo,e._path):e}class Lm{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Lm(t)}node(){return this.node_}}class Mm{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=jf(this.path_,e);return new Mm(this.syncTree_,t)}node(){return Tm(this.syncTree_,this.path_)}}const Fm=function(e,t,n){return e&&"object"==typeof e?(No(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Um(e[".sv"],t,n):"object"==typeof e[".sv"]?qm(e[".sv"],t):void No(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Um=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:No(!1,"Unexpected server value: "+e)}},qm=function(e,t,n){e.hasOwnProperty("increment")||No(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&No(!1,"Unexpected increment value: "+r);const i=t.node();if(No(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},jm=function(e,t,n,r){return Bm(t,new Mm(n,e),r)},Vm=function(e,t,n){return Bm(e,new Lm(t),n)};function Bm(e,t,n){const r=e.getPriority().val(),i=Fm(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Fm(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new pp(s,Sp(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new pp(i))),r.forEachChild(gp,((e,r)=>{const i=Bm(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Wm{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function $m(e,t){let n=t instanceof xf?t:new xf(t),r=e,i=Of(n);for(;null!==i;){const e=sa(r.node.children,i)||{children:{},childCount:0};r=new Wm(i,r,e),n=Mf(n),i=Of(n)}return r}function zm(e){return e.node.value}function Km(e,t){e.node.value=t,Jm(e)}function Hm(e){return e.node.childCount>0}function Gm(e,t){ef(e.node.children,((n,r)=>{t(new Wm(n,e,r))}))}function Qm(e,t,n,r){n&&!r&&t(e),Gm(e,(e=>{Qm(e,t,!0,r)})),n&&r&&t(e)}function Ym(e){return new xf(null===e.parent?e.name:Ym(e.parent)+"/"+e.name)}function Jm(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===zm(e)&&!Hm(e)}(n),i=ia(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Jm(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Jm(e))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.parent,e.name,e)}const Xm=/[\[\].#$\/\u0000-\u001F\u007F]/,Zm=/[\[\].#$\u0000-\u001F\u007F]/,e_=10485760,t_=function(e){return"string"==typeof e&&0!==e.length&&!Xm.test(e)},n_=function(e){return"string"==typeof e&&0!==e.length&&!Zm.test(e)},r_=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!Kd(e)||e&&"object"==typeof e&&ia(e,".sv")},i_=function(e,t,n,r){r&&void 0===t||s_(ma(e,"value"),t,n)},s_=function(e,t,n){const r=n instanceof xf?new Kf(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Gf(r));if("function"==typeof t)throw new Error(e+"contains a function "+Gf(r)+" with contents = "+t.toString());if(Kd(t))throw new Error(e+"contains "+t.toString()+" "+Gf(r));if("string"==typeof t&&t.length>e_/3&&wa(t)>e_)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+Gf(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(ef(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!t_(t)))throw new Error(e+" contains an invalid key ("+t+") "+Gf(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=wa(t),Hf(e)}(r,t),s_(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=wa(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Gf(r)+" in addition to actual children.")}},o_=function(e,t,n,r){if(r&&void 0===t)return;const i=ma(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];ef(t,((e,t)=>{const r=new xf(e);if(s_(i,t,jf(n,r)),".priority"===Ff(r)&&!r_(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=Uf(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!t_(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Wf);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&zf(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},a_=function(e,t,n){if(!n||void 0!==t){if(Kd(t))throw new Error(ma(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!r_(t))throw new Error(ma(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},c_=function(e,t,n,r){if(!(r&&void 0===n||t_(n)))throw new Error(ma(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},u_=function(e,t,n,r){if(!(r&&void 0===n||n_(n)))throw new Error(ma(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},l_=function(e,t){if(".info"===Of(t))throw new Error(e+" failed = Can't modify data under /.info/")},h_=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!t_(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),n_(e)}(n))throw new Error(ma(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class d_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function f_(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||$f(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function p_(e,t,n){f_(e,n),m_(e,(e=>$f(e,t)))}function g_(e,t,n){f_(e,n),m_(e,(e=>zf(e,t)||zf(t,e)))}function m_(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(__(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function __(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();Ud&&Vd("event: "+n.toString()),af(r)}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const y_="repo_interrupt";class v_{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new d_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hp(),this.transactionQueueTree_=new Wm,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function w_(e,t,n){if(e.stats_=wf(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new zp(e.repoInfo_,((t,n,r,i)=>{T_(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>E_(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ea(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Jf(e.repoInfo_,t,((t,n,r,i)=>{T_(e,t,n,r,i)}),(t=>{E_(e,t)}),(t=>{!function(e,t){ef(t,((t,n)=>{S_(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return vf[n]||(vf[n]=t()),vf[n]}(e.repoInfo_,(()=>new Xp(e.stats_,e.server_))),e.infoData_=new Kp,e.infoSyncTree_=new mm({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=wm(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),S_(e,"connected",!1),e.serverSyncTree_=new mm({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);g_(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function b_(e){const t=e.infoData_.getNode(new xf(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function I_(e){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:b_(e)})}function T_(e,t,n,r,i){e.dataUpdateCount++;const s=new xf(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=aa(n,(e=>Sp(e)));o=function(e,t,n,r){const i=Pm(e,r);if(i){const r=xm(i),s=r.path,o=r.queryId,a=Bf(s,t),c=pg.fromObject(n);return Dm(e,s,new ig(eg(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=Sp(n);o=function(e,t,n,r){const i=Pm(e,r);if(null!=i){const r=xm(i),s=r.path,o=r.queryId,a=Bf(s,t);return Dm(e,s,new rg(eg(o),a,n))}return[]}(e.serverSyncTree_,s,t,i)}else if(r){const t=aa(n,(e=>Sp(e)));o=function(e,t,n){const r=pg.fromObject(n);return Sm(e,new ig({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=Sp(n);o=wm(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=M_(e,s)),g_(e.eventQueue_,a,o)}function E_(e,t){S_(e,"connected",t),!1===t&&function(e){x_(e,"onDisconnectEvents");const t=I_(e),n=Hp();Yp(e.onDisconnect_,Df(),((r,i)=>{const s=jm(r,i,e.serverSyncTree_,t);Gp(n,r,s)}));let r=[];Yp(n,Df(),((t,n)=>{r=r.concat(wm(e.serverSyncTree_,t,n));const i=V_(e,t);M_(e,i)})),e.onDisconnect_=Hp(),g_(e.eventQueue_,Df(),r)}(e)}function S_(e,t,n){const r=new xf("/.info/"+t),i=Sp(n);e.infoData_.updateSnapshot(r,i);const s=wm(e.infoSyncTree_,r,i);g_(e.eventQueue_,r,s)}function C_(e){return e.nextWriteId_++}function k_(e,t,n,r,i){x_(e,"set",{path:t.toString(),value:n,priority:r});const s=I_(e),o=Sp(n,r),a=Tm(e.serverSyncTree_,t),c=Vm(o,a,s),u=C_(e),l=_m(e.serverSyncTree_,t,c,u,!0);f_(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||zd("set at "+t+" failed: "+n);const o=vm(e.serverSyncTree_,u,!s);g_(e.eventQueue_,t,o),D_(e,i,n,r)}));const h=V_(e,t);M_(e,h),g_(e.eventQueue_,h,[])}function R_(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&Qp(e.onDisconnect_,t),D_(e,n,r,i)}))}function N_(e,t,n,r){const i=Sp(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&Gp(e.onDisconnect_,t,i),D_(e,r,n,s)}))}function A_(e,t,n){let r;r=".info"===Of(t._path)?bm(e.infoSyncTree_,t,n):bm(e.serverSyncTree_,t,n),p_(e.eventQueue_,t._path,r)}function P_(e){e.persistentConnection_&&e.persistentConnection_.interrupt(y_)}function x_(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Vd(n,...t)}function D_(e,t,n,r){t&&af((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function O_(e,t,n){return Tm(e.serverSyncTree_,t,n)||Tp.EMPTY_NODE}function L_(e,t=e.transactionQueueTree_){if(t||j_(e,t),zm(t)){const n=U_(e,t);No(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=O_(e,t,r);let s=i;const o=i.hash();for(let e=0;e<n.length;e++){const r=n[e];No(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Bf(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,(r=>{x_(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(vm(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();j_(e,$m(e.transactionQueueTree_,t)),L_(e,e.transactionQueueTree_),g_(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)af(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{zd("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}M_(e,t)}}),o)}(e,Ym(t),n)}else Hm(t)&&Gm(t,(t=>{L_(e,t)}))}function M_(e,t){const n=F_(e,t),r=Ym(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let a=0;a<t.length;a++){const c=t[a],u=Bf(n,c.path);let l,h=!1;if(No(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,l=c.abortReason,i=i.concat(vm(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,l="maxretry",i=i.concat(vm(e.serverSyncTree_,c.currentWriteId,!0));else{const n=O_(e,c.path,s);c.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){s_("transaction failed: Data returned ",r,c.path);let t=Sp(r);"object"==typeof r&&null!=r&&ia(r,".priority")||(t=t.updatePriority(n.getPriority()));const o=c.currentWriteId,a=I_(e),u=Vm(t,n,a);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=u,c.currentWriteId=C_(e),s.splice(s.indexOf(o),1),i=i.concat(_m(e.serverSyncTree_,c.path,u,c.currentWriteId,c.applyLocally)),i=i.concat(vm(e.serverSyncTree_,o,!0))}else h=!0,l="nodata",i=i.concat(vm(e.serverSyncTree_,c.currentWriteId,!0))}g_(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,o=t[a].unwatcher,setTimeout(o,Math.floor(0)),t[a].onComplete&&("nodata"===l?r.push((()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot))):r.push((()=>t[a].onComplete(new Error(l),!1,null)))))}var o;j_(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)af(r[e]);L_(e,e.transactionQueueTree_)}(e,U_(e,n),r),r}function F_(e,t){let n,r=e.transactionQueueTree_;for(n=Of(t);null!==n&&void 0===zm(r);)r=$m(r,n),n=Of(t=Mf(t));return r}function U_(e,t){const n=[];return q_(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function q_(e,t,n){const r=zm(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Gm(t,(t=>{q_(e,t,n)}))}function j_(e,t){const n=zm(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Km(t,n.length>0?n:void 0)}Gm(t,(t=>{j_(e,t)}))}function V_(e,t){const n=Ym(F_(e,t)),r=$m(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{B_(e,t)})),B_(e,r),Qm(r,(t=>{B_(e,t)})),n}function B_(e,t){const n=zm(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(No(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(No(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(vm(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Km(t,void 0):n.length=s+1,g_(e.eventQueue_,Ym(t),i);for(let e=0;e<r.length;e++)af(r[e])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const W_=function(e,t){const n=$_(e),r=n.namespace;"firebase.com"===n.domain&&$d(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||$d("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&zd("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new gf(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new xf(n.pathString)}},$_=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let u=e.indexOf("//");u>=0&&(a=e.substring(0,u-1),e=e.substring(u+2));let l=e.indexOf("/");-1===l&&(l=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(l,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):zd(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));u=t.indexOf(":"),u>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(u+1),10)):u=t.length;const f=t.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class z_{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ea(this.snapshot.exportVal())}}class K_{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class H_{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return No(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class G_{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Fo;return R_(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){l_("OnDisconnect.remove",this._path);const e=new Fo;return N_(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){l_("OnDisconnect.set",this._path),i_("OnDisconnect.set",e,this._path,!1);const t=new Fo;return N_(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){l_("OnDisconnect.setWithPriority",this._path),i_("OnDisconnect.setWithPriority",e,this._path,!1),a_("OnDisconnect.setWithPriority",t,!1);const n=new Fo;return function(e,t,n,r,i){const s=Sp(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&Gp(e.onDisconnect_,t,s),D_(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){l_("OnDisconnect.update",this._path),o_("OnDisconnect.update",e,this._path,!1);const t=new Fo;return function(e,t,n,r){if(oa(n))return Vd("onDisconnect().update() called with empty data.  Don't do anything."),void D_(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&ef(n,((n,r)=>{const i=Sp(r);Gp(e.onDisconnect_,jf(t,n),i)})),D_(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Q_{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Vf(this._path)?null:Ff(this._path)}get ref(){return new Z_(this._repo,this._path)}get _queryIdentifier(){const e=$p(this._queryParams),t=Xd(e);return"{}"===t?"default":t}get _queryObject(){return $p(this._queryParams)}isEqual(e){if(!((e=Ia(e))instanceof Q_))return!1;const t=this._repo===e._repo,n=$f(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function Y_(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function J_(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===np){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==Hd)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Gd)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===gp){if(null!=t&&!r_(t)||null!=n&&!r_(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(No(e.getIndex()instanceof Cp||e.getIndex()===kp,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function X_(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Z_ extends Q_{constructor(e,t){super(e,t,new qp,!1)}get parent(){const e=qf(this._path);return null===e?null:new Z_(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class ey{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new xf(e),n=ry(this.ref,e);return new ey(this._node.getChild(t),n,gp)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new ey(n,ry(this.ref,t),gp))))}hasChild(e){const t=new xf(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ty(e,t){return(e=Ia(e))._checkNotDeleted("ref"),void 0!==t?ry(e._root,t):e._root}function ny(e,t){(e=Ia(e))._checkNotDeleted("refFromURL");const n=W_(t,e._repo.repoInfo_.nodeAdmin);h_("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||$d("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),ty(e,n.path.toString())}function ry(e,t){var n,r,i,s;return null===Of((e=Ia(e))._path)?(n="child",r="path",s=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),u_(n,r,i,s)):u_("child","path",t,!1),new Z_(e._repo,jf(e._path,t))}function iy(e,t){e=Ia(e),l_("set",e._path),i_("set",t,e._path,!1);const n=new Fo;return k_(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function sy(e,t){o_("update",t,e._path,!1);const n=new Fo;return function(e,t,n,r){x_(e,"update",{path:t.toString(),value:n});let i=!0;const s=I_(e),o={};if(ef(n,((n,r)=>{i=!1,o[n]=jm(jf(t,n),Sp(r),e.serverSyncTree_,s)})),i)Vd("update() called with empty data.  Don't do anything."),D_(0,r,"ok",void 0);else{const i=C_(e),s=ym(e.serverSyncTree_,t,o,i);f_(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||zd("update at "+t+" failed: "+n);const a=vm(e.serverSyncTree_,i,!o),c=a.length>0?M_(e,t):t;g_(e.eventQueue_,c,a),D_(0,r,n,s)})),ef(n,(n=>{const r=V_(e,jf(t,n));M_(e,r)})),g_(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function oy(e){return function(e,t){const n=Em(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((n=>{const r=Sp(n),i=wm(e.serverSyncTree_,t._path,r);return p_(e.eventQueue_,t._path,i),Promise.resolve(r)}),(n=>(x_(e,"get for query "+ea(t)+" failed: "+n),Promise.reject(new Error(n)))))}((e=Ia(e))._repo,e).then((t=>new ey(t,new Z_(e._repo,e._path),e._queryParams.getIndex())))}class ay{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new z_("value",this,new ey(e.snapshotNode,new Z_(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new K_(this,e,t):null}matches(e){return e instanceof ay&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class cy{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new K_(this,e,t):null}createEvent(e,t){No(null!=e.childName,"Child events should have a childName.");const n=ry(new Z_(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new z_(e.type,this,new ey(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof cy&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function uy(e,t,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{A_(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new H_(n,s||void 0),a="value"===t?new ay(o):new cy(t,o);return function(e,t,n){let r;r=".info"===Of(t._path)?Im(e.infoSyncTree_,t,n):Im(e.serverSyncTree_,t,n),p_(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>A_(e._repo,e,a)}function ly(e,t,n,r){return uy(e,"value",t,n,r)}function hy(e,t,n,r){return uy(e,"child_added",t,n,r)}function dy(e,t,n,r){return uy(e,"child_changed",t,n,r)}function fy(e,t,n,r){return uy(e,"child_moved",t,n,r)}function py(e,t,n,r){return uy(e,"child_removed",t,n,r)}function gy(e,t,n){let r=null;const i=n?new H_(n):null;"value"===t?r=new ay(i):t&&(r=new cy(t,i)),A_(e._repo,e,r)}class my{}class _y extends my{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){i_("endAt",this._value,e._path,!0);const t=Vp(e._queryParams,this._value,this._key);if(X_(t),J_(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Q_(e._repo,e._path,t,e._orderByCalled)}}class yy extends my{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){i_("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r,i;return e.index_===np?("string"==typeof t&&(t=Pp(t)),i=Vp(e,t,n)):(r=null==n?Hd:Pp(n),i=Vp(e,t,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(X_(t),J_(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Q_(e._repo,e._path,t,e._orderByCalled)}}class vy extends my{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){i_("startAt",this._value,e._path,!0);const t=jp(e._queryParams,this._value,this._key);if(X_(t),J_(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Q_(e._repo,e._path,t,e._orderByCalled)}}class wy extends my{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){i_("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;if(e.index_===np)"string"==typeof t&&(t=Ap(t)),r=jp(e,t,n);else{let i;i=null==n?Gd:Ap(n),r=jp(e,t,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(X_(t),J_(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Q_(e._repo,e._path,t,e._orderByCalled)}}class by extends my{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Q_(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class Iy extends my{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Q_(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class Ty extends my{constructor(e){super(),this._path=e}_apply(e){Y_(e,"orderByChild");const t=new xf(this._path);if(Vf(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new Cp(t),r=Bp(e._queryParams,n);return J_(r),new Q_(e._repo,e._path,r,!0)}}class Ey extends my{_apply(e){Y_(e,"orderByKey");const t=Bp(e._queryParams,np);return J_(t),new Q_(e._repo,e._path,t,!0)}}class Sy extends my{_apply(e){Y_(e,"orderByPriority");const t=Bp(e._queryParams,gp);return J_(t),new Q_(e._repo,e._path,t,!0)}}class Cy extends my{_apply(e){Y_(e,"orderByValue");const t=Bp(e._queryParams,kp);return J_(t),new Q_(e._repo,e._path,t,!0)}}class ky extends my{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(i_("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new _y(this._value,this._key)._apply(new vy(this._value,this._key)._apply(e))}}function Ry(e,...t){let n=Ia(e);for(const e of t)n=e._apply(n);return n}!function(e){No(!nm,"__referenceConstructor has already been defined"),nm=e}(Z_),function(e){No(!rm,"__referenceConstructor has already been defined"),rm=e}(Z_);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Ny={};function Ay(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||$d("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Vd("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=W_(s,i),u=c.repoInfo;"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${u.namespace}`,c=W_(s,i),u=c.repoInfo):o=!c.repoInfo.secure;const l=i&&o?new hf(hf.OWNER):new lf(e.name,e.options,t);h_("Invalid Firebase Database URL",c),Vf(c.path)||$d("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=Ny[t.name];i||(i={},Ny[t.name]=i);let s=i[e.toURLString()];s&&$d("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new v_(e,false,n,r),i[e.toURLString()]=s,s}(u,e,l,new uf(e.name,n));return new Py(h,e)}class Py{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(w_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Z_(this._repo,Df())),this._rootInternal}_delete(){return this._checkNotDeleted("delete"),function(e,t){const n=Ny[t];n&&n[e.key]===e||$d(`Database ${t}(${e.repoInfo_}) has already been deleted.`),P_(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null,Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&$d("Cannot call "+e+" on a deleted database.")}}function xy(e,t,n,r={}){(e=Ia(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&$d("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&$d('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new hf(hf.OWNER);else if(r.mockUserToken){const t=Uo(r.mockUserToken,e.app.options.projectId);s=new hf(t)}!function(e,t,n,r){e.repoInfo_=new gf(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(i,t,n,s)}function Dy(e){var t;(e=Ia(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(y_)}function Oy(e,t){jd(e,t)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Ly={".sv":"timestamp"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class My{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function Fy(e,t,n){var r;if(e=Ia(e),l_("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new Fo,o=ly(e,(()=>{}));return function(e,t,n,r,i,s){x_(e,"transaction on "+t);const o={path:t,update:n,onComplete:r,status:null,order:Ld(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=O_(e,t,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(void 0===c)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{s_("transaction failed: Data returned ",c,o.path),o.status=0;const n=$m(e.transactionQueueTree_,t),r=zm(n)||[];let i;r.push(o),Km(n,r),"object"==typeof c&&null!==c&&ia(c,".priority")?(i=sa(c,".priority"),No(r_(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(Tm(e.serverSyncTree_,t)||Tp.EMPTY_NODE).getPriority().val();const s=I_(e),u=Sp(c,i),l=Vm(u,a,s);o.currentOutputSnapshotRaw=u,o.currentOutputSnapshotResolved=l,o.currentWriteId=C_(e);const h=_m(e.serverSyncTree_,t,l,o.currentWriteId,o.applyLocally);g_(e.eventQueue_,t,h),L_(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let i=null;t?s.reject(t):(i=new ey(r,new Z_(e._repo,e._path),gp),s.resolve(new My(n,i)))}),o,i),s.promise}!function(e){!function(e){Rd=e}(Ga),$a(new Ta("database-exp",((e,{instanceIdentifier:t})=>Ay(e.getProvider("app-exp").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/database","0.0.900-exp.d92a36260",e)}();
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Uy{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ea(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Zo(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qy{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ia(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const jy=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Uy(t)}}catch(e){}return new qy},Vy=jy("localStorage"),By=jy("sessionStorage"),Wy=new Oa("@firebase/database"),$y=function(){let e=1;return function(){return e++}}(),zy=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=zy.apply(null,r):t+="object"==typeof r?ea(r):r,t+=" "}return t};let Ky=null,Hy=!0;const Gy=function(...e){var t,n;if(!0===Hy&&(Hy=!1,null===Ky&&!0===By.get("logging_enabled")&&(t=!0,No(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Wy.logLevel=ka.VERBOSE,Ky=Wy.log.bind(Wy),n&&By.set("logging_enabled",!0)):"function"==typeof t?Ky=t:(Ky=null,By.remove("logging_enabled")))),Ky){const t=zy.apply(null,e);Ky(t)}},Qy=function(e){return function(...t){Gy(e,...t)}},Yy=function(...e){const t="FIREBASE INTERNAL ERROR: "+zy(...e);Wy.error(t)},Jy=function(...e){const t="FIREBASE WARNING: "+zy(...e);Wy.warn(t)},Xy="[MIN_NAME]",Zy="[MAX_NAME]",ev=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+ea(t))},tv=function(e){if("object"!=typeof e||null===e)return ea(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=ea(t[r]),n+=":",n+=tv(e[t[r]]);return n+="}",n},nv=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function rv(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const iv=function(e){No(!function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)}(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()},sv=new RegExp("^-?(0*)\\d{1,10}$"),ov=function(e){if(sv.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},av=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw Jy("Exception was thrown by user callback.",t),e}),Math.floor(0))}},cv=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class uv{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function lv(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const hv=/[\[\].#$\u0000-\u001F\u007F]/,dv=function(e,t,n,r){if(!(r&&void 0===n||function(e){return"string"==typeof e&&0!==e.length&&!hv.test(e)}(n)))throw new Error(ma(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},fv=function(e,t){if(".info"===lv(t))throw new Error(e+" failed = Can't modify data under /.info/")};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class pv{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new pv(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let gv;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let mv;class _v{constructor(e,t=_v.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,No(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),function(e){if(e.isLeafNode()){const t=e.val();No("string"==typeof t||"number"==typeof t||"object"==typeof t&&ia(t,".sv"),"Priority must be a string or number.")}else No(e===gv||e.isEmpty(),"priority of unexpected type.");No(e===gv||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}(this.priorityNode_)}static set __childrenNodeConstructor(e){mv=e}static get __childrenNodeConstructor(){return mv}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new _v(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:_v.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return function(e){return e.pieceNum_>=e.pieces_.length}(e)?this:".priority"===lv(e)?this.priorityNode_:_v.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:_v.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=lv(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(No(".priority"!==n||1===function(e){return e.pieces_.length-e.pieceNum_}(e),".priority must be the last token in a path"),this.updateImmediateChild(n,_v.__childrenNodeConstructor.EMPTY_NODE.updateChild(function(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new uv(e.pieces_,t)}(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+(("number"==typeof(e=this.priorityNode_.val())?"number:"+iv(e):"string:"+e)+":"));const n=typeof this.value_;t+=n+":",t+="number"===n?iv(this.value_):this.value_,this.lazyHash_=function(e){const t=va(e),n=new ha;n.update(t);const r=n.digest();return xo.encodeByteArray(r)}(t)}var e;return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===_v.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof _v.__childrenNodeConstructor?-1:(No(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=_v.VALUE_TYPE_ORDER.indexOf(t),i=_v.VALUE_TYPE_ORDER.indexOf(n);return No(r>=0,"Unknown leaf type: "+t),No(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}_v.VALUE_TYPE_ORDER=["object","boolean","number","string"];const yv=new class extends class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new pv(Xy,e),r=new pv(Xy,t);return 0!==this.compare(n,r)}minPost(){return pv.MIN}}{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?function(e,t){if(e===t)return 0;if(e===Xy||t===Zy)return-1;if(t===Xy||e===Zy)return 1;{const n=ov(e),r=ov(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}}(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return pv.MIN}maxPost(){return new pv(Zy,new _v("[PRIORITY-POST]",undefined))}makePost(e,t){const n=undefined();return new pv(t,new _v("[PRIORITY-POST]",n))}toString(){return".priority"}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vv{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=yv}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return No(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return No(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Xy}hasEnd(){return this.endSet_}getIndexEndValue(){return No(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return No(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zy}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return No(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===yv}copy(){const e=new vv;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wv{constructor(e){this._delegate=e}cancel(e){ga("OnDisconnect.cancel",0,1,arguments.length),_a("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){ga("OnDisconnect.remove",0,1,arguments.length),_a("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){ga("OnDisconnect.set",1,2,arguments.length),_a("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){ga("OnDisconnect.setWithPriority",2,3,arguments.length),_a("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(ga("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Jy("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_a("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bv{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ga("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Iv{constructor(e,t){this._database=e,this._delegate=t}val(){return ga("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ga("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ga("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ga("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ga("DataSnapshot.child",0,1,arguments.length),e=String(e),dv("DataSnapshot.child","path",e,!1),new Iv(this._database,this._delegate.child(e))}hasChild(e){return ga("DataSnapshot.hasChild",1,1,arguments.length),dv("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ga("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ga("DataSnapshot.forEach",1,1,arguments.length),_a("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new Iv(this._database,t))))}hasChildren(){return ga("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ga("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ga("DataSnapshot.ref",0,0,arguments.length),new Ev(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Tv{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;ga("Query.on",2,4,arguments.length),_a("Query.on","callback",t,!1);const s=Tv.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new Iv(this.database,e),n)};o.userCallback=t,o.context=s.context;const a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return ly(this._delegate,o,a),t;case"child_added":return hy(this._delegate,o,a),t;case"child_removed":return py(this._delegate,o,a),t;case"child_changed":return dy(this._delegate,o,a),t;case"child_moved":return fy(this._delegate,o,a),t;default:throw new Error(ma("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(ga("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ma(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),_a("Query.off","callback",t,!0),ya("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,gy(this._delegate,e,r)}else gy(this._delegate,e)}get(){return oy(this._delegate).then((e=>new Iv(this.database,e)))}once(e,t,n,r){ga("Query.once",1,4,arguments.length),_a("Query.once","callback",t,!0);const i=Tv.getCancelAndContextArgs_("Query.once",n,r),s=new Fo,o=(e,n)=>{const r=new Iv(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;const a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":ly(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":hy(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":py(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":dy(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":fy(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(ma("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return ga("Query.limitToFirst",1,1,arguments.length),new Tv(this.database,Ry(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new by(e)}(e)))}limitToLast(e){return ga("Query.limitToLast",1,1,arguments.length),new Tv(this.database,Ry(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Iy(e)}(e)))}orderByChild(e){return ga("Query.orderByChild",1,1,arguments.length),new Tv(this.database,Ry(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return u_("orderByChild","path",e,!1),new Ty(e)}(e)))}orderByKey(){return ga("Query.orderByKey",0,0,arguments.length),new Tv(this.database,Ry(this._delegate,new Ey))}orderByPriority(){return ga("Query.orderByPriority",0,0,arguments.length),new Tv(this.database,Ry(this._delegate,new Sy))}orderByValue(){return ga("Query.orderByValue",0,0,arguments.length),new Tv(this.database,Ry(this._delegate,new Cy))}startAt(e=null,t){return ga("Query.startAt",0,2,arguments.length),new Tv(this.database,Ry(this._delegate,function(e=null,t){return c_("startAt","key",t,!0),new vy(e,t)}(e,t)))}startAfter(e=null,t){return ga("Query.startAfter",0,2,arguments.length),new Tv(this.database,Ry(this._delegate,function(e,t){return c_("startAfter","key",t,!0),new wy(e,t)}(e,t)))}endAt(e=null,t){return ga("Query.endAt",0,2,arguments.length),new Tv(this.database,Ry(this._delegate,function(e,t){return c_("endAt","key",t,!0),new _y(e,t)}(e,t)))}endBefore(e=null,t){return ga("Query.endBefore",0,2,arguments.length),new Tv(this.database,Ry(this._delegate,function(e,t){return c_("endBefore","key",t,!0),new yy(e,t)}(e,t)))}equalTo(e,t){return ga("Query.equalTo",1,2,arguments.length),new Tv(this.database,Ry(this._delegate,function(e,t){return c_("equalTo","key",t,!0),new ky(e,t)}(e,t)))}toString(){return ga("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ga("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ga("Query.isEqual",1,1,arguments.length),!(e instanceof Tv)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,_a(e,"cancel",r.cancel,!0),r.context=n,ya(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(ma(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new Ev(this.database,new Z_(this._delegate._repo,this._delegate._path))}}class Ev extends Tv{constructor(e,t){super(e,new Q_(t._repo,t._path,new vv,!1)),this.database=e,this._delegate=t}getKey(){return ga("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ga("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Ev(this.database,ry(this._delegate,e))}getParent(){ga("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Ev(this.database,e):null}getRoot(){return ga("Reference.root",0,0,arguments.length),new Ev(this.database,this._delegate.root)}set(e,t){ga("Reference.set",1,2,arguments.length),_a("Reference.set","onComplete",t,!0);const n=iy(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(ga("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Jy("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}fv("Reference.update",this._delegate._path),_a("Reference.update","onComplete",t,!0);const n=sy(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){ga("Reference.setWithPriority",2,3,arguments.length),_a("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if(l_("setWithPriority",e._path),i_("setWithPriority",t,e._path,!1),a_("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new Fo;return k_(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){ga("Reference.remove",0,1,arguments.length),_a("Reference.remove","onComplete",e,!0);const t=function(e){return l_("remove",e._path),iy(e,null)}(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){ga("Reference.transaction",1,3,arguments.length),_a("Reference.transaction","transactionUpdate",e,!1),_a("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(ma(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=Fy(this._delegate,e,{applyLocally:n}).then((e=>new bv(e.committed,new Iv(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){ga("Reference.setPriority",1,2,arguments.length),_a("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=Ia(e),l_("setPriority",e._path),a_("setPriority",t,!1);const n=new Fo;return k_(e._repo,jf(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){ga("Reference.push",0,2,arguments.length),_a("Reference.push","onComplete",t,!0);const n=function(e,t){e=Ia(e),l_("push",e._path),i_("push",t,e._path,!0);const n=b_(e._repo),r=Np(n),i=ry(e,r),s=ry(e,r);let o;return o=null!=t?iy(s,t).then((()=>s)):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),r=n.then((e=>new Ev(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const i=new Ev(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return fv("Reference.onDisconnect",this._delegate._path),new wv(new G_(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Sv{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete()}}useEmulator(e,t,n={}){xy(this._delegate,e,t,n)}ref(e){if(ga("database.ref",0,1,arguments.length),e instanceof Ev){const t=ny(this._delegate,e.toString());return new Ev(this,t)}{const t=ty(this._delegate,e);return new Ev(this,t)}}refFromURL(e){ga("database.refFromURL",1,1,arguments.length);const t=ny(this._delegate,e);return new Ev(this,t)}goOffline(){return ga("database.goOffline",0,0,arguments.length),function(e){(e=Ia(e))._checkNotDeleted("goOffline"),P_(e._repo)}(this._delegate)}goOnline(){return ga("database.goOnline",0,0,arguments.length),Dy(this._delegate)}}Sv.ServerValue={TIMESTAMP:Ly,increment:e=>function(e){return{".sv":{increment:e}}}(e)};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Cv=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,kv="websocket",Rv="long_polling";function Nv(e,t,n){let r;if(No("string"==typeof t,"typeof type must == string"),No("object"==typeof n,"typeof params must == object"),t===kv)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Rv)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return rv(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Av{constructor(){this.counters_={}}incrementCounter(e,t=1){ia(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Lo(this.counters_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Pv={};function xv(e){const t=e.toString();return Pv[t]||(Pv[t]=new Av),Pv[t]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Dv{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&av((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Ov="start";class Lv{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qy(e),this.stats_=xv(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),Nv(t,Rv,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Dv(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Mv(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===Ov)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Cv.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Lv.forceAllow_=!0}static forceDisallow(){Lv.forceDisallow_=!0}static isAvailable(){return!!Lv.forceAllow_||!(Lv.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Do(t),r=nv(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ea(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Mv{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=$y(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Mv.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Gy("frame writing exception"),e.stack&&Gy(e.stack),Gy(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Gy("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Gy("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Fv="";function Uv(e){Fv=e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let qv=null;"undefined"!=typeof MozWebSocket?qv=MozWebSocket:"undefined"!=typeof WebSocket&&(qv=WebSocket);class jv{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qy(this.connId),this.stats_=xv(t),this.connURL=jv.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&Cv.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),Nv(e,kv,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Vy.set("previous_websocket_failure",!0);try{if(zo());else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new qv(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){jv.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==qv&&!jv.forceDisallow_}static previouslyFailed(){return Vy.isInMemoryStorage||!0===Vy.get("previous_websocket_failure")}markConnectionHealthy(){Vy.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Zo(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(No(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=nv(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}jv.responsesRequiredToBeHealthy=2,jv.healthyTimeout=3e4;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Vv{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Lv,jv]}initTransports_(e){const t=jv&&jv.isAvailable();let n=t&&!jv.previouslyFailed();if(e.webSocketOnly&&(t||Jy("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[jv];else{const e=this.transports_=[];for(const t of Vv.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Bv{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qy("c:"+this.id+":"),this.transportManager_=new Vv(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=cv((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=ev("t",e),n=ev("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=ev("t",e),n=ev("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=ev("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Yy("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Yy("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Jy("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),cv((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):cv((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Vy.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Wv{constructor(e){this.allowedEvents_=e,this.listeners_={},No(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){No(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $v extends Wv{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||jo()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new $v}getInitialEvent(e){return No("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zv extends Wv{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new zv}getInitialEvent(e){return No("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Kv=1e3;class Hv extends class{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Hv.nextPersistentConnectionId_++,this.log_=Qy("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Kv,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!zo())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");zv.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&$v.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(ea(i)),No(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Fo,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),No(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;Hv.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&ia(e,"w")){const n=sa(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Jy(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||ra(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=na(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ea(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Yy("Unrecognized action received from server: "+ea(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){No(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Kv,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Kv,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Kv),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Hv.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){No(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?Gy("getToken() completed but was canceled"):(Gy("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new Bv(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{Jy(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&Jy(e),a())}}}interrupt(e){Gy("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Gy("Resuming connection for reason: "+e),delete this.interruptReasons_[e],oa(this.interruptReasons_)&&(this.reconnectDelay_=Kv,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>tv(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new uv(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Gy("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Gy("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+Fv.replace(/\./g,"-")]=1,jo()?e["framework.cordova"]=1:Wo()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=$v.getInstance().currentlyOnline();return oa(this.interruptReasons_)&&e}}Hv.nextPersistentConnectionId_=0,Hv.nextConnectionId_=0;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Gv{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&rv(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Qv=Object.freeze({__proto__:null,forceLongPolling:function(){jv.forceDisallow(),Lv.forceAllow()},forceWebSockets:function(){Lv.forceDisallow()},isWebSocketsAvailable:function(){return jv.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t=!1){if("undefined"==typeof console)return;let n;t?(e.statsListener_||(e.statsListener_=new Gv(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();const r=Object.keys(n).reduce(((e,t)=>Math.max(t.length,e)),0);rv(n,((e,t)=>{let n=e;for(let t=e.length;t<r+2;t++)n+=" ";console.log(n+t)}))}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){var n,r;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */e.stats_.incrementCounter(t),n=e.statsReporter_,r=t,n.statsToReport_[r]=!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function({app:e,url:t,version:n,customAuthImpl:r,namespace:i,nodeAdmin:s=!1}){Uv(n);const o=new Sa("auth-internal",new Ra("database-standalone"));return o.setComponent(new Ta("auth-internal",(()=>r),"PRIVATE")),{instance:new Sv(Ay(e,o,void 0,t,s),e),namespace:i}}});
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Yv=Hv;Hv.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Hv.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};const Jv=Bv,Xv=
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Vy.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Vy.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};var Zv=Object.freeze({__proto__:null,DataConnection:Yv,RealTimeConnection:Jv,hijackHash:function(e){const t=Hv.prototype.put;return Hv.prototype.put=function(n,r,i,s){void 0!==s&&(s=e()),t.call(this,n,r,i,s)},function(){Hv.prototype.put=t}},ConnectionTarget:Xv,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){}});const ew=Sv.ServerValue;!function(e){Uv(e.SDK_VERSION),e.INTERNAL.registerComponent(new Ta("database-compat",((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database-exp").getImmediate({identifier:t});return new Sv(r,n)}),"PUBLIC").setServiceProps({Reference:Ev,Query:Tv,Database:Sv,DataSnapshot:Iv,enableLogging:Oy,INTERNAL:Qv,ServerValue:ew,TEST_ACCESS:Zv}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","0.0.900-exp.d92a36260")}(oc);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var tw=function(e,t){return(tw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function nw(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var rw,iw="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},sw=sw||{},ow=iw||self;function aw(){}function cw(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function uw(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var lw="closure_uid_"+(1e9*Math.random()>>>0),hw=0;function dw(e,t,n){return e.call.apply(e.bind,arguments)}function fw(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function pw(e,t,n){return(pw=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?dw:fw).apply(null,arguments)}function gw(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function mw(){return Date.now()}function _w(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Kb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function yw(){this.j=this.j,this.i=this.i}yw.prototype.j=!1,yw.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(e){Object.prototype.hasOwnProperty.call(e,lw)&&e[lw]||(e[lw]=++hw)})(this)},yw.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var vw=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},ww=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function bw(e){return Array.prototype.concat.apply([],arguments)}function Iw(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Tw(e){return/^[\s\xa0]*$/.test(e)}var Ew,Sw=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Cw(e,t){return-1!=e.indexOf(t)}function kw(e,t){return e<t?-1:e>t?1:0}e:{var Rw=ow.navigator;if(Rw){var Nw=Rw.userAgent;if(Nw){Ew=Nw;break e}}Ew=""}function Aw(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Pw(e){var t={};for(var n in e)t[n]=e[n];return t}var xw="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Dw(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<xw.length;s++)n=xw[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Ow(e){return Ow[" "](e),e}Ow[" "]=aw;var Lw,Mw,Fw=Cw(Ew,"Opera"),Uw=Cw(Ew,"Trident")||Cw(Ew,"MSIE"),qw=Cw(Ew,"Edge"),jw=qw||Uw,Vw=Cw(Ew,"Gecko")&&!(Cw(Ew.toLowerCase(),"webkit")&&!Cw(Ew,"Edge"))&&!(Cw(Ew,"Trident")||Cw(Ew,"MSIE"))&&!Cw(Ew,"Edge"),Bw=Cw(Ew.toLowerCase(),"webkit")&&!Cw(Ew,"Edge");function Ww(){var e=ow.document;return e?e.documentMode:void 0}e:{var $w="",zw=(Mw=Ew,Vw?/rv:([^\);]+)(\)|;)/.exec(Mw):qw?/Edge\/([\d\.]+)/.exec(Mw):Uw?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Mw):Bw?/WebKit\/(\S+)/.exec(Mw):Fw?/(?:Version)[ \/]?(\S+)/.exec(Mw):void 0);if(zw&&($w=zw?zw[1]:""),Uw){var Kw=Ww();if(null!=Kw&&Kw>parseFloat($w)){Lw=String(Kw);break e}}Lw=$w}var Hw,Gw={};function Qw(e){return function(e,t){var n=Gw;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(){for(var t=0,n=Sw(String(Lw)).split("."),r=Sw(String(e)).split("."),i=Math.max(n.length,r.length),s=0;0==t&&s<i;s++){var o=n[s]||"",a=r[s]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;t=kw(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||kw(0==o[2].length,0==a[2].length)||kw(o[2],a[2]),o=o[3],a=a[3]}while(0==t)}return 0<=t}))}if(ow.document&&Uw){var Yw=Ww();Hw=Yw||(parseInt(Lw,10)||void 0)}else Hw=void 0;var Jw=Hw,Xw=!Uw||9<=Number(Jw),Zw=Uw&&!Qw("9"),eb=function(){if(!ow.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{ow.addEventListener("test",aw,t),ow.removeEventListener("test",aw,t)}catch(e){}return e}();function tb(e,t){this.type=e,this.a=this.target=t,this.defaultPrevented=!1}function nb(e,t){if(tb.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(Vw){e:{try{Ow(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:rb[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}tb.prototype.b=function(){this.defaultPrevented=!0},_w(nb,tb);var rb={2:"touch",3:"pen",4:"mouse"};nb.prototype.b=function(){nb.X.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Zw)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}};var ib="closure_listenable_"+(1e6*Math.random()|0),sb=0;function ob(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ca=i,this.key=++sb,this.Y=this.Z=!1}function ab(e){e.Y=!0,e.listener=null,e.proxy=null,e.src=null,e.ca=null}function cb(e){this.src=e,this.a={},this.b=0}function ub(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],s=vw(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(ab(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function lb(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.Y&&s.listener==t&&s.capture==!!n&&s.ca==r)return i}return-1}cb.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.a[s])||(e=this.a[s]=[],this.b++);var o=lb(e,t,r,i);return-1<o?(t=e[o],n||(t.Z=!1)):((t=new ob(t,this.src,s,!!r,i)).Z=n,e.push(t)),t};var hb="closure_lm_"+(1e6*Math.random()|0),db={};function fb(e,t,n,r,i){if(r&&r.once)return gb(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)fb(e,t[s],n,r,i);return null}return n=Tb(n),e&&e[ib]?e.va(t,n,uw(r)?!!r.capture:!!r,i):pb(e,t,n,!1,r,i)}function pb(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=uw(i)?!!i.capture:!!i;if(o&&!Xw)return null;var a=bb(e);if(a||(e[hb]=a=new cb(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=wb,t=Xw?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)eb||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(yb(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function gb(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)gb(e,t[s],n,r,i);return null}return n=Tb(n),e&&e[ib]?e.wa(t,n,uw(r)?!!r.capture:!!r,i):pb(e,t,n,!0,r,i)}function mb(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)mb(e,t[s],n,r,i);else r=uw(r)?!!r.capture:!!r,n=Tb(n),e&&e[ib]?(e=e.c,(t=String(t).toString())in e.a&&(-1<(n=lb(s=e.a[t],n,r,i))&&(ab(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.a[t],e.b--)))):e&&(e=bb(e))&&(t=e.a[t.toString()],e=-1,t&&(e=lb(t,n,r,i)),(n=-1<e?t[e]:null)&&_b(n))}function _b(e){if("number"!=typeof e&&e&&!e.Y){var t=e.src;if(t&&t[ib])ub(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(yb(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=bb(t))?(ub(n,e),0==n.b&&(n.src=null,t[hb]=null)):ab(e)}}}function yb(e){return e in db?db[e]:db[e]="on"+e}function vb(e,t){var n=e.listener,r=e.ca||e.src;return e.Z&&_b(e),n.call(r,t)}function wb(e,t){if(e.Y)return!0;if(!Xw){if(!t)e:{t=["window","event"];for(var n=ow,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return vb(e,t=new nb(t,this))}return vb(e,new nb(t,this))}function bb(e){return(e=e[hb])instanceof cb?e:null}var Ib="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tb(e){return"function"==typeof e?e:(e[Ib]||(e[Ib]=function(t){return e.handleEvent(t)}),e[Ib])}function Eb(){yw.call(this),this.c=new cb(this),this.J=this,this.C=null}function Sb(e,t){var n,r=e.C;if(r)for(n=[];r;r=r.C)n.push(r);if(e=e.J,r=t.type||t,"string"==typeof t)t=new tb(t,e);else if(t instanceof tb)t.target=t.target||e;else{var i=t;Dw(t=new tb(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.a=n[s];i=Cb(o,r,!0,t)&&i}if(i=Cb(o=t.a=e,r,!0,t)&&i,i=Cb(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Cb(o=t.a=n[s],r,!1,t)&&i}function Cb(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.Y&&o.capture==n){var a=o.listener,c=o.ca||o.src;o.Z&&ub(e.c,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}_w(Eb,yw),Eb.prototype[ib]=!0,(rw=Eb.prototype).addEventListener=function(e,t,n,r){fb(this,e,t,n,r)},rw.removeEventListener=function(e,t,n,r){mb(this,e,t,n,r)},rw.G=function(){if(Eb.X.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)ab(n[r]);delete t.a[e],t.b--}}this.C=null},rw.va=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},rw.wa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var kb=ow.JSON.stringify;function Rb(){this.b=this.a=null}var Nb,Ab=new(function(){function e(e,t){this.c=e,this.f=t,this.b=0,this.a=null}return e.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e},e}())((function(){return new xb}),(function(e){e.reset()}));function Pb(){var e=Mb,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function xb(){this.next=this.b=this.a=null}function Db(e){ow.setTimeout((function(){throw e}),0)}function Ob(e,t){Nb||function(){var e=ow.Promise.resolve(void 0);Nb=function(){e.then(Fb)}}(),Lb||(Nb(),Lb=!0),Mb.add(e,t)}Rb.prototype.add=function(e,t){var n=Ab.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},xb.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},xb.prototype.reset=function(){this.next=this.b=this.a=null};var Lb=!1,Mb=new Rb;function Fb(){for(var e;e=Pb();){try{e.a.call(e.b)}catch(e){Db(e)}var t=Ab;t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}Lb=!1}function Ub(e,t){Eb.call(this),this.b=e||1,this.a=t||ow,this.f=pw(this.Za,this),this.g=mw()}function qb(e){e.aa=!1,e.M&&(e.a.clearTimeout(e.M),e.M=null)}function jb(e,t,n){if("function"==typeof e)n&&(e=pw(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=pw(e.handleEvent,e)}return 2147483647<Number(t)?-1:ow.setTimeout(e,t||0)}function Vb(e){e.a=jb((function(){e.a=null,e.c&&(e.c=!1,Vb(e))}),e.h);var t=e.b;e.b=null,e.g.apply(null,t)}_w(Ub,Eb),(rw=Ub.prototype).aa=!1,rw.M=null,rw.Za=function(){if(this.aa){var e=mw()-this.g;0<e&&e<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-e):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Sb(this,"tick"),this.aa&&(qb(this),this.start()))}},rw.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=mw())},rw.G=function(){Ub.X.G.call(this),qb(this),delete this.a};var Bb=function(e){function t(t,n){var r=e.call(this)||this;return r.g=t,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(e,t){function n(){this.constructor=e}tw(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.f=function(e){this.b=arguments,this.a?this.c=!0:Vb(this)},t.prototype.G=function(){e.prototype.G.call(this),this.a&&(ow.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},t}(yw);function Wb(e){yw.call(this),this.b=e,this.a={}}_w(Wb,yw);var $b=[];function zb(e,t,n,r){Array.isArray(n)||(n&&($b[0]=n.toString()),n=$b);for(var i=0;i<n.length;i++){var s=fb(t,n[i],r||e.handleEvent,!1,e.b||e);if(!s)break;e.a[s.key]=s}}function Kb(e){Aw(e.a,(function(e,t){this.a.hasOwnProperty(t)&&_b(e)}),e),e.a={}}function Hb(){this.a=!0}function Gb(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.a)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return kb(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Wb.prototype.G=function(){Wb.X.G.call(this),Kb(this)},Wb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Hb.prototype.info=function(){};var Qb={},Yb=null;function Jb(){return Yb=Yb||new Eb}function Xb(e){tb.call(this,Qb.Fa,e)}function Zb(e){var t=Jb();Sb(t,new Xb(t,e))}function eI(e,t){tb.call(this,Qb.STAT_EVENT,e),this.stat=t}function tI(e){var t=Jb();Sb(t,new eI(t,e))}function nI(e){tb.call(this,Qb.Ga,e)}function rI(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return ow.setTimeout((function(){e()}),t)}Qb.Fa="serverreachability",_w(Xb,tb),Qb.STAT_EVENT="statevent",_w(eI,tb),Qb.Ga="timingevent",_w(nI,tb);var iI={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},sI={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function oI(){}function aI(e){var t;return(t=e.a)||(t=e.a={}),t}function cI(){}oI.prototype.a=null;var uI,lI={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function hI(){tb.call(this,"d")}function dI(){tb.call(this,"c")}function fI(){}function pI(e,t,n,r){this.g=e,this.c=t,this.f=n,this.S=r||1,this.J=new Wb(this),this.P=gI,e=jw?125:void 0,this.R=new Ub(e),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}_w(hI,tb),_w(dI,tb),_w(fI,oI),uI=new fI;var gI=45e3,mI={},_I={};function yI(e,t,n){e.H=1,e.i=jI(OI(t)),e.j=n,e.I=!0,vI(e,null)}function vI(e,t){e.u=mw(),II(e),e.l=OI(e.i);var n=e.l,r=e.S;Array.isArray(r)||(r=[String(r)]),ZI(n.b,"t",r),e.D=0,e.a=HT(e.g,e.g.C?t:null),0<e.O&&(e.F=new Bb(pw(e.Ca,e,e.a),e.O)),zb(e.J,e.a,"readystatechange",e.Xa),t=e.B?Pw(e.B):{},e.j?(e.m||(e.m="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ba(e.l,e.m,e.j,t)):(e.m="GET",e.a.ba(e.l,e.m,null,t)),Zb(1),function(e,t,n,r,i,s){e.info((function(){if(e.a)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.c,e.m,e.l,e.f,e.S,e.j)}function wI(e,t,n){for(var r=!0;!e.A&&e.D<n.length;){var i=bI(e,n);if(i==_I){4==t&&(e.h=4,tI(14),r=!1),Gb(e.c,e.f,null,"[Incomplete Response]");break}if(i==mI){e.h=4,tI(15),Gb(e.c,e.f,n,"[Invalid Chunk]"),r=!1;break}Gb(e.c,e.f,i,null),kI(e,i)}4==t&&0==n.length&&(e.h=1,tI(16),r=!1),e.b=e.b&&r,r?0<n.length&&!e.V&&(e.V=!0,(t=e.g).a==e&&t.U&&!t.F&&(t.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),qT(t),t.F=!0,tI(11))):(Gb(e.c,e.f,n,"[Invalid Chunked Response]"),CI(e),SI(e))}function bI(e,t){var n=e.D,r=t.indexOf("\n",n);return-1==r?_I:(n=Number(t.substring(n,r)),isNaN(n)?mI:(r+=1)+n>t.length?_I:(t=t.substr(r,n),e.D=r+n,t))}function II(e){e.T=mw()+e.P,TI(e,e.P)}function TI(e,t){if(null!=e.o)throw Error("WatchDog timer not null");e.o=rI(pw(e.Va,e),t)}function EI(e){e.o&&(ow.clearTimeout(e.o),e.o=null)}function SI(e){0==e.g.v||e.A||BT(e.g,e)}function CI(e){EI(e);var t=e.F;t&&"function"==typeof t.ja&&t.ja(),e.F=null,qb(e.R),Kb(e.J),e.a&&(t=e.a,e.a=null,t.abort(),t.ja())}function kI(e,t){try{var n=e.g;if(0!=n.v&&(n.a==e||oT(n.b,e)))if(n.I=e.N,!e.C&&oT(n.b,e)&&3==n.v){try{var r=n.ka.a.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.j){if(n.a){if(!(n.a.u+3e3<e.u))break e;VT(n),AT(n)}UT(n),tI(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=rI(pw(n.Sa,n),6e3));if(1>=sT(n.b)&&n.ea){try{n.ea()}catch(e){}n.ea=void 0}}else $T(n,11)}else if((e.C||n.a==e)&&VT(n),!Tw(t))for(t=r=n.ka.a.parse(t),r=0;r<t.length;r++)if(i=t[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var s=i[3];null!=s&&(n.ha=s,n.c.info("VER="+n.ha));var o=i[4];null!=o&&(n.pa=o,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var c=1.5*a;n.D=c,n.c.info("backChannelRequestTimeoutMs_="+c)}c=n;var u=e.a;if(u){var l=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=c.b;!h.a&&(Cw(l,"spdy")||Cw(l,"quic")||Cw(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(aT(h,h.b),h.b=null))}if(c.A){var d=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;d&&(c.na=d,qI(c.B,c.A,d))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=mw()-e.u,n.c.info("Handshake RTT: "+n.N+"ms"));var f=e;if((c=n).la=KT(c,c.C?c.ga:null,c.fa),f.C){cT(c.b,f);var p=f,g=c.D;g&&p.setTimeout(g),p.o&&(EI(p),II(p)),c.a=f}else FT(c);0<n.g.length&&DT(n)}else"stop"!=i[0]&&"close"!=i[0]||$T(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?$T(n,7):NT(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Zb(4)}catch(e){}}function RI(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(cw(e)||"string"==typeof e)ww(e,t,void 0);else{if(e.L&&"function"==typeof e.L)var n=e.L();else if(e.K&&"function"==typeof e.K)n=void 0;else if(cw(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.K&&"function"==typeof e.K)return e.K();if("string"==typeof e)return e.split("");if(cw(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function NI(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof NI)for(n=e.L(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function AI(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];PI(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)PI(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function PI(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(rw=pI.prototype).setTimeout=function(e){this.P=e},rw.Xa=function(e){e=e.target;var t=this.F;t&&3==ST(e)?t.f():this.Ca(e)},rw.Ca=function(e){try{if(e==this.a)e:{var t=ST(this.a),n=this.a.ua(),r=this.a.W();if(!(3>t||3==t&&!jw&&!this.a.$())){this.A||4!=t||7==n||Zb(8==n||0>=r?3:2),EI(this);var i=this.a.W();this.N=i;var s=this.a.$();if(this.b=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.c,this.m,this.l,this.f,this.S,t,i),this.b){if(this.U&&!this.C){t:{if(this.a){var o,a=this.a;if((o=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Tw(o)){var c=o;break t}}c=null}if(!c){this.b=!1,this.h=3,tI(12),CI(this),SI(this);break e}Gb(this.c,this.f,c,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,kI(this,c)}this.I?(wI(this,t,s),jw&&this.b&&3==t&&(zb(this.J,this.R,"tick",this.Wa),this.R.start())):(Gb(this.c,this.f,s,null),kI(this,s)),4==t&&CI(this),this.b&&!this.A&&(4==t?BT(this.g,this):(this.b=!1,II(this)))}else 400==i&&0<s.indexOf("Unknown SID")?(this.h=3,tI(12)):(this.h=0,tI(13)),CI(this),SI(this)}}}catch(e){}},rw.Wa=function(){if(this.a){var e=ST(this.a),t=this.a.$();this.D<t.length&&(EI(this),wI(this,e,t),this.b&&4!=e&&II(this))}},rw.cancel=function(){this.A=!0,CI(this)},rw.Va=function(){this.o=null;var e=mw();0<=e-this.T?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.c,this.l),2!=this.H&&(Zb(3),tI(17)),CI(this),this.h=2,SI(this)):TI(this,this.T-e)},(rw=NI.prototype).K=function(){AI(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},rw.L=function(){return AI(this),this.a.concat()},rw.get=function(e,t){return PI(this.b,e)?this.b[e]:t},rw.set=function(e,t){PI(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},rw.forEach=function(e,t){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var xI=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function DI(e,t){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,e instanceof DI){this.a=void 0!==t?t:e.a,LI(this,e.f),this.j=e.j,MI(this,e.c),FI(this,e.h),this.g=e.g,t=e.b;var n=new QI;n.c=t.c,t.a&&(n.a=new NI(t.a),n.b=t.b),UI(this,n),this.i=e.i}else e&&(n=String(e).match(xI))?(this.a=!!t,LI(this,n[1]||"",!0),this.j=VI(n[2]||""),MI(this,n[3]||"",!0),FI(this,n[4]),this.g=VI(n[5]||"",!0),UI(this,n[6]||"",!0),this.i=VI(n[7]||"")):(this.a=!!t,this.b=new QI(null,this.a))}function OI(e){return new DI(e)}function LI(e,t,n){e.f=n?VI(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function MI(e,t,n){e.c=n?VI(t,!0):t}function FI(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.h=t}else e.h=null}function UI(e,t,n){t instanceof QI?(e.b=t,function(e,t){t&&!e.f&&(YI(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(JI(this,t),ZI(this,n,e))}),e)),e.f=t}(e.b,e.a)):(n||(t=BI(t,HI)),e.b=new QI(t,e.a))}function qI(e,t,n){e.b.set(t,n)}function jI(e){return qI(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^mw()).toString(36)),e}function VI(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function BI(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,WI),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function WI(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}DI.prototype.toString=function(){var e=[],t=this.f;t&&e.push(BI(t,$I,!0),":");var n=this.c;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(BI(t,$I,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&e.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&e.push("/"),e.push(BI(n,"/"==n.charAt(0)?KI:zI,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.i)&&e.push("#",BI(n,GI)),e.join("")};var $I=/[#\/\?@]/g,zI=/[#\?:]/g,KI=/[#\?]/g,HI=/[#\?@]/g,GI=/#/g;function QI(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function YI(e){e.a||(e.a=new NI,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function JI(e,t){YI(e),t=eT(e,t),PI(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,PI((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&AI(e)))}function XI(e,t){return YI(e),t=eT(e,t),PI(e.a.b,t)}function ZI(e,t,n){JI(e,t),0<n.length&&(e.c=null,e.a.set(eT(e,t),Iw(n)),e.b+=n.length)}function eT(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(rw=QI.prototype).add=function(e,t){YI(this),this.c=null,e=eT(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},rw.forEach=function(e,t){YI(this),this.a.forEach((function(n,r){ww(n,(function(n){e.call(t,n,r,this)}),this)}),this)},rw.L=function(){YI(this);for(var e=this.a.K(),t=this.a.L(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},rw.K=function(e){YI(this);var t=[];if("string"==typeof e)XI(this,e)&&(t=bw(t,this.a.get(eT(this,e))));else{e=this.a.K();for(var n=0;n<e.length;n++)t=bw(t,e[n])}return t},rw.set=function(e,t){return YI(this),this.c=null,XI(this,e=eT(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},rw.get=function(e,t){return e&&0<(e=this.K(e)).length?String(e[0]):t},rw.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.L(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.K(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.c=e.join("&")};var tT=function(e,t){this.b=e,this.a=t};function nT(e){this.g=e||rT,ow.PerformanceNavigationTiming?e=0<(e=ow.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(ow.ia&&ow.ia.ya&&ow.ia.ya()&&ow.ia.ya().Lb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var rT=10;function iT(e){return!!e.b||!!e.a&&e.a.size>=e.f}function sT(e){return e.b?1:e.a?e.a.size:0}function oT(e,t){return e.b?e.b==t:!!e.a&&e.a.has(t)}function aT(e,t){e.a?e.a.add(t):e.b=t}function cT(e,t){e.b&&e.b==t?e.b=null:e.a&&e.a.has(t)&&e.a.delete(t)}function uT(e){var t,n;if(null!=e.b)return e.c.concat(e.b.s);if(null!=e.a&&0!==e.a.size){var r=e.c;try{for(var i=nw(e.a.values()),s=i.next();!s.done;s=i.next()){var o=s.value;r=r.concat(o.s)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return Iw(e.c)}function lT(){}function hT(){this.a=new lT}function dT(e,t,n){var r=n||"";try{RI(e,(function(e,n){var i=e;uw(e)&&(i=kb(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function fT(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}nT.prototype.cancel=function(){var e,t;if(this.c=uT(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=nw(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},lT.prototype.stringify=function(e){return ow.JSON.stringify(e,void 0)},lT.prototype.parse=function(e){return ow.JSON.parse(e,void 0)};var pT=ow.JSON.parse;function gT(e){Eb.call(this),this.headers=new NI,this.H=e||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=mT,this.D=this.F=!1}_w(gT,Eb);var mT="",_T=/^https?$/i,yT=["POST","PUT"];function vT(e){return"content-type"==e.toLowerCase()}function wT(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,bT(e),TT(e)}function bT(e){e.u||(e.u=!0,Sb(e,"complete"),Sb(e,"error"))}function IT(e){if(e.b&&void 0!==sw&&(!e.s[1]||4!=ST(e)||2!=e.W()))if(e.l&&4==ST(e))jb(e.za,0,e);else if(Sb(e,"readystatechange"),4==ST(e)){e.b=!1;try{var t,n=e.W();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.B).match(xI)[1]||null;if(!s&&ow.self&&ow.self.location){var o=ow.self.location.protocol;s=o.substr(0,o.length-1)}i=!_T.test(s?s.toLowerCase():"")}t=i}if(t)Sb(e,"complete"),Sb(e,"success");else{e.h=6;try{var a=2<ST(e)?e.a.statusText:""}catch(n){a=""}e.f=a+" ["+e.W()+"]",bT(e)}}finally{TT(e)}}}function TT(e,t){if(e.a){ET(e);var n=e.a,r=e.s[0]?aw:null;e.a=null,e.s=null,t||Sb(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function ET(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(ow.clearTimeout(e.m),e.m=null)}function ST(e){return e.a?e.a.readyState:0}function CT(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return Aw(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):qI(e,t,n))}function kT(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function RT(e){this.pa=0,this.g=[],this.c=new Hb,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=kT("failFast",!1,e),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=kT("baseRetryDelayMs",5e3,e),this.Ra=kT("retryDelaySeedMs",1e4,e),this.Ma=kT("forwardChannelMaxRetries",2,e),this.ma=kT("forwardChannelRequestTimeoutMs",2e4,e),this.Na=e&&e.g||void 0,this.D=void 0,this.C=e&&e.supportsCrossDomainXhr||!1,this.J="",this.b=new nT(e&&e.concurrentRequestLimit),this.ka=new hT,this.da=e&&e.fastHandshake||!1,this.Ia=e&&e.b||!1,e&&e.f&&(this.c.a=!1),e&&e.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&e&&e.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=e&&e.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function NT(e){if(PT(e),3==e.v){var t=e.R++,n=OI(e.B);qI(n,"SID",e.J),qI(n,"RID",t),qI(n,"TYPE","terminate"),LT(e,n),(t=new pI(e,e.c,t,void 0)).H=2,t.i=jI(OI(n)),n=!1,ow.navigator&&ow.navigator.sendBeacon&&(n=ow.navigator.sendBeacon(t.i.toString(),"")),!n&&ow.Image&&((new Image).src=t.i,n=!0),n||(t.a=HT(t.g,null),t.a.ba(t.i)),t.u=mw(),II(t)}zT(e)}function AT(e){e.a&&(qT(e),e.a.cancel(),e.a=null)}function PT(e){AT(e),e.j&&(ow.clearTimeout(e.j),e.j=null),VT(e),e.b.cancel(),e.h&&("number"==typeof e.h&&ow.clearTimeout(e.h),e.h=null)}function xT(e,t){e.g.push(new tT(e.Oa++,t)),3==e.v&&DT(e)}function DT(e){iT(e.b)||e.h||(e.h=!0,Ob(e.Ba,e),e.u=0)}function OT(e,t){var n;n=t?t.f:e.R++;var r=OI(e.B);qI(r,"SID",e.J),qI(r,"RID",n),qI(r,"AID",e.P),LT(e,r),e.i&&e.l&&CT(r,e.i,e.l),n=new pI(e,e.c,n,e.u+1),null===e.i&&(n.B=e.l),t&&(e.g=t.s.concat(e.g)),t=MT(e,n,1e3),n.setTimeout(Math.round(.5*e.ma)+Math.round(.5*e.ma*Math.random())),aT(e.b,n),yI(n,r,t)}function LT(e,t){e.f&&RI({},(function(e,n){qI(t,n,e)}))}function MT(e,t,n){n=Math.min(e.g.length,n);var r=e.f?pw(e.f.Ja,e.f,e):null;e:for(var i=e.g,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].b,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].b,l=i[c].a;if(0>(u-=s))s=Math.max(0,i[c].b-100),a=!1;else try{dT(l,o,"req"+u+"_")}catch(e){r&&r(l)}}if(a){r=o.join("&");break e}}return e=e.g.splice(0,n),t.s=e,r}function FT(e){e.a||e.j||(e.T=1,Ob(e.Aa,e),e.o=0)}function UT(e){return!(e.a||e.j||3<=e.o)&&(e.T++,e.j=rI(pw(e.Aa,e),WT(e,e.o)),e.o++,!0)}function qT(e){null!=e.s&&(ow.clearTimeout(e.s),e.s=null)}function jT(e){e.a=new pI(e,e.c,"rpc",e.T),null===e.i&&(e.a.B=e.l),e.a.O=0;var t=OI(e.la);qI(t,"RID","rpc"),qI(t,"SID",e.J),qI(t,"CI",e.H?"0":"1"),qI(t,"AID",e.P),LT(e,t),qI(t,"TYPE","xmlhttp"),e.i&&e.l&&CT(t,e.i,e.l),e.D&&e.a.setTimeout(e.D);var n=e.a;e=e.ga,n.H=1,n.i=jI(OI(t)),n.j=null,n.I=!0,vI(n,e)}function VT(e){null!=e.m&&(ow.clearTimeout(e.m),e.m=null)}function BT(e,t){var n=null;if(e.a==t){VT(e),qT(e),e.a=null;var r=2}else{if(!oT(e.b,t))return;n=t.s,cT(e.b,t),r=1}if(e.I=t.N,0!=e.v)if(t.b)if(1==r){n=t.j?t.j.length:0,t=mw()-t.u;var i=e.u;Sb(r=Jb(),new nI(r,n,t,i)),DT(e)}else FT(e);else if(3==(i=t.h)||0==i&&0<e.I||!(1==r&&function(e,t){return!(sT(e.b)>=e.b.f-(e.h?1:0)||(e.h?(e.g=t.s.concat(e.g),0):1==e.v||2==e.v||e.u>=(e.La?0:e.Ma)||(e.h=rI(pw(e.Ba,e,t),WT(e,e.u)),e.u++,0)))}(e,t)||2==r&&UT(e)))switch(n&&0<n.length&&(t=e.b,t.c=t.c.concat(n)),i){case 1:$T(e,5);break;case 4:$T(e,10);break;case 3:$T(e,6);break;default:$T(e,2)}}function WT(e,t){var n=e.Ha+Math.floor(Math.random()*e.Ra);return e.f||(n*=2),n*t}function $T(e,t){if(e.c.info("Error code "+t),2==t){var n=null;e.f&&(n=null);var r=pw(e.Ya,e);n||(n=new DI("//www.google.com/images/cleardot.gif"),ow.location&&"http"==ow.location.protocol||LI(n,"https"),jI(n)),function(e,t){var n=new Hb;if(ow.Image){var r=new Image;r.onload=gw(fT,n,r,"TestLoadImage: loaded",!0,t),r.onerror=gw(fT,n,r,"TestLoadImage: error",!1,t),r.onabort=gw(fT,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=gw(fT,n,r,"TestLoadImage: timeout",!1,t),ow.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else tI(2);e.v=0,e.f&&e.f.ra(t),zT(e),PT(e)}function zT(e){e.v=0,e.I=-1,e.f&&(0==uT(e.b).length&&0==e.g.length||(e.b.c.length=0,Iw(e.g),e.g.length=0),e.f.qa())}function KT(e,t,n){var r=function(e){return e instanceof DI?OI(e):new DI(e,void 0)}(n);if(""!=r.c)t&&MI(r,t+"."+r.c),FI(r,r.h);else{var i=ow.location;r=function(e,t,n,r){var i=new DI(null,void 0);return e&&LI(i,e),t&&MI(i,t),n&&FI(i,n),r&&(i.g=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.V&&Aw(e.V,(function(e,t){qI(r,t,e)})),t=e.A,n=e.na,t&&n&&qI(r,t,n),qI(r,"VER",e.ha),LT(e,r),r}function HT(e,t){if(t&&!e.C)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new gT(e.Na)).F=e.C,t}function GT(){}function QT(){if(Uw&&!(10<=Number(Jw)))throw Error("Environmental error: no available transport.")}function YT(e,t){Eb.call(this),this.a=new RT(t),this.o=e,this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.l=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.a&&(e?e["X-WebChannel-Client-Profile"]=t.a:e={"X-WebChannel-Client-Profile":t.a}),this.a.O=e,(e=t&&t.httpHeadersOverwriteParam)&&!Tw(e)&&(this.a.i=e),this.m=t&&t.supportsCrossDomainXhr||!1,this.l=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Tw(t)&&(this.a.A=t,null!==(e=this.b)&&t in e&&(t in(e=this.b)&&delete e[t])),this.f=new ZT(this)}function JT(e){hI.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function XT(){dI.call(this),this.status=1}function ZT(e){this.a=e}(rw=gT.prototype).ba=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+e);t=t?t.toUpperCase():"GET",this.B=e,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?aI(this.H):aI(uI),this.a.onreadystatechange=pw(this.za,this);try{this.A=!0,this.a.open(t,String(e),!0),this.A=!1}catch(e){return void wT(this,e)}e=n||"";var i=new NI(this.headers);r&&RI(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=vT,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.L()),n=ow.FormData&&e instanceof ow.FormData,!(0<=vw(yT,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.a.setRequestHeader(t,e)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{ET(this),0<this.o&&((this.D=function(e){return Uw&&Qw(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=pw(this.xa,this)):this.m=jb(this.xa,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(e){wT(this,e)}},rw.xa=function(){void 0!==sw&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Sb(this,"timeout"),this.abort(8))},rw.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,Sb(this,"complete"),Sb(this,"abort"),TT(this))},rw.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),TT(this,!0)),gT.X.G.call(this)},rw.za=function(){this.j||(this.A||this.l||this.g?IT(this):this.Ua())},rw.Ua=function(){IT(this)},rw.W=function(){try{return 2<ST(this)?this.a.status:-1}catch(e){return-1}},rw.$=function(){try{return this.a?this.a.responseText:""}catch(e){return""}},rw.Pa=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),pT(t)}},rw.ua=function(){return this.h},rw.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(rw=RT.prototype).ha=8,rw.v=1,rw.Ba=function(e){if(this.h)if(this.h=null,1==this.v){if(!e){this.R=Math.floor(1e5*Math.random()),e=this.R++;var t,n=new pI(this,this.c,e,void 0),r=this.l;if(this.O&&(r?Dw(r=Pw(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)e:{for(var i=t=0;i<this.g.length;i++){var s=this.g[i];if(void 0===(s="__data__"in s.a&&"string"==typeof(s=s.a.__data__)?s.length:void 0))break;if(4096<(t+=s)){t=i;break e}if(4096===t||i===this.g.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=MT(this,n,t),qI(i=OI(this.B),"RID",e),qI(i,"CVER",22),this.A&&qI(i,"X-HTTP-Session-Id",this.A),LT(this,i),this.i&&r&&CT(i,this.i,r),aT(this.b,n),this.Ia&&qI(i,"TYPE","init"),this.da?(qI(i,"$req",t),qI(i,"SID","null"),n.U=!0,yI(n,i,null)):yI(n,i,t),this.v=2}}else 3==this.v&&(e?OT(this,e):0==this.g.length||iT(this.b)||OT(this))},rw.Aa=function(){if(this.j=null,jT(this),this.U&&!(this.F||null==this.a||0>=this.N)){var e=2*this.N;this.c.info("BP detection timer enabled: "+e),this.s=rI(pw(this.Ta,this),e)}},rw.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,tI(10),AT(this),jT(this))},rw.Sa=function(){null!=this.m&&(this.m=null,AT(this),UT(this),tI(19))},rw.Ya=function(e){e?(this.c.info("Successfully pinged google.com"),tI(2)):(this.c.info("Failed to ping google.com"),tI(1))},(rw=GT.prototype).ta=function(){},rw.sa=function(){},rw.ra=function(){},rw.qa=function(){},rw.Ja=function(){},QT.prototype.a=function(e,t){return new YT(e,t)},_w(YT,Eb),YT.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var e=this.a,t=this.o,n=this.b||void 0;tI(0),e.fa=t,e.V=n||{},e.H=e.S,e.B=KT(e,null,e.fa),DT(e)},YT.prototype.close=function(){NT(this.a)},YT.prototype.h=function(e){if("string"==typeof e){var t={};t.__data__=e,xT(this.a,t)}else this.l?((t={}).__data__=kb(e),xT(this.a,t)):xT(this.a,e)},YT.prototype.G=function(){this.a.f=null,delete this.f,NT(this.a),delete this.a,YT.X.G.call(this)},_w(JT,hI),_w(XT,dI),_w(ZT,GT),ZT.prototype.ta=function(){Sb(this.a,"a")},ZT.prototype.sa=function(e){Sb(this.a,new JT(e))},ZT.prototype.ra=function(e){Sb(this.a,new XT(e))},ZT.prototype.qa=function(){Sb(this.a,"b")},QT.prototype.createWebChannel=QT.prototype.a,YT.prototype.send=YT.prototype.h,YT.prototype.open=YT.prototype.g,YT.prototype.close=YT.prototype.close,iI.NO_ERROR=0,iI.TIMEOUT=8,iI.HTTP_ERROR=6,sI.COMPLETE="complete",cI.EventType=lI,lI.OPEN="a",lI.CLOSE="b",lI.ERROR="c",lI.MESSAGE="d",Eb.prototype.listen=Eb.prototype.va,gT.prototype.listenOnce=gT.prototype.wa,gT.prototype.getLastError=gT.prototype.Qa,gT.prototype.getLastErrorCode=gT.prototype.ua,gT.prototype.getStatus=gT.prototype.W,gT.prototype.getResponseJson=gT.prototype.Pa,gT.prototype.getResponseText=gT.prototype.$,gT.prototype.send=gT.prototype.ba;var eE=iI,tE=sI,nE=Qb,rE=10,iE=11,sE=cI,oE=gT;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let aE="8.6.1";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cE{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.t(e),this.i=e=>t.writeSequenceNumber(e))}t(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.i&&this.i(e),e}}cE.o=-1;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const uE={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lE extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const hE=new Oa("@firebase/firestore");function dE(){return hE.logLevel}function fE(e,...t){if(hE.logLevel<=ka.DEBUG){const n=t.map(mE);hE.debug(`Firestore (${aE}): ${e}`,...n)}}function pE(e,...t){if(hE.logLevel<=ka.ERROR){const n=t.map(mE);hE.error(`Firestore (${aE}): ${e}`,...n)}}function gE(e,...t){if(hE.logLevel<=ka.WARN){const n=t.map(mE);hE.warn(`Firestore (${aE}): ${e}`,...n)}}function mE(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function _E(e="Unexpected state"){const t=`FIRESTORE (${aE}) INTERNAL ASSERTION FAILED: `+e;throw pE(t),new Error(t)}function yE(e,t){e||_E()}function vE(e,t){return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function wE(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bE{static u(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=wE(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function IE(e,t){return e<t?-1:e>t?1:0}function TE(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function EE(e){return e+"\0"}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class SE{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new lE(uE.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new lE(uE.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new lE(uE.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new lE(uE.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return SE.fromMillis(Date.now())}static fromDate(e){return SE.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new SE(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?IE(this.nanoseconds,e.nanoseconds):IE(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class CE{constructor(e){this.timestamp=e}static fromTimestamp(e){return new CE(e)}static min(){return new CE(new SE(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function kE(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function RE(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function NE(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class AE{constructor(e,t,n){void 0===t?t=0:t>e.length&&_E(),void 0===n?n=e.length-t:n>e.length-t&&_E(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===AE.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof AE?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class PE extends AE{construct(e,t,n){return new PE(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new lE(uE.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new PE(t)}static emptyPath(){return new PE([])}}const xE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class DE extends AE{construct(e,t,n){return new DE(e,t,n)}static isValidIdentifier(e){return xE.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),DE.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new DE(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new lE(uE.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new lE(uE.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new lE(uE.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new lE(uE.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new DE(t)}static emptyPath(){return new DE([])}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class OE{constructor(e){this.fields=e,e.sort(DE.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return TE(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class LE{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new LE(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new LE(t)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return IE(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}LE.EMPTY_BYTE_STRING=new LE("");const ME=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function FE(e){if(yE(!!e),"string"==typeof e){let t=0;const n=ME.exec(e);if(yE(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:UE(e.seconds),nanos:UE(e.nanos)}}function UE(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function qE(e){return"string"==typeof e?LE.fromBase64String(e):LE.fromUint8Array(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function jE(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function VE(e){const t=e.mapValue.fields.__previous_value__;return jE(t)?VE(t):t}function BE(e){const t=FE(e.mapValue.fields.__local_write_time__.timestampValue);return new SE(t.seconds,t.nanos)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function WE(e){return null==e}function $E(e){return 0===e&&1/e==-1/0}function zE(e){return"number"==typeof e&&Number.isInteger(e)&&!$E(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class KE{constructor(e){this.path=e}static fromPath(e){return new KE(PE.fromString(e))}static fromName(e){return new KE(PE.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===PE.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return PE.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new KE(new PE(e.slice()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function HE(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?jE(e)?4:10:_E()}function GE(e,t){const n=HE(e);if(n!==HE(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return BE(e).isEqual(BE(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=FE(e.timestampValue),r=FE(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return qE(e.bytesValue).isEqual(qE(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return UE(e.geoPointValue.latitude)===UE(t.geoPointValue.latitude)&&UE(e.geoPointValue.longitude)===UE(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return UE(e.integerValue)===UE(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=UE(e.doubleValue),r=UE(t.doubleValue);return n===r?$E(n)===$E(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return TE(e.arrayValue.values||[],t.arrayValue.values||[],GE);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(kE(n)!==kE(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!GE(n[e],r[e])))return!1;return!0}(e,t);default:return _E()}}function QE(e,t){return void 0!==(e.values||[]).find((e=>GE(e,t)))}function YE(e,t){const n=HE(e),r=HE(t);if(n!==r)return IE(n,r);switch(n){case 0:return 0;case 1:return IE(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=UE(e.integerValue||e.doubleValue),r=UE(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return JE(e.timestampValue,t.timestampValue);case 4:return JE(BE(e),BE(t));case 5:return IE(e.stringValue,t.stringValue);case 6:return function(e,t){const n=qE(e),r=qE(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=IE(n[e],r[e]);if(0!==t)return t}return IE(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=IE(UE(e.latitude),UE(t.latitude));return 0!==n?n:IE(UE(e.longitude),UE(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=YE(n[e],r[e]);if(t)return t}return IE(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=IE(r[e],s[e]);if(0!==t)return t;const o=YE(n[r[e]],i[s[e]]);if(0!==o)return o}return IE(r.length,s.length)}(e.mapValue,t.mapValue);default:throw _E()}}function JE(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return IE(e,t);const n=FE(e),r=FE(t),i=IE(n.seconds,r.seconds);return 0!==i?i:IE(n.nanos,r.nanos)}function XE(e){return ZE(e)}function ZE(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=FE(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?qE(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,KE.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=ZE(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${ZE(e.fields[i])}`;return n+"}"}(e.mapValue):_E();var t,n}function eS(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function tS(e){return!!e&&"integerValue"in e}function nS(e){return!!e&&"arrayValue"in e}function rS(e){return!!e&&"nullValue"in e}function iS(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function sS(e){return!!e&&"mapValue"in e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class oS{constructor(e){this.overlayMap=new Map,this.partialValue=e}static empty(){return new oS({mapValue:{}})}field(e){return oS.extractNestedValue(this.buildProto(),e)}toProto(){return this.field(DE.emptyPath())}set(e,t){this.setOverlay(e,t)}setAll(e){e.forEach(((e,t)=>{e?this.set(t,e):this.delete(t)}))}delete(e){this.setOverlay(e,null)}isEqual(e){return GE(this.buildProto(),e.buildProto())}setOverlay(e,t){let n=this.overlayMap;for(let t=0;t<e.length-1;++t){const r=e.get(t);let i=n.get(r);i instanceof Map?n=i:i&&10===HE(i)?(i=new Map(Object.entries(i.mapValue.fields||{})),n.set(r,i),n=i):(i=new Map,n.set(r,i),n=i)}n.set(e.lastSegment(),t)}applyOverlay(e,t){let n=!1;const r=oS.extractNestedValue(this.partialValue,e),i=sS(r)?Object.assign({},r.mapValue.fields):{};return t.forEach(((t,r)=>{if(t instanceof Map){const s=this.applyOverlay(e.child(r),t);null!=s&&(i[r]=s,n=!0)}else null!==t?(i[r]=t,n=!0):i.hasOwnProperty(r)&&(delete i[r],n=!0)})),n?{mapValue:{fields:i}}:null}buildProto(){const e=this.applyOverlay(DE.emptyPath(),this.overlayMap);return null!=e&&(this.partialValue=e,this.overlayMap.clear()),this.partialValue}static extractNestedValue(e,t){if(t.isEmpty())return e;{let n=e;for(let e=0;e<t.length-1;++e){if(!n.mapValue.fields)return null;if(n=n.mapValue.fields[t.get(e)],!sS(n))return null}return n=(n.mapValue.fields||{})[t.lastSegment()],n||null}}clone(){return new oS(this.buildProto())}}function aS(e){const t=[];return RE(e.fields||{},((e,n)=>{const r=new DE([e]);if(sS(n)){const e=aS(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new OE(t)
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class cS{constructor(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}static newInvalidDocument(e){return new cS(e,0,CE.min(),oS.empty(),0)}static newFoundDocument(e,t,n){return new cS(e,1,t,n,0)}static newNoDocument(e,t){return new cS(e,2,t,oS.empty(),0)}static newUnknownDocument(e,t){return new cS(e,3,t,oS.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=oS.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=oS.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof cS&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new cS(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.toProto())}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uS{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.h=null}}function lS(e,t=null,n=[],r=[],i=null,s=null,o=null){return new uS(e,t,n,r,i,s,o)}function hS(e){const t=vE(e);if(null===t.h){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>function(e){return e.field.canonicalString()+e.op.toString()+XE(e.value)}(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),WE(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=ES(t.startAt)),t.endAt&&(e+="|ub:",e+=ES(t.endAt)),t.h=e}return t.h}function dS(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!CS(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!GE(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!RS(e.startAt,t.startAt)&&RS(e.endAt,t.endAt)}function fS(e){return KE.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class pS extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.l(e,t,n):new gS(e,t,n):"array-contains"===t?new vS(e,n):"in"===t?new wS(e,n):"not-in"===t?new bS(e,n):"array-contains-any"===t?new IS(e,n):new pS(e,t,n)}static l(e,t,n){return"in"===t?new mS(e,n):new _S(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.m(YE(t,this.value)):null!==t&&HE(this.value)===HE(t)&&this.m(YE(t,this.value))}m(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return _E()}}g(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class gS extends pS{constructor(e,t,n){super(e,t,n),this.key=KE.fromName(n.referenceValue)}matches(e){const t=KE.comparator(e.key,this.key);return this.m(t)}}class mS extends pS{constructor(e,t){super(e,"in",t),this.keys=yS("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class _S extends pS{constructor(e,t){super(e,"not-in",t),this.keys=yS("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function yS(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>KE.fromName(e.referenceValue)))}class vS extends pS{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return nS(t)&&QE(t.arrayValue,this.value)}}class wS extends pS{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&QE(this.value.arrayValue,t)}}class bS extends pS{constructor(e,t){super(e,"not-in",t)}matches(e){if(QE(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!QE(this.value.arrayValue,t)}}class IS extends pS{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!nS(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>QE(this.value.arrayValue,e)))}}class TS{constructor(e,t){this.position=e,this.before=t}}function ES(e){return`${e.before?"b":"a"}:${e.position.map((e=>XE(e))).join(",")}`}class SS{constructor(e,t="asc"){this.field=e,this.dir=t}}function CS(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function kS(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?KE.comparator(KE.fromName(o.referenceValue),n.key):YE(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function RS(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!GE(e.position[n],t.position[n]))return!1;return!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class NS{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt}}function AS(e,t,n,r,i,s,o,a){return new NS(e,t,n,r,i,s,o,a)}function PS(e){return new NS(e)}function xS(e){return!WE(e.limit)&&"F"===e.limitType}function DS(e){return!WE(e.limit)&&"L"===e.limitType}function OS(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function LS(e){for(const t of e.filters)if(t.g())return t.field;return null}function MS(e){return null!==e.collectionGroup}function FS(e){const t=vE(e);if(null===t.p){t.p=[];const e=LS(t),n=OS(t);if(null!==e&&null===n)e.isKeyField()||t.p.push(new SS(e)),t.p.push(new SS(DE.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.p.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new SS(DE.keyField(),e))}}}return t.p}function US(e){const t=vE(e);if(!t.T)if("F"===t.limitType)t.T=lS(t.path,t.collectionGroup,FS(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of FS(t)){const t="desc"===n.dir?"asc":"desc";e.push(new SS(n.field,t))}const n=t.endAt?new TS(t.endAt.position,!t.endAt.before):null,r=t.startAt?new TS(t.startAt.position,!t.startAt.before):null;t.T=lS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.T}function qS(e,t,n){return new NS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function jS(e,t){return dS(US(e),US(t))&&e.limitType===t.limitType}function VS(e){return`${hS(US(e))}|lt:${e.limitType}`}function BS(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${XE(t.value)}`;var t})).join(", ")}]`),WE(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: "+ES(e.startAt)),e.endAt&&(t+=", endAt: "+ES(e.endAt)),`Target(${t})`}(US(e))}; limitType=${e.limitType})`}function WS(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):KE.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!kS(e.startAt,FS(e),t))&&(!e.endAt||!kS(e.endAt,FS(e),t))}(e,t)}function $S(e){return(t,n)=>{let r=!1;for(const i of FS(e)){const e=zS(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function zS(e,t,n){const r=e.field.isKeyField()?KE.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?YE(r,i):_E()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return _E()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function KS(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$E(t)?"-0":t}}function HS(e){return{integerValue:""+e}}function GS(e,t){return zE(t)?HS(t):KS(e,t)}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QS{constructor(){this._=void 0}}function YS(e,t,n){return e instanceof ZS?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof eC?tC(e,t):e instanceof nC?rC(e,t):function(e,t){const n=XS(e,t),r=sC(n)+sC(e.A);return tS(n)&&tS(e.A)?HS(r):KS(e.R,r)}(e,t)}function JS(e,t,n){return e instanceof eC?tC(e,t):e instanceof nC?rC(e,t):n}function XS(e,t){return e instanceof iC?tS(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class ZS extends QS{}class eC extends QS{constructor(e){super(),this.elements=e}}function tC(e,t){const n=oC(t);for(const t of e.elements)n.some((e=>GE(e,t)))||n.push(t);return{arrayValue:{values:n}}}class nC extends QS{constructor(e){super(),this.elements=e}}function rC(e,t){let n=oC(t);for(const t of e.elements)n=n.filter((e=>!GE(e,t)));return{arrayValue:{values:n}}}class iC extends QS{constructor(e,t){super(),this.R=e,this.A=t}}function sC(e){return UE(e.integerValue||e.doubleValue)}function oC(e){return nS(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class aC{constructor(e,t){this.field=e,this.transform=t}}class cC{constructor(e,t){this.version=e,this.transformResults=t}}class uC{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new uC}static exists(e){return new uC(void 0,e)}static updateTime(e){return new uC(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lC(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class hC{}function dC(e,t,n){e instanceof _C?function(e,t,n){const r=e.value.clone(),i=wC(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof yC?function(e,t,n){if(!lC(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=wC(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(vC(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function fC(e,t,n){e instanceof _C?function(e,t,n){if(!lC(e.precondition,t))return;const r=e.value.clone(),i=bC(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(mC(t),r).setHasLocalMutations()}(e,t,n):e instanceof yC?function(e,t,n){if(!lC(e.precondition,t))return;const r=bC(e.fieldTransforms,n,t),i=t.data;i.setAll(vC(e)),i.setAll(r),t.convertToFoundDocument(mC(t),i).setHasLocalMutations()}(e,t,n):function(e,t){lC(e.precondition,t)&&t.convertToNoDocument(CE.min())}(e,t)}function pC(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=XS(r.transform,e||null);null!=i&&(null==n&&(n=oS.empty()),n.set(r.field,i))}return n||null}function gC(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&TE(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof eC&&t instanceof eC||e instanceof nC&&t instanceof nC?TE(e.elements,t.elements,GE):e instanceof iC&&t instanceof iC?GE(e.A,t.A):e instanceof ZS&&t instanceof ZS}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function mC(e){return e.isFoundDocument()?e.version:CE.min()}class _C extends hC{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class yC extends hC{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function vC(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function wC(e,t,n){const r=new Map;yE(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,JS(o,a,n[i]))}return r}function bC(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,YS(e,s,t))}return r}class IC extends hC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class TC extends hC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class EC{constructor(e){this.count=e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var SC,CC;function kC(e){switch(e){case uE.OK:return _E();case uE.CANCELLED:case uE.UNKNOWN:case uE.DEADLINE_EXCEEDED:case uE.RESOURCE_EXHAUSTED:case uE.INTERNAL:case uE.UNAVAILABLE:case uE.UNAUTHENTICATED:return!1;case uE.INVALID_ARGUMENT:case uE.NOT_FOUND:case uE.ALREADY_EXISTS:case uE.PERMISSION_DENIED:case uE.FAILED_PRECONDITION:case uE.ABORTED:case uE.OUT_OF_RANGE:case uE.UNIMPLEMENTED:case uE.DATA_LOSS:return!0;default:return _E()}}function RC(e){if(void 0===e)return pE("GRPC error has no .code"),uE.UNKNOWN;switch(e){case SC.OK:return uE.OK;case SC.CANCELLED:return uE.CANCELLED;case SC.UNKNOWN:return uE.UNKNOWN;case SC.DEADLINE_EXCEEDED:return uE.DEADLINE_EXCEEDED;case SC.RESOURCE_EXHAUSTED:return uE.RESOURCE_EXHAUSTED;case SC.INTERNAL:return uE.INTERNAL;case SC.UNAVAILABLE:return uE.UNAVAILABLE;case SC.UNAUTHENTICATED:return uE.UNAUTHENTICATED;case SC.INVALID_ARGUMENT:return uE.INVALID_ARGUMENT;case SC.NOT_FOUND:return uE.NOT_FOUND;case SC.ALREADY_EXISTS:return uE.ALREADY_EXISTS;case SC.PERMISSION_DENIED:return uE.PERMISSION_DENIED;case SC.FAILED_PRECONDITION:return uE.FAILED_PRECONDITION;case SC.ABORTED:return uE.ABORTED;case SC.OUT_OF_RANGE:return uE.OUT_OF_RANGE;case SC.UNIMPLEMENTED:return uE.UNIMPLEMENTED;case SC.DATA_LOSS:return uE.DATA_LOSS;default:return _E()}}(CC=SC||(SC={}))[CC.OK=0]="OK",CC[CC.CANCELLED=1]="CANCELLED",CC[CC.UNKNOWN=2]="UNKNOWN",CC[CC.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",CC[CC.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",CC[CC.NOT_FOUND=5]="NOT_FOUND",CC[CC.ALREADY_EXISTS=6]="ALREADY_EXISTS",CC[CC.PERMISSION_DENIED=7]="PERMISSION_DENIED",CC[CC.UNAUTHENTICATED=16]="UNAUTHENTICATED",CC[CC.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",CC[CC.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",CC[CC.ABORTED=10]="ABORTED",CC[CC.OUT_OF_RANGE=11]="OUT_OF_RANGE",CC[CC.UNIMPLEMENTED=12]="UNIMPLEMENTED",CC[CC.INTERNAL=13]="INTERNAL",CC[CC.UNAVAILABLE=14]="UNAVAILABLE",CC[CC.DATA_LOSS=15]="DATA_LOSS";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class NC{constructor(e,t){this.comparator=e,this.root=t||PC.EMPTY}insert(e,t){return new NC(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,PC.BLACK,null,null))}remove(e){return new NC(this.comparator,this.root.remove(e,this.comparator).copy(null,null,PC.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new AC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new AC(this.root,e,this.comparator,!1)}getReverseIterator(){return new AC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new AC(this.root,e,this.comparator,!0)}}class AC{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class PC{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:PC.RED,this.left=null!=r?r:PC.EMPTY,this.right=null!=i?i:PC.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new PC(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return PC.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return PC.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,PC.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,PC.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _E();if(this.right.isRed())throw _E();const e=this.left.check();if(e!==this.right.check())throw _E();return e+(this.isRed()?0:1)}}PC.EMPTY=null,PC.RED=!0,PC.BLACK=!1,PC.EMPTY=new class{constructor(){this.size=0}get key(){throw _E()}get value(){throw _E()}get color(){throw _E()}get left(){throw _E()}get right(){throw _E()}copy(e,t,n,r,i){return this}insert(e,t,n){return new PC(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class xC{constructor(e){this.comparator=e,this.data=new NC(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new DC(this.data.getIterator())}getIteratorFrom(e){return new DC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof xC))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new xC(this.comparator);return t.data=e,t}}class DC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const OC=new NC(KE.comparator);function LC(){return OC}const MC=new NC(KE.comparator);function FC(){return MC}const UC=new NC(KE.comparator);function qC(){return UC}const jC=new xC(KE.comparator);function VC(...e){let t=jC;for(const n of e)t=t.add(n);return t}const BC=new xC(IE);function WC(){return BC}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $C{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,zC.createSynthesizedTargetChangeForCurrentChange(e,t)),new $C(CE.min(),n,WC(),LC(),VC())}}class zC{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new zC(LE.EMPTY_BYTE_STRING,t,VC(),VC(),VC())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class KC{constructor(e,t,n,r){this.P=e,this.removedTargetIds=t,this.key=n,this.v=r}}class HC{constructor(e,t){this.targetId=e,this.V=t}}class GC{constructor(e,t,n=LE.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class QC{constructor(){this.S=0,this.D=XC(),this.C=LE.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}get current(){return this.N}get resumeToken(){return this.C}get $(){return 0!==this.S}get O(){return this.k}M(e){e.approximateByteSize()>0&&(this.k=!0,this.C=e)}F(){let e=VC(),t=VC(),n=VC();return this.D.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:_E()}})),new zC(this.C,this.N,e,t,n)}L(){this.k=!1,this.D=XC()}B(e,t){this.k=!0,this.D=this.D.insert(e,t)}U(e){this.k=!0,this.D=this.D.remove(e)}q(){this.S+=1}K(){this.S-=1}j(){this.k=!0,this.N=!0}}class YC{constructor(e){this.W=e,this.G=new Map,this.H=LC(),this.J=JC(),this.Y=new xC(IE)}X(e){for(const t of e.P)e.v&&e.v.isFoundDocument()?this.Z(t,e.v):this.tt(t,e.key,e.v);for(const t of e.removedTargetIds)this.tt(t,e.key,e.v)}et(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.st(t)&&n.M(e.resumeToken);break;case 1:n.K(),n.$||n.L(),n.M(e.resumeToken);break;case 2:n.K(),n.$||this.removeTarget(t);break;case 3:this.st(t)&&(n.j(),n.M(e.resumeToken));break;case 4:this.st(t)&&(this.it(t),n.M(e.resumeToken));break;default:_E()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.G.forEach(((e,n)=>{this.st(n)&&t(n)}))}rt(e){const t=e.targetId,n=e.V.count,r=this.ot(t);if(r){const e=r.target;if(fS(e))if(0===n){const n=new KE(e.path);this.tt(t,n,cS.newNoDocument(n,CE.min()))}else yE(1===n);else this.ct(t)!==n&&(this.it(t),this.Y=this.Y.add(t))}}at(e){const t=new Map;this.G.forEach(((n,r)=>{const i=this.ot(r);if(i){if(n.current&&fS(i.target)){const t=new KE(i.target.path);null!==this.H.get(t)||this.ut(r,t)||this.tt(r,t,cS.newNoDocument(t,e))}n.O&&(t.set(r,n.F()),n.L())}}));let n=VC();this.J.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.ot(e);return!t||2===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))}));const r=new $C(e,t,this.Y,this.H,n);return this.H=LC(),this.J=JC(),this.Y=new xC(IE),r}Z(e,t){if(!this.st(e))return;const n=this.ut(e,t.key)?2:0;this.nt(e).B(t.key,n),this.H=this.H.insert(t.key,t),this.J=this.J.insert(t.key,this.ht(t.key).add(e))}tt(e,t,n){if(!this.st(e))return;const r=this.nt(e);this.ut(e,t)?r.B(t,1):r.U(t),this.J=this.J.insert(t,this.ht(t).delete(e)),n&&(this.H=this.H.insert(t,n))}removeTarget(e){this.G.delete(e)}ct(e){const t=this.nt(e).F();return this.W.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}q(e){this.nt(e).q()}nt(e){let t=this.G.get(e);return t||(t=new QC,this.G.set(e,t)),t}ht(e){let t=this.J.get(e);return t||(t=new xC(IE),this.J=this.J.insert(e,t)),t}st(e){const t=null!==this.ot(e);return t||fE("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.G.get(e);return t&&t.$?null:this.W.lt(e)}it(e){this.G.set(e,new QC),this.W.getRemoteKeysForTarget(e).forEach((t=>{this.tt(e,t,null)}))}ut(e,t){return this.W.getRemoteKeysForTarget(e).has(t)}}function JC(){return new NC(KE.comparator)}function XC(){return new NC(KE.comparator)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ZC={asc:"ASCENDING",desc:"DESCENDING"},ek={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class tk{constructor(e,t){this.databaseId=e,this.I=t}}function nk(e,t){return e.I?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function rk(e,t){return e.I?t.toBase64():t.toUint8Array()}function ik(e,t){return nk(e,t.toTimestamp())}function sk(e){return yE(!!e),CE.fromTimestamp(function(e){const t=FE(e);return new SE(t.seconds,t.nanos)}(e))}function ok(e,t){return function(e){return new PE(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function ak(e){const t=PE.fromString(e);return yE(Pk(t)),t}function ck(e,t){return ok(e.databaseId,t.path)}function uk(e,t){const n=ak(t);if(n.get(1)!==e.databaseId.projectId)throw new lE(uE.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new lE(uE.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new KE(fk(n))}function lk(e,t){return ok(e.databaseId,t)}function hk(e){const t=ak(e);return 4===t.length?PE.emptyPath():fk(t)}function dk(e){return new PE(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function fk(e){return yE(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function pk(e,t,n){return{name:ck(e,t),fields:n.toProto().mapValue.fields}}function gk(e,t,n){const r=uk(e,t.name),i=sk(t.updateTime),s=new oS({mapValue:{fields:t.fields}}),o=cS.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function mk(e,t){let n;if(t instanceof _C)n={update:pk(e,t.key,t.value)};else if(t instanceof IC)n={delete:ck(e,t.key)};else if(t instanceof yC)n={update:pk(e,t.key,t.data),updateMask:Ak(t.fieldMask)};else{if(!(t instanceof TC))return _E();n={verify:ck(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof ZS)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof eC)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof nC)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof iC)return{fieldPath:t.field.canonicalString(),increment:n.A};throw _E()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:ik(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:_E()}(e,t.precondition)),n}function _k(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?uC.updateTime(sk(e.updateTime)):void 0!==e.exists?uC.exists(e.exists):uC.none()}(t.currentDocument):uC.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)yE("REQUEST_TIME"===t.setToServerValue),n=new ZS;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new eC(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new nC(e)}else"increment"in t?n=new iC(e,t.increment):_E();const r=DE.fromServerFormat(t.fieldPath);return new aC(r,n)}(e,t))):[];if(t.update){t.update.name;const i=uk(e,t.update.name),s=new oS({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new OE(t.map((e=>DE.fromServerFormat(e))))}(t.updateMask);return new yC(i,s,e,n,r)}return new _C(i,s,n,r)}if(t.delete){const r=uk(e,t.delete);return new IC(r,n)}if(t.verify){const r=uk(e,t.verify);return new TC(r,n)}return _E()}function yk(e,t){return{documents:[lk(e,t.path)]}}function vk(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=lk(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=lk(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(iS(e.value))return{unaryFilter:{field:Ck(e.field),op:"IS_NAN"}};if(rS(e.value))return{unaryFilter:{field:Ck(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(iS(e.value))return{unaryFilter:{field:Ck(e.field),op:"IS_NOT_NAN"}};if(rS(e.value))return{unaryFilter:{field:Ck(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ck(e.field),op:Sk(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ck(e.field),direction:Ek(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.I||WE(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=Ik(t.startAt)),t.endAt&&(n.structuredQuery.endAt=Ik(t.endAt)),n}function wk(e){let t=hk(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){yE(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=bk(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new SS(kk(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,WE(t)?null:t}(n.limit));let c=null;n.startAt&&(c=Tk(n.startAt));let u=null;return n.endAt&&(u=Tk(n.endAt)),AS(t,i,o,s,a,"F",c,u)}function bk(e){return e?void 0!==e.unaryFilter?[Nk(e)]:void 0!==e.fieldFilter?[Rk(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>bk(e))).reduce(((e,t)=>e.concat(t))):_E():[]}function Ik(e){return{before:e.before,values:e.position}}function Tk(e){const t=!!e.before,n=e.values||[];return new TS(n,t)}function Ek(e){return ZC[e]}function Sk(e){return ek[e]}function Ck(e){return{fieldPath:e.canonicalString()}}function kk(e){return DE.fromServerFormat(e.fieldPath)}function Rk(e){return pS.create(kk(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _E()}}(e.fieldFilter.op),e.fieldFilter.value)}function Nk(e){switch(e.unaryFilter.op){case"IS_NAN":const t=kk(e.unaryFilter.field);return pS.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=kk(e.unaryFilter.field);return pS.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=kk(e.unaryFilter.field);return pS.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=kk(e.unaryFilter.field);return pS.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _E()}}function Ak(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Pk(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function xk(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ok(t)),t=Dk(e.get(n),t);return Ok(t)}function Dk(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function Ok(e){return e+""}function Lk(e){const t=e.length;if(yE(t>=2),2===t)return yE(""===e.charAt(0)&&""===e.charAt(1)),PE.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&_E(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:_E()}s=t+2}return new PE(r)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Mk{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class Fk{constructor(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}}Fk.store="owner",Fk.key="owner";class Uk{constructor(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}}Uk.store="mutationQueues",Uk.keyPath="userId";class qk{constructor(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}qk.store="mutations",qk.keyPath="batchId",qk.userMutationsIndex="userMutationsIndex",qk.userMutationsKeyPath=["userId","batchId"];class jk{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,xk(t)]}static key(e,t,n){return[e,xk(t),n]}}jk.store="documentMutations",jk.PLACEHOLDER=new jk;class Vk{constructor(e,t){this.path=e,this.readTime=t}}class Bk{constructor(e,t){this.path=e,this.version=t}}class Wk{constructor(e,t,n,r,i,s){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}Wk.store="remoteDocuments",Wk.readTimeIndex="readTimeIndex",Wk.readTimeIndexPath="readTime",Wk.collectionReadTimeIndex="collectionReadTimeIndex",Wk.collectionReadTimeIndexPath=["parentPath","readTime"];class $k{constructor(e){this.byteSize=e}}$k.store="remoteDocumentGlobal",$k.key="remoteDocumentGlobalKey";class zk{constructor(e,t,n,r,i,s,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}zk.store="targets",zk.keyPath="targetId",zk.queryTargetsIndexName="queryTargetsIndex",zk.queryTargetsKeyPath=["canonicalId","targetId"];class Kk{constructor(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n}}Kk.store="targetDocuments",Kk.keyPath=["targetId","path"],Kk.documentTargetsIndex="documentTargetsIndex",Kk.documentTargetsKeyPath=["path","targetId"];class Hk{constructor(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}Hk.key="targetGlobalKey",Hk.store="targetGlobal";class Gk{constructor(e,t){this.collectionId=e,this.parent=t}}Gk.store="collectionParents",Gk.keyPath=["collectionId","parent"];class Qk{constructor(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}}Qk.store="clientMetadata",Qk.keyPath="clientId";class Yk{constructor(e,t,n){this.bundleId=e,this.createTime=t,this.version=n}}Yk.store="bundles",Yk.keyPath="bundleId";class Jk{constructor(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n}}Jk.store="namedQueries",Jk.keyPath="name";const Xk=[Uk.store,qk.store,jk.store,Wk.store,zk.store,Fk.store,Hk.store,Kk.store,Qk.store,$k.store,Gk.store,Yk.store,Jk.store],Zk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class tR{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nR{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_E(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new nR(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof nR?t:nR.resolve(t)}catch(e){return nR.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):nR.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):nR.reject(t)}static resolve(e){return new nR(((t,n)=>{t(e)}))}static reject(e){return new nR(((t,n)=>{n(e)}))}static waitFor(e){return new nR(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=nR.resolve(!1);for(const n of e)t=t.next((e=>e?nR.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rR{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.ft=new tR,this.transaction.oncomplete=()=>{this.ft.resolve()},this.transaction.onabort=()=>{t.error?this.ft.reject(new oR(e,t.error)):this.ft.resolve()},this.transaction.onerror=t=>{const n=hR(t.target.error);this.ft.reject(new oR(e,n))}}static open(e,t,n,r){try{return new rR(t,e.transaction(r,n))}catch(e){throw new oR(t,e)}}get dt(){return this.ft.promise}abort(e){e&&this.ft.reject(e),this.aborted||(fE("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new cR(t)}}class iR{constructor(e,t,n){this.name=e,this.version=t,this.wt=n,12.2===iR._t(qo())&&pE("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return fE("SimpleDb","Removing database:",e),uR(window.indexedDB.deleteDatabase(e)).toPromise()}static gt(){if("undefined"==typeof indexedDB)return!1;if(iR.yt())return!0;const e=qo(),t=iR._t(e),n=0<t&&t<10,r=iR.Et(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static yt(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Tt)}static It(e,t){return e.store(t)}static _t(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static Et(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async At(e){return this.db||(fE("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new oR(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new lE(uE.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new oR(e,r))},r.onupgradeneeded=e=>{fE("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.wt.Rt(t,r.transaction,e.oldVersion,this.version).next((()=>{fE("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.Pt&&(this.db.onversionchange=e=>this.Pt(e)),this.db}bt(e){this.Pt=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.At(e);const t=rR.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).catch((e=>(t.abort(e),nR.reject(e)))).toPromise();return s.catch((()=>{})),await t.dt,s}catch(e){const t="FirebaseError"!==e.name&&s<3;if(fE("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class sR{constructor(e){this.vt=e,this.Vt=!1,this.St=null}get isDone(){return this.Vt}get Dt(){return this.St}set cursor(e){this.vt=e}done(){this.Vt=!0}Ct(e){this.St=e}delete(){return uR(this.vt.delete())}}class oR extends lE{constructor(e,t){super(uE.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function aR(e){return"IndexedDbTransactionError"===e.name}class cR{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(fE("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(fE("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),uR(n)}add(e){return fE("SimpleDb","ADD",this.store.name,e,e),uR(this.store.add(e))}get(e){return uR(this.store.get(e)).next((t=>(void 0===t&&(t=null),fE("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return fE("SimpleDb","DELETE",this.store.name,e),uR(this.store.delete(e))}count(){return fE("SimpleDb","COUNT",this.store.name),uR(this.store.count())}Nt(e,t){const n=this.cursor(this.options(e,t)),r=[];return this.xt(n,((e,t)=>{r.push(t)})).next((()=>r))}kt(e,t){fE("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.$t=!1;const r=this.cursor(n);return this.xt(r,((e,t,n)=>n.delete()))}Ot(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.xt(r,t)}Mt(e){const t=this.cursor({});return new nR(((n,r)=>{t.onerror=e=>{const t=hR(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}xt(e,t){const n=[];return new nR(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new sR(i),o=t(i.primaryKey,i.value,s);if(o instanceof nR){const e=o.catch((e=>(s.done(),nR.reject(e))));n.push(e)}s.isDone?r():null===s.Dt?i.continue():i.continue(s.Dt)}})).next((()=>nR.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.$t?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function uR(e){return new nR(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=hR(e.target.error);n(t)}}))}let lR=!1;function hR(e){const t=iR._t(qo());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new lE("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return lR||(lR=!0,setTimeout((()=>{throw e}),0)),e}}return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class dR extends eR{constructor(e,t){super(),this.Ft=e,this.currentSequenceNumber=t}}function fR(e,t){const n=vE(e);return iR.It(n.Ft,t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class pR{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&dC(r,e,n[t])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&fC(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&fC(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach((t=>{const n=e.get(t.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument(CE.min())}))}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),VC())}isEqual(e){return this.batchId===e.batchId&&TE(this.mutations,e.mutations,((e,t)=>gC(e,t)))&&TE(this.baseMutations,e.baseMutations,((e,t)=>gC(e,t)))}}class gR{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){yE(e.mutations.length===n.length);let r=qC();const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new gR(e,t,n,r)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class mR{constructor(e,t,n,r,i=CE.min(),s=CE.min(),o=LE.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new mR(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new mR(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new mR(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _R{constructor(e){this.Lt=e}}function yR(e,t){if(t.document)return gk(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){const e=KE.fromSegments(t.noDocument.path),n=TR(t.noDocument.readTime),r=cS.newNoDocument(e,n);return t.hasCommittedMutations?r.setHasCommittedMutations():r}if(t.unknownDocument){const e=KE.fromSegments(t.unknownDocument.path),n=TR(t.unknownDocument.version);return cS.newUnknownDocument(e,n)}return _E()}function vR(e,t,n){const r=wR(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){const n=function(e,t){return{name:ck(e,t.key),fields:t.data.toProto().mapValue.fields,updateTime:nk(e,t.version.toTimestamp())}}(e.Lt,t),s=t.hasCommittedMutations;return new Wk(null,null,n,s,r,i)}if(t.isNoDocument()){const e=t.key.path.toArray(),n=IR(t.version),s=t.hasCommittedMutations;return new Wk(null,new Vk(e,n),null,s,r,i)}if(t.isUnknownDocument()){const e=t.key.path.toArray(),n=IR(t.version);return new Wk(new Bk(e,n),null,null,!0,r,i)}return _E()}function wR(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function bR(e){const t=new SE(e[0],e[1]);return CE.fromTimestamp(t)}function IR(e){const t=e.toTimestamp();return new Mk(t.seconds,t.nanoseconds)}function TR(e){const t=new SE(e.seconds,e.nanoseconds);return CE.fromTimestamp(t)}function ER(e,t){const n=(t.baseMutations||[]).map((t=>_k(e.Lt,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>_k(e.Lt,t))),i=SE.fromMillis(t.localWriteTimeMs);return new pR(t.batchId,i,n,r)}function SR(e){const t=TR(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?TR(e.lastLimboFreeSnapshotVersion):CE.min();let r;var i;return void 0!==e.query.documents?(yE(1===(i=e.query).documents.length),r=US(PS(hk(i.documents[0])))):r=function(e){return US(wk(e))}(e.query),new mR(r,e.targetId,0,e.lastListenSequenceNumber,t,n,LE.fromBase64String(e.resumeToken))}function CR(e,t){const n=IR(t.snapshotVersion),r=IR(t.lastLimboFreeSnapshotVersion);let i;i=fS(t.target)?yk(e.Lt,t.target):vk(e.Lt,t.target);const s=t.resumeToken.toBase64();return new zk(t.targetId,hS(t.target),n,s,t.sequenceNumber,r,i)}function kR(e){const t=wk({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?qS(t,t.limit,"L"):t}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class RR{getBundleMetadata(e,t){return NR(e).get(t).next((e=>{if(e)return{id:(t=e).bundleId,createTime:TR(t.createTime),version:t.version};var t}))}saveBundleMetadata(e,t){return NR(e).put({bundleId:(n=t).id,createTime:IR(sk(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return AR(e).get(t).next((e=>{if(e)return{name:(t=e).name,query:kR(t.bundledQuery),readTime:TR(t.readTime)};var t}))}saveNamedQuery(e,t){return AR(e).put(function(e){return{name:e.name,readTime:IR(sk(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function NR(e){return fR(e,Yk.store)}function AR(e){return fR(e,Jk.store)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class PR{constructor(){this.Bt=new xR}addToCollectionParentIndex(e,t){return this.Bt.add(t),nR.resolve()}getCollectionParents(e,t){return nR.resolve(this.Bt.getEntries(t))}}class xR{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new xC(PE.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new xC(PE.comparator)).toArray()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class DR{constructor(){this.Ut=new xR}addToCollectionParentIndex(e,t){if(!this.Ut.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.Ut.add(t)}));const i={collectionId:n,parent:xk(r)};return OR(e).put(i)}return nR.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[EE(t),""],!1,!0);return OR(e).Nt(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Lk(r.parent))}return n}))}}function OR(e){return fR(e,Gk.store)}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const LR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class MR{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new MR(e,MR.DEFAULT_COLLECTION_PERCENTILE,MR.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function FR(e,t,n){const r=e.store(qk.store),i=e.store(jk.store),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Ot({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{yE(1===a)})));const u=[];for(const e of n.mutations){const r=jk.key(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return nR.waitFor(s).next((()=>u))}function UR(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw _E();t=e.noDocument}return JSON.stringify(t).length}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */MR.DEFAULT_COLLECTION_PERCENTILE=10,MR.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,MR.DEFAULT=new MR(41943040,MR.DEFAULT_COLLECTION_PERCENTILE,MR.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),MR.DISABLED=new MR(-1,0,0);class qR{constructor(e,t,n,r){this.userId=e,this.R=t,this.qt=n,this.referenceDelegate=r,this.Kt={}}static Qt(e,t,n,r){yE(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new qR(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return VR(e).Ot({index:qk.userMutationsIndex,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=BR(e),s=VR(e);return s.add({}).next((o=>{yE("number"==typeof o);const a=new pR(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>mk(e.Lt,t))),i=n.mutations.map((t=>mk(e.Lt,t)));return new qk(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(this.R,this.userId,a),u=[];let l=new xC(((e,t)=>IE(e.canonicalString(),t.canonicalString())));for(const e of r){const t=jk.key(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,jk.PLACEHOLDER))}return l.forEach((t=>{u.push(this.qt.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Kt[o]=a.keys()})),nR.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return VR(e).get(t).next((e=>e?(yE(e.userId===this.userId),ER(this.R,e)):null))}jt(e,t){return this.Kt[t]?nR.resolve(this.Kt[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Kt[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return VR(e).Ot({index:qk.userMutationsIndex,range:r},((e,t,r)=>{t.userId===this.userId&&(yE(t.batchId>=n),i=ER(this.R,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return VR(e).Ot({index:qk.userMutationsIndex,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return VR(e).Nt(qk.userMutationsIndex,t).next((e=>e.map((e=>ER(this.R,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=jk.prefixForPath(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return BR(e).Ot({range:r},((n,r,s)=>{const[o,a,c]=n,u=Lk(a);if(o===this.userId&&t.path.isEqual(u))return VR(e).get(c).next((e=>{if(!e)throw _E();yE(e.userId===this.userId),i.push(ER(this.R,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new xC(IE);const r=[];return t.forEach((t=>{const i=jk.prefixForPath(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=BR(e).Ot({range:s},((e,r,i)=>{const[s,o,a]=e,c=Lk(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),nR.waitFor(r).next((()=>this.Wt(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=jk.prefixForPath(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new xC(IE);return BR(e).Ot({range:s},((e,t,i)=>{const[s,a,c]=e,u=Lk(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.Wt(e,o)))}Wt(e,t){const n=[],r=[];return t.forEach((t=>{r.push(VR(e).get(t).next((e=>{if(null===e)throw _E();yE(e.userId===this.userId),n.push(ER(this.R,e))})))})),nR.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return FR(e.Ft,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Gt(t.batchId)})),nR.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Gt(e){delete this.Kt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return nR.resolve();const n=IDBKeyRange.lowerBound(jk.prefixForUser(this.userId)),r=[];return BR(e).Ot({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Lk(e[1]);r.push(t)}else n.done()})).next((()=>{yE(0===r.length)}))}))}containsKey(e,t){return jR(e,this.userId,t)}zt(e){return WR(e).get(this.userId).next((e=>e||new Uk(this.userId,-1,"")))}}function jR(e,t,n){const r=jk.prefixForPath(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return BR(e).Ot({range:s,$t:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function VR(e){return fR(e,qk.store)}function BR(e){return fR(e,jk.store)}function WR(e){return fR(e,Uk.store)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $R{constructor(e){this.Ht=e}next(){return this.Ht+=2,this.Ht}static Jt(){return new $R(0)}static Yt(){return new $R(-1)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zR{constructor(e,t){this.referenceDelegate=e,this.R=t}allocateTargetId(e){return this.Xt(e).next((t=>{const n=new $R(t.highestTargetId);return t.highestTargetId=n.next(),this.Zt(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Xt(e).next((e=>CE.fromTimestamp(new SE(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Xt(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Xt(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Zt(e,r))))}addTargetData(e,t){return this.te(e,t).next((()=>this.Xt(e).next((n=>(n.targetCount+=1,this.ee(t,n),this.Zt(e,n))))))}updateTargetData(e,t){return this.te(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>KR(e).delete(t.targetId))).next((()=>this.Xt(e))).next((t=>(yE(t.targetCount>0),t.targetCount-=1,this.Zt(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return KR(e).Ot(((s,o)=>{const a=SR(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>nR.waitFor(i))).next((()=>r))}forEachTarget(e,t){return KR(e).Ot(((e,n)=>{const r=SR(n);t(r)}))}Xt(e){return HR(e).get(Hk.key).next((e=>(yE(null!==e),e)))}Zt(e,t){return HR(e).put(Hk.key,t)}te(e,t){return KR(e).put(CR(this.R,t))}ee(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Xt(e).next((e=>e.targetCount))}getTargetData(e,t){const n=hS(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return KR(e).Ot({range:r,index:zk.queryTargetsIndexName},((e,n,r)=>{const s=SR(n);dS(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=GR(e);return t.forEach((t=>{const s=xk(t.path);r.push(i.put(new Kk(n,s))),r.push(this.referenceDelegate.addReference(e,n,t))})),nR.waitFor(r)}removeMatchingKeys(e,t,n){const r=GR(e);return nR.forEach(t,(t=>{const i=xk(t.path);return nR.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=GR(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=GR(e);let i=VC();return r.Ot({range:n,$t:!0},((e,t,n)=>{const r=Lk(e[1]),s=new KE(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=xk(t.path),r=IDBKeyRange.bound([n],[EE(n)],!1,!0);let i=0;return GR(e).Ot({index:Kk.documentTargetsIndex,$t:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}lt(e,t){return KR(e).get(t).next((e=>e?SR(e):null))}}function KR(e){return fR(e,zk.store)}function HR(e){return fR(e,Hk.store)}function GR(e){return fR(e,Kk.store)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function QR(e){if(e.code!==uE.FAILED_PRECONDITION||e.message!==Zk)throw e;fE("LocalStore","Unexpectedly lost primary lease")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function YR([e,t],[n,r]){const i=IE(e,n);return 0===i?IE(t,r):i}class JR{constructor(e){this.ne=e,this.buffer=new xC(YR),this.se=0}ie(){return++this.se}re(e){const t=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();YR(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class XR{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.oe=!1,this.ce=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ae(e)}stop(){this.ce&&(this.ce.cancel(),this.ce=null)}get started(){return null!==this.ce}ae(e){const t=this.oe?3e5:6e4;fE("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.ce=null,this.oe=!0;try{await e.collectGarbage(this.garbageCollector)}catch(e){aR(e)?fE("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await QR(e)}await this.ae(e)}))}}class ZR{constructor(e,t){this.ue=e,this.params=t}calculateTargetCount(e,t){return this.ue.he(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return nR.resolve(cE.o);const n=new JR(t);return this.ue.forEachTarget(e,(e=>n.re(e.sequenceNumber))).next((()=>this.ue.le(e,(e=>n.re(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.ue.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.ue.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(fE("LruGarbageCollector","Garbage collection skipped; disabled"),nR.resolve(LR)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(fE("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),LR):this.fe(e,t)))}getCacheSize(e){return this.ue.getCacheSize(e)}fe(e,t){let n,r,i,s,o,a,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(fE("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),dE()<=ka.DEBUG&&fE("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(c-a)+"ms\n"+`Total Duration: ${c-u}ms`),nR.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eN{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new ZR(e,t)}(this,t)}he(e){const t=this.de(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}de(e){let t=0;return this.le(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}le(e,t){return this.we(e,((e,n)=>t(n)))}addReference(e,t,n){return tN(e,n)}removeReference(e,t,n){return tN(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return tN(e,t)}_e(e,t){return function(e,t){let n=!1;return WR(e).Mt((r=>jR(e,r,t).next((e=>(e&&(n=!0),nR.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.we(e,((s,o)=>{if(o<=t){const t=this._e(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s),GR(e).delete([0,xk(s.path)]))))}));r.push(t)}})).next((()=>nR.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return tN(e,t)}we(e,t){const n=GR(e);let r,i=cE.o;return n.Ot({index:Kk.documentTargetsIndex},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==cE.o&&t(new KE(Lk(r)),i),i=o,r=s):i=cE.o})).next((()=>{i!==cE.o&&t(new KE(Lk(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function tN(e,t){return GR(e).put(function(e,t){return new Kk(0,xk(e.path),t)}(t,e.currentSequenceNumber))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nN{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}forEach(e){RE(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return NE(this.inner)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rN{constructor(){this.changes=new nN((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:CE.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:cS.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?nR.resolve(n.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class iN{constructor(e,t){this.R=e,this.qt=t}addEntry(e,t,n){return aN(e).put(cN(t),n)}removeEntry(e,t){const n=aN(e),r=cN(t);return n.delete(r)}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.me(e,n))))}getEntry(e,t){return aN(e).get(cN(t)).next((e=>this.ge(t,e)))}ye(e,t){return aN(e).get(cN(t)).next((e=>({document:this.ge(t,e),size:UR(e)})))}getEntries(e,t){let n=LC();return this.pe(e,t,((e,t)=>{const r=this.ge(e,t);n=n.insert(e,r)})).next((()=>n))}Ee(e,t){let n=LC(),r=new NC(KE.comparator);return this.pe(e,t,((e,t)=>{const i=this.ge(e,t);n=n.insert(e,i),r=r.insert(e,UR(t))})).next((()=>({documents:n,Te:r})))}pe(e,t,n){if(t.isEmpty())return nR.resolve();const r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator();let s=i.getNext();return aN(e).Ot({range:r},((e,t,r)=>{const o=KE.fromSegments(e);for(;s&&KE.comparator(s,o)<0;)n(s,null),s=i.getNext();s&&s.isEqual(o)&&(n(s,t),s=i.hasNext()?i.getNext():null),s?r.Ct(s.path.toArray()):r.done()})).next((()=>{for(;s;)n(s,null),s=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n){let r=LC();const i=t.path.length+1,s={};if(n.isEqual(CE.min())){const e=t.path.toArray();s.range=IDBKeyRange.lowerBound(e)}else{const e=t.path.toArray(),r=wR(n);s.range=IDBKeyRange.lowerBound([e,r],!0),s.index=Wk.collectionReadTimeIndex}return aN(e).Ot(s,((e,n,s)=>{if(e.length!==i)return;const o=yR(this.R,n);t.path.isPrefixOf(o.key.path)?WS(t,o)&&(r=r.insert(o.key,o)):s.done()})).next((()=>r))}newChangeBuffer(e){return new sN(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return oN(e).get($k.key).next((e=>(yE(!!e),e)))}me(e,t){return oN(e).put($k.key,t)}ge(e,t){if(t){const e=yR(this.R,t);if(!e.isNoDocument()||!e.version.isEqual(CE.min()))return e}return cS.newInvalidDocument(e)}}class sN extends rN{constructor(e,t){super(),this.Ie=e,this.trackRemovals=t,this.Ae=new nN((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new xC(((e,t)=>IE(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.Ae.get(i);if(s.document.isValidDocument()){const a=vR(this.Ie.R,s.document,this.getReadTime(i));r=r.add(i.path.popLast());const c=UR(a);n+=c-o,t.push(this.Ie.addEntry(e,i,a))}else if(n-=o,this.trackRemovals){const n=vR(this.Ie.R,cS.newNoDocument(i,CE.min()),this.getReadTime(i));t.push(this.Ie.addEntry(e,i,n))}else t.push(this.Ie.removeEntry(e,i))})),r.forEach((n=>{t.push(this.Ie.qt.addToCollectionParentIndex(e,n))})),t.push(this.Ie.updateMetadata(e,n)),nR.waitFor(t)}getFromCache(e,t){return this.Ie.ye(e,t).next((e=>(this.Ae.set(t,e.size),e.document)))}getAllFromCache(e,t){return this.Ie.Ee(e,t).next((({documents:e,Te:t})=>(t.forEach(((e,t)=>{this.Ae.set(e,t)})),e)))}}function oN(e){return fR(e,$k.store)}function aN(e){return fR(e,Wk.store)}function cN(e){return e.path.toArray()}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uN{constructor(e){this.R=e}Rt(e,t,n,r){yE(n<r&&n>=0&&r<=11);const i=new rR("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Fk.store)}(e),function(e){e.createObjectStore(Uk.store,{keyPath:Uk.keyPath}),e.createObjectStore(qk.store,{keyPath:qk.keyPath,autoIncrement:!0}).createIndex(qk.userMutationsIndex,qk.userMutationsKeyPath,{unique:!0}),e.createObjectStore(jk.store)}(e),lN(e),function(e){e.createObjectStore(Wk.store)}(e));let s=nR.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(Kk.store),e.deleteObjectStore(zk.store),e.deleteObjectStore(Hk.store)}(e),lN(e)),s=s.next((()=>function(e){const t=e.store(Hk.store),n=new Hk(0,0,CE.min().toTimestamp(),0);return t.put(Hk.key,n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store(qk.store).Nt().next((n=>{e.deleteObjectStore(qk.store),e.createObjectStore(qk.store,{keyPath:qk.keyPath,autoIncrement:!0}).createIndex(qk.userMutationsIndex,qk.userMutationsKeyPath,{unique:!0});const r=t.store(qk.store),i=n.map((e=>r.put(e)));return nR.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore(Qk.store,{keyPath:Qk.keyPath})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Re(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore($k.store)}(e),this.Pe(i))))),n<7&&r>=7&&(s=s.next((()=>this.be(i)))),n<8&&r>=8&&(s=s.next((()=>this.ve(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){const t=e.objectStore(Wk.store);t.createIndex(Wk.readTimeIndex,Wk.readTimeIndexPath,{unique:!1}),t.createIndex(Wk.collectionReadTimeIndex,Wk.collectionReadTimeIndexPath,{unique:!1})}(t)}))),n<10&&r>=10&&(s=s.next((()=>this.Ve(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore(Yk.store,{keyPath:Yk.keyPath})}(e),function(e){e.createObjectStore(Jk.store,{keyPath:Jk.keyPath})}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}))),s}Pe(e){let t=0;return e.store(Wk.store).Ot(((e,n)=>{t+=UR(n)})).next((()=>{const n=new $k(t);return e.store($k.store).put($k.key,n)}))}Re(e){const t=e.store(Uk.store),n=e.store(qk.store);return t.Nt().next((t=>nR.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.Nt(qk.userMutationsIndex,r).next((n=>nR.forEach(n,(n=>{yE(n.userId===t.userId);const r=ER(this.R,n);return FR(e,t.userId,r).next((()=>{}))}))))}))))}be(e){const t=e.store(Kk.store),n=e.store(Wk.store);return e.store(Hk.store).get(Hk.key).next((e=>{const r=[];return n.Ot(((n,i)=>{const s=new PE(n),o=function(e){return[0,xk(e)]}(s);r.push(t.get(o).next((n=>n?nR.resolve():(n=>t.put(new Kk(0,xk(n),e.highestListenSequenceNumber)))(s))))})).next((()=>nR.waitFor(r)))}))}ve(e,t){e.createObjectStore(Gk.store,{keyPath:Gk.keyPath});const n=t.store(Gk.store),r=new xR,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:xk(r)})}};return t.store(Wk.store).Ot({$t:!0},((e,t)=>{const n=new PE(e);return i(n.popLast())})).next((()=>t.store(jk.store).Ot({$t:!0},(([e,t,n],r)=>{const s=Lk(t);return i(s.popLast())}))))}Ve(e){const t=e.store(zk.store);return t.Ot(((e,n)=>{const r=SR(n),i=CR(this.R,r);return t.put(i)}))}}function lN(e){e.createObjectStore(Kk.store,{keyPath:Kk.keyPath}).createIndex(Kk.documentTargetsIndex,Kk.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(zk.store,{keyPath:zk.keyPath}).createIndex(zk.queryTargetsIndexName,zk.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(Hk.store)}const hN="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class dN{constructor(e,t,n,r,i,s,o,a,c,u){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Se=i,this.window=s,this.document=o,this.De=c,this.Ce=u,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.$e=null,this.Oe=null,this.Me=Number.NEGATIVE_INFINITY,this.Fe=e=>Promise.resolve(),!dN.gt())throw new lE(uE.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new eN(this,r),this.Le=t+"main",this.R=new _R(a),this.Be=new iR(this.Le,11,new uN(this.R)),this.Ue=new zR(this.referenceDelegate,this.R),this.qt=new DR,this.qe=function(e,t){return new iN(e,t)}(this.R,this.qt),this.Ke=new RR,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===u&&pE("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.je().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new lE(uE.FAILED_PRECONDITION,hN);return this.We(),this.Ge(),this.ze(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ue.getHighestSequenceNumber(e)))})).then((e=>{this.Ne=new cE(e,this.De)})).then((()=>{this.xe=!0})).catch((e=>(this.Be&&this.Be.close(),Promise.reject(e))))}He(e){return this.Fe=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Be.bt((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget((async()=>{this.started&&await this.je()})))}je(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>pN(e).put(new Qk(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next((()=>{if(this.isPrimary)return this.Je(e).next((e=>{e||(this.isPrimary=!1,this.Se.enqueueRetryable((()=>this.Fe(!1))))}))})).next((()=>this.Ye(e))).next((t=>this.isPrimary&&!t?this.Xe(e).next((()=>!1)):!!t&&this.Ze(e).next((()=>!0)))))).catch((e=>{if(aR(e))return fE("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fE("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Se.enqueueRetryable((()=>this.Fe(e))),this.isPrimary=e}))}Je(e){return fN(e).get(Fk.key).next((e=>nR.resolve(this.tn(e))))}en(e){return pN(e).delete(this.clientId)}async nn(){if(this.isPrimary&&!this.sn(this.Me,18e5)){this.Me=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=fR(e,Qk.store);return t.Nt().next((e=>{const n=this.rn(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return nR.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Qe)for(const t of e)this.Qe.removeItem(this.on(t.clientId))}}ze(){this.Oe=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.je().then((()=>this.nn())).then((()=>this.ze()))))}tn(e){return!!e&&e.ownerId===this.clientId}Ye(e){return this.Ce?nR.resolve(!0):fN(e).get(Fk.key).next((t=>{if(null!==t&&this.sn(t.leaseTimestampMs,5e3)&&!this.cn(t.ownerId)){if(this.tn(t)&&this.networkEnabled)return!0;if(!this.tn(t)){if(!t.allowTabSynchronization)throw new lE(uE.FAILED_PRECONDITION,hN);return!1}}return!(!this.networkEnabled||!this.inForeground)||pN(e).Nt().next((e=>void 0===this.rn(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&fE("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.xe=!1,this.an(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.un(),this.hn(),await this.Be.runTransaction("shutdown","readwrite",[Fk.store,Qk.store],(e=>{const t=new dR(e,cE.o);return this.Xe(t).next((()=>this.en(t)))})),this.Be.close(),this.ln()}rn(e,t){return e.filter((e=>this.sn(e.updateTimeMs,t)&&!this.cn(e.clientId)))}fn(){return this.runTransaction("getActiveClients","readonly",(e=>pN(e).Nt().next((e=>this.rn(e,18e5).map((e=>e.clientId))))))}get started(){return this.xe}getMutationQueue(e){return qR.Qt(e,this.R,this.qt,this.referenceDelegate)}getTargetCache(){return this.Ue}getRemoteDocumentCache(){return this.qe}getIndexManager(){return this.qt}getBundleCache(){return this.Ke}runTransaction(e,t,n){fE("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite";let i;return this.Be.runTransaction(e,r,Xk,(r=>(i=new dR(r,this.Ne?this.Ne.next():cE.o),"readwrite-primary"===t?this.Je(i).next((e=>!!e||this.Ye(i))).next((t=>{if(!t)throw pE(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Se.enqueueRetryable((()=>this.Fe(!1))),new lE(uE.FAILED_PRECONDITION,Zk);return n(i)})).next((e=>this.Ze(i).next((()=>e)))):this.dn(i).next((()=>n(i)))))).then((e=>(i.raiseOnCommittedEvent(),e)))}dn(e){return fN(e).get(Fk.key).next((e=>{if(null!==e&&this.sn(e.leaseTimestampMs,5e3)&&!this.cn(e.ownerId)&&!this.tn(e)&&!(this.Ce||this.allowTabSynchronization&&e.allowTabSynchronization))throw new lE(uE.FAILED_PRECONDITION,hN)}))}Ze(e){const t=new Fk(this.clientId,this.allowTabSynchronization,Date.now());return fN(e).put(Fk.key,t)}static gt(){return iR.gt()}Xe(e){const t=fN(e);return t.get(Fk.key).next((e=>this.tn(e)?(fE("IndexedDbPersistence","Releasing primary lease."),t.delete(Fk.key)):nR.resolve()))}sn(e,t){const n=Date.now();return!(e<n-t||e>n&&(pE(`Detected an update time that is in the future: ${e} > ${n}`),1))}We(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.$e=()=>{this.Se.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.je())))},this.document.addEventListener("visibilitychange",this.$e),this.inForeground="visible"===this.document.visibilityState)}un(){this.$e&&(this.document.removeEventListener("visibilitychange",this.$e),this.$e=null)}Ge(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ke=()=>{this.an(),this.Se.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ke))}hn(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)}cn(e){var t;try{const n=null!==(null===(t=this.Qe)||void 0===t?void 0:t.getItem(this.on(e)));return fE("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return pE("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}an(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(e){pE("Failed to set zombie client id.",e)}}ln(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(e){}}on(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fN(e){return fR(e,Fk.store)}function pN(e){return fR(e,Qk.store)}function gN(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class mN{constructor(e,t){this.progress=e,this.wn=t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _N{constructor(e,t,n){this.qe=e,this._n=t,this.qt=n}mn(e,t){return this._n.getAllMutationBatchesAffectingDocumentKey(e,t).next((n=>this.gn(e,t,n)))}gn(e,t,n){return this.qe.getEntry(e,t).next((e=>{for(const t of n)t.applyToLocalView(e);return e}))}yn(e,t){e.forEach(((e,n)=>{for(const e of t)e.applyToLocalView(n)}))}pn(e,t){return this.qe.getEntries(e,t).next((t=>this.En(e,t).next((()=>t))))}En(e,t){return this._n.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>this.yn(t,e)))}getDocumentsMatchingQuery(e,t,n){return function(e){return KE.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Tn(e,t.path):MS(t)?this.In(e,t,n):this.An(e,t,n)}Tn(e,t){return this.mn(e,new KE(t)).next((e=>{let t=FC();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}In(e,t,n){const r=t.collectionGroup;let i=FC();return this.qt.getCollectionParents(e,r).next((s=>nR.forEach(s,(s=>{const o=function(e,t){return new NS(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.An(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}An(e,t,n){let r,i;return this.qe.getDocumentsMatchingQuery(e,t,n).next((n=>(r=n,this._n.getAllMutationBatchesAffectingQuery(e,t)))).next((t=>(i=t,this.Rn(e,i,r).next((e=>{r=e;for(const e of i)for(const t of e.mutations){const n=t.key;let i=r.get(n);null==i&&(i=cS.newInvalidDocument(n),r=r.insert(n,i)),fC(t,i,e.localWriteTime),i.isFoundDocument()||(r=r.remove(n))}}))))).next((()=>(r.forEach(((e,n)=>{WS(t,n)||(r=r.remove(e))})),r)))}Rn(e,t,n){let r=VC();for(const e of t)for(const t of e.mutations)t instanceof yC&&null===n.get(t.key)&&(r=r.add(t.key));let i=n;return this.qe.getEntries(e,r).next((e=>(e.forEach(((e,t)=>{t.isFoundDocument()&&(i=i.insert(e,t))})),i)))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yN{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pn=n,this.bn=r}static vn(e,t){let n=VC(),r=VC();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new yN(e,t.fromCache,n,r)}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vN{Vn(e){this.Sn=e}getDocumentsMatchingQuery(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(CE.min())?this.Dn(e,t):this.Sn.pn(e,r).next((i=>{const s=this.Cn(t,i);return(xS(t)||DS(t))&&this.Nn(t.limitType,s,r,n)?this.Dn(e,t):(dE()<=ka.DEBUG&&fE("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),BS(t)),this.Sn.getDocumentsMatchingQuery(e,t,n).next((e=>(s.forEach((t=>{e=e.insert(t.key,t)})),e))))}))}Cn(e,t){let n=new xC($S(e));return t.forEach(((t,r)=>{WS(e,r)&&(n=n.add(r))})),n}Nn(e,t,n,r){if(n.size!==t.size)return!0;const i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Dn(e,t){return dE()<=ka.DEBUG&&fE("QueryEngine","Using full collection scan to execute query:",BS(t)),this.Sn.getDocumentsMatchingQuery(e,t,CE.min())}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wN{constructor(e,t,n,r){this.persistence=e,this.xn=t,this.R=r,this.kn=new NC(IE),this.$n=new nN((e=>hS(e)),dS),this.On=CE.min(),this._n=e.getMutationQueue(n),this.Mn=e.getRemoteDocumentCache(),this.Ue=e.getTargetCache(),this.Fn=new _N(this.Mn,this._n,this.persistence.getIndexManager()),this.Ke=e.getBundleCache(),this.xn.Vn(this.Fn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.kn)))}}function bN(e,t,n,r){return new wN(e,t,n,r)}async function IN(e,t){const n=vE(e);let r=n._n,i=n.Fn;const s=await n.persistence.runTransaction("Handle user change","readonly",(e=>{let s;return n._n.getAllMutationBatches(e).next((o=>(s=o,r=n.persistence.getMutationQueue(t),i=new _N(n.Mn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)))).next((t=>{const n=[],r=[];let o=VC();for(const e of s){n.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return i.pn(e,o).next((e=>({Ln:e,removedBatchIds:n,addedBatchIds:r})))}))}));return n._n=r,n.Fn=i,n.xn.Vn(n.Fn),s}function TN(e){const t=vE(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ue.getLastRemoteSnapshotVersion(e)))}function EN(e,t,n,r,i){let s=VC();return n.forEach((e=>s=s.add(e))),t.getEntries(e,s).next((e=>{let s=LC();return n.forEach(((n,o)=>{const a=e.get(n),c=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(CE.min())?(t.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o,c),s=s.insert(n,o)):fE("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}function SN(e,t){const n=vE(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n._n.getNextMutationBatchAfterBatchId(e,t))))}function CN(e,t){const n=vE(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ue.getTargetData(e,t).next((i=>i?(r=i,nR.resolve(r)):n.Ue.allocateTargetId(e).next((i=>(r=new mR(t,i,0,e.currentSequenceNumber),n.Ue.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.kn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(e.targetId,e),n.$n.set(t,e.targetId)),e}))}async function kN(e,t,n){const r=vE(e),i=r.kn.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!aR(e))throw e;fE("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.kn=r.kn.remove(t),r.$n.delete(i.target)}function RN(e,t,n){const r=vE(e);let i=CE.min(),s=VC();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=vE(e),i=r.$n.get(n);return void 0!==i?nR.resolve(r.kn.get(i)):r.Ue.getTargetData(t,n)}(r,e,US(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ue.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.xn.getDocumentsMatchingQuery(e,t,n?i:CE.min(),n?s:VC()))).next((e=>({documents:e,Bn:s})))))}function NN(e,t){const n=vE(e),r=vE(n.Ue),i=n.kn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.lt(e,t).next((e=>e?e.target:null))))}function AN(e){const t=vE(e);return t.persistence.runTransaction("Get new document changes","readonly",(e=>function(e,t,n){const r=vE(e);let i=LC(),s=wR(n);const o=aN(t),a=IDBKeyRange.lowerBound(s,!0);return o.Ot({index:Wk.readTimeIndex,range:a},((e,t)=>{const n=yR(r.R,t);i=i.insert(n.key,n),s=t.readTime})).next((()=>({wn:i,readTime:bR(s)})))}(t.Mn,e,t.On))).then((({wn:e,readTime:n})=>(t.On=n,e)))}async function PN(e,t,n=VC()){const r=await CN(e,US(kR(t.bundledQuery))),i=vE(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=sk(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Ke.saveNamedQuery(e,t);const o=r.withResumeToken(LE.EMPTY_BYTE_STRING,s);return i.kn=i.kn.insert(o.targetId,o),i.Ue.updateTargetData(e,o).next((()=>i.Ue.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Ue.addMatchingKeys(e,n,r.targetId))).next((()=>i.Ke.saveNamedQuery(e,t)))}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xN{constructor(e){this.R=e,this.Qn=new Map,this.jn=new Map}getBundleMetadata(e,t){return nR.resolve(this.Qn.get(t))}saveBundleMetadata(e,t){var n;return this.Qn.set(t.id,{id:(n=t).id,version:n.version,createTime:sk(n.createTime)}),nR.resolve()}getNamedQuery(e,t){return nR.resolve(this.jn.get(t))}saveNamedQuery(e,t){return this.jn.set(t.name,function(e){return{name:e.name,query:kR(e.bundledQuery),readTime:sk(e.readTime)}}(t)),nR.resolve()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class DN{constructor(){this.Wn=new xC(ON.Gn),this.zn=new xC(ON.Hn)}isEmpty(){return this.Wn.isEmpty()}addReference(e,t){const n=new ON(e,t);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)}Jn(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Yn(new ON(e,t))}Xn(e,t){e.forEach((e=>this.removeReference(e,t)))}Zn(e){const t=new KE(new PE([])),n=new ON(t,e),r=new ON(t,e+1),i=[];return this.zn.forEachInRange([n,r],(e=>{this.Yn(e),i.push(e.key)})),i}ts(){this.Wn.forEach((e=>this.Yn(e)))}Yn(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)}es(e){const t=new KE(new PE([])),n=new ON(t,e),r=new ON(t,e+1);let i=VC();return this.zn.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new ON(e,0),n=this.Wn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ON{constructor(e,t){this.key=e,this.ns=t}static Gn(e,t){return KE.comparator(e.key,t.key)||IE(e.ns,t.ns)}static Hn(e,t){return IE(e.ns,t.ns)||KE.comparator(e.key,t.key)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class LN{constructor(e,t){this.qt=e,this.referenceDelegate=t,this._n=[],this.ss=1,this.rs=new xC(ON.Gn)}checkEmpty(e){return nR.resolve(0===this._n.length)}addMutationBatch(e,t,n,r){const i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];const s=new pR(i,t,n,r);this._n.push(s);for(const t of r)this.rs=this.rs.add(new ON(t.key,i)),this.qt.addToCollectionParentIndex(e,t.key.path.popLast());return nR.resolve(s)}lookupMutationBatch(e,t){return nR.resolve(this.os(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.cs(n),i=r<0?0:r;return nR.resolve(this._n.length>i?this._n[i]:null)}getHighestUnacknowledgedBatchId(){return nR.resolve(0===this._n.length?-1:this.ss-1)}getAllMutationBatches(e){return nR.resolve(this._n.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ON(t,0),r=new ON(t,Number.POSITIVE_INFINITY),i=[];return this.rs.forEachInRange([n,r],(e=>{const t=this.os(e.ns);i.push(t)})),nR.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new xC(IE);return t.forEach((e=>{const t=new ON(e,0),r=new ON(e,Number.POSITIVE_INFINITY);this.rs.forEachInRange([t,r],(e=>{n=n.add(e.ns)}))})),nR.resolve(this.us(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;KE.isDocumentKey(i)||(i=i.child(""));const s=new ON(new KE(i),0);let o=new xC(IE);return this.rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ns)),!0)}),s),nR.resolve(this.us(o))}us(e){const t=[];return e.forEach((e=>{const n=this.os(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){yE(0===this.hs(t.batchId,"removed")),this._n.shift();let n=this.rs;return nR.forEach(t.mutations,(r=>{const i=new ON(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.rs=n}))}Gt(e){}containsKey(e,t){const n=new ON(t,0),r=this.rs.firstAfterOrEqual(n);return nR.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this._n.length,nR.resolve()}hs(e,t){return this.cs(e)}cs(e){return 0===this._n.length?0:e-this._n[0].batchId}os(e){const t=this.cs(e);return t<0||t>=this._n.length?null:this._n[t]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class MN{constructor(e,t){this.qt=e,this.ls=t,this.docs=new NC(KE.comparator),this.size=0}addEntry(e,t,n){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ls(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:o,readTime:n}),this.size+=o-s,this.qt.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return nR.resolve(n?n.document.clone():cS.newInvalidDocument(t))}getEntries(e,t){let n=LC();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.clone():cS.newInvalidDocument(e))})),nR.resolve(n)}getDocumentsMatchingQuery(e,t,n){let r=LC();const i=new KE(t.path.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i,readTime:o}}=s.getNext();if(!t.path.isPrefixOf(e.path))break;o.compareTo(n)<=0||WS(t,i)&&(r=r.insert(i.key,i.clone()))}return nR.resolve(r)}fs(e,t){return nR.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new FN(this)}getSize(e){return nR.resolve(this.size)}}class FN extends rN{constructor(e){super(),this.Ie=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.document.isValidDocument()?t.push(this.Ie.addEntry(e,r.document,this.getReadTime(n))):this.Ie.removeEntry(n)})),nR.waitFor(t)}getFromCache(e,t){return this.Ie.getEntry(e,t)}getAllFromCache(e,t){return this.Ie.getEntries(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class UN{constructor(e){this.persistence=e,this.ds=new nN((e=>hS(e)),dS),this.lastRemoteSnapshotVersion=CE.min(),this.highestTargetId=0,this.ws=0,this._s=new DN,this.targetCount=0,this.gs=$R.Jt()}forEachTarget(e,t){return this.ds.forEach(((e,n)=>t(n))),nR.resolve()}getLastRemoteSnapshotVersion(e){return nR.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return nR.resolve(this.ws)}allocateTargetId(e){return this.highestTargetId=this.gs.next(),nR.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ws&&(this.ws=t),nR.resolve()}te(e){this.ds.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.gs=new $R(t),this.highestTargetId=t),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)}addTargetData(e,t){return this.te(t),this.targetCount+=1,nR.resolve()}updateTargetData(e,t){return this.te(t),nR.resolve()}removeTargetData(e,t){return this.ds.delete(t.target),this._s.Zn(t.targetId),this.targetCount-=1,nR.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ds.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.ds.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),nR.waitFor(i).next((()=>r))}getTargetCount(e){return nR.resolve(this.targetCount)}getTargetData(e,t){const n=this.ds.get(t)||null;return nR.resolve(n)}addMatchingKeys(e,t,n){return this._s.Jn(t,n),nR.resolve()}removeMatchingKeys(e,t,n){this._s.Xn(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),nR.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._s.Zn(t),nR.resolve()}getMatchingKeysForTargetId(e,t){const n=this._s.es(t);return nR.resolve(n)}containsKey(e,t){return nR.resolve(this._s.containsKey(t))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qN{constructor(e,t){this.ys={},this.Ne=new cE(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.Ue=new UN(this),this.qt=new PR,this.qe=function(e,t){return new MN(e,t)}(this.qt,(e=>this.referenceDelegate.ps(e))),this.R=new _R(t),this.Ke=new xN(this.R)}start(){return Promise.resolve()}shutdown(){return this.xe=!1,Promise.resolve()}get started(){return this.xe}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.qt}getMutationQueue(e){let t=this.ys[e.toKey()];return t||(t=new LN(this.qt,this.referenceDelegate),this.ys[e.toKey()]=t),t}getTargetCache(){return this.Ue}getRemoteDocumentCache(){return this.qe}getBundleCache(){return this.Ke}runTransaction(e,t,n){fE("MemoryPersistence","Starting transaction:",e);const r=new jN(this.Ne.next());return this.referenceDelegate.Es(),n(r).next((e=>this.referenceDelegate.Ts(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Is(e,t){return nR.or(Object.values(this.ys).map((n=>()=>n.containsKey(e,t))))}}class jN extends eR{constructor(e){super(),this.currentSequenceNumber=e}}class VN{constructor(e){this.persistence=e,this.As=new DN,this.Rs=null}static Ps(e){return new VN(e)}get bs(){if(this.Rs)return this.Rs;throw _E()}addReference(e,t,n){return this.As.addReference(n,t),this.bs.delete(n.toString()),nR.resolve()}removeReference(e,t,n){return this.As.removeReference(n,t),this.bs.add(n.toString()),nR.resolve()}markPotentiallyOrphaned(e,t){return this.bs.add(t.toString()),nR.resolve()}removeTarget(e,t){this.As.Zn(t.targetId).forEach((e=>this.bs.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.bs.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Es(){this.Rs=new Set}Ts(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return nR.forEach(this.bs,(n=>{const r=KE.fromPath(n);return this.vs(e,r).next((e=>{e||t.removeEntry(r)}))})).next((()=>(this.Rs=null,t.apply(e))))}updateLimboDocument(e,t){return this.vs(e,t).next((e=>{e?this.bs.delete(t.toString()):this.bs.add(t.toString())}))}ps(e){return 0}vs(e,t){return nR.or([()=>nR.resolve(this.As.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Is(e,t)])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BN{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}function WN(e,t){return`firestore_clients_${e}_${t}`}function $N(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function zN(e,t){return`firestore_targets_${e}_${t}`}BN.UNAUTHENTICATED=new BN(null),BN.GOOGLE_CREDENTIALS=new BN("google-credentials-uid"),BN.FIRST_PARTY=new BN("first-party-uid");class KN{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Vs(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new lE(r.error.code,r.error.message))),s?new KN(e,t,r.state,i):(pE("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class HN{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Vs(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new lE(n.error.code,n.error.message))),i?new HN(e,n.state,r):(pE("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class GN{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Vs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=WC();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=zE(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new GN(e,i):(pE("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class QN{constructor(e,t){this.clientId=e,this.onlineState=t}static Vs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new QN(t.clientId,t.onlineState):(pE("SharedClientState",`Failed to parse online state: ${e}`),null)}}class YN{constructor(){this.activeTargetIds=WC()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}Cs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ss(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class JN{constructor(e,t,n,r,i){this.window=e,this.Se=t,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.$s=new NC(IE),this.started=!1,this.Os=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ms=WN(this.persistenceKey,this.Ns),this.Fs=function(e){return`firestore_sequence_number_${e}`}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.persistenceKey),this.$s=this.$s.insert(this.Ns,new YN),this.Ls=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Bs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Us=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.qs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Ks=function(e){return`firestore_bundle_loaded_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}static gt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.fn();for(const t of e){if(t===this.Ns)continue;const e=this.getItem(WN(this.persistenceKey,t));if(e){const n=GN.Vs(t,e);n&&(this.$s=this.$s.insert(n.clientId,n))}}this.Qs();const t=this.storage.getItem(this.qs);if(t){const e=this.js(t);e&&this.Ws(e)}for(const e of this.Os)this.ks(e);this.Os=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Fs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.$s)}isActiveQueryTarget(e){let t=!1;return this.$s.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,n){this.zs(e,t,n),this.Hs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(zN(this.persistenceKey,e));if(n){const r=HN.Vs(e,n);r&&(t=r.state)}}return this.Js.Ds(e),this.Qs(),t}removeLocalQueryTarget(e){this.Js.Cs(e),this.Qs()}isLocalQueryTarget(e){return this.Js.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(zN(this.persistenceKey,e))}updateQueryState(e,t,n){this.Ys(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Hs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Xs(e)}notifyBundleLoaded(){this.Zs()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Ms),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return fE("SharedClientState","READ",e,t),t}setItem(e,t){fE("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){fE("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ks(e){const t=e;if(t.storageArea===this.storage){if(fE("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ms)return void pE("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Ls.test(t.key)){if(null==t.newValue){const e=this.ti(t.key);return this.ei(e,null)}{const e=this.ni(t.key,t.newValue);if(e)return this.ei(e.clientId,e)}}else if(this.Bs.test(t.key)){if(null!==t.newValue){const e=this.si(t.key,t.newValue);if(e)return this.ii(e)}}else if(this.Us.test(t.key)){if(null!==t.newValue){const e=this.ri(t.key,t.newValue);if(e)return this.oi(e)}}else if(t.key===this.qs){if(null!==t.newValue){const e=this.js(t.newValue);if(e)return this.Ws(e)}}else if(t.key===this.Fs){const e=function(e){let t=cE.o;if(null!=e)try{const n=JSON.parse(e);yE("number"==typeof n),t=n}catch(e){pE("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==cE.o&&this.sequenceNumberHandler(e)}else if(t.key===this.Ks)return this.syncEngine.ci()}else this.Os.push(t)}))}}get Js(){return this.$s.get(this.Ns)}Qs(){this.setItem(this.Ms,this.Js.Ss())}zs(e,t,n){const r=new KN(this.currentUser,e,t,n),i=$N(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ss())}Hs(e){const t=$N(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Xs(e){const t={clientId:this.Ns,onlineState:e};this.storage.setItem(this.qs,JSON.stringify(t))}Ys(e,t,n){const r=zN(this.persistenceKey,e),i=new HN(e,t,n);this.setItem(r,i.Ss())}Zs(){this.setItem(this.Ks,"value-not-used")}ti(e){const t=this.Ls.exec(e);return t?t[1]:null}ni(e,t){const n=this.ti(e);return GN.Vs(n,t)}si(e,t){const n=this.Bs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return KN.Vs(new BN(i),r,t)}ri(e,t){const n=this.Us.exec(e),r=Number(n[1]);return HN.Vs(r,t)}js(e){return QN.Vs(e)}async ii(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.ai(e.batchId,e.state,e.error);fE("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}oi(e){return this.syncEngine.ui(e.targetId,e.state,e.error)}ei(e,t){const n=t?this.$s.insert(e,t):this.$s.remove(e),r=this.Gs(this.$s),i=this.Gs(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.hi(s,o).then((()=>{this.$s=n}))}Ws(e){this.$s.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=WC();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class XN{constructor(){this.li=new YN,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.li.Ds(e),this.fi[e]||"not-current"}updateQueryState(e,t,n){this.fi[e]=t}removeLocalQueryTarget(e){this.li.Cs(e)}isLocalQueryTarget(e){return this.li.activeTargetIds.has(e)}clearQueryState(e){delete this.fi[e]}getAllActiveQueryTargets(){return this.li.activeTargetIds}isActiveQueryTarget(e){return this.li.activeTargetIds.has(e)}start(){return this.li=new YN,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ZN{di(e){}shutdown(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eA{constructor(){this.wi=()=>this._i(),this.mi=()=>this.gi(),this.yi=[],this.pi()}di(e){this.yi.push(e)}shutdown(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)}pi(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)}_i(){fE("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.yi)e(0)}gi(){fE("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.yi)e(1)}static gt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const tA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nA{constructor(e){this.Ei=e.Ei,this.Ti=e.Ti}Ii(e){this.Ai=e}Ri(e){this.Pi=e}onMessage(e){this.bi=e}close(){this.Ti()}send(e){this.Ei(e)}vi(){this.Ai()}Vi(e){this.Pi(e)}Si(e){this.bi(e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rA extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.Di=t+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Ni(e,t,n,r){const i=this.xi(e,t);fE("RestConnection","Sending: ",i,n);const s={};return this.ki(s,r),this.$i(e,i,s,n).then((e=>(fE("RestConnection","Received: ",e),e)),(t=>{throw gE("RestConnection",`${e} failed with error: `,t,"url: ",i,"request:",n),t}))}Oi(e,t,n,r){return this.Ni(e,t,n,r)}ki(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+aE,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(const n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])}xi(e,t){const n=tA[e];return`${this.Di}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling}$i(e,t,n,r){return new Promise(((i,s)=>{const o=new oE;o.listenOnce(tE.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case eE.NO_ERROR:const t=o.getResponseJson();fE("Connection","XHR received:",JSON.stringify(t)),i(t);break;case eE.TIMEOUT:fE("Connection",'RPC "'+e+'" timed out'),s(new lE(uE.DEADLINE_EXCEEDED,"Request time out"));break;case eE.HTTP_ERROR:const n=o.getStatus();if(fE("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(uE).indexOf(t)>=0?t:uE.UNKNOWN}(e.status);s(new lE(t,e.message))}else s(new lE(uE.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new lE(uE.UNAVAILABLE,"Connection failed."));break;default:_E()}}finally{fE("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(r);o.send(t,"POST",a,n,15)}))}Mi(e,t){const n=[this.Di,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new QT,i=Jb(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.ki(s.initMessageHeaders,t),jo()||Wo()||qo().indexOf("Electron/")>=0||$o()||qo().indexOf("MSAppHost/")>=0||Bo()||(s.httpHeadersOverwriteParam="$httpHeaders");const o=n.join("");fE("Connection","Creating WebChannel: "+o,s);const a=r.createWebChannel(o,s);let c=!1,u=!1;const l=new nA({Ei:e=>{u?fE("Connection","Not sending because WebChannel is closed:",e):(c||(fE("Connection","Opening WebChannel transport."),a.open(),c=!0),fE("Connection","WebChannel sending:",e),a.send(e))},Ti:()=>a.close()}),h=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return h(a,sE.EventType.OPEN,(()=>{u||fE("Connection","WebChannel transport opened.")})),h(a,sE.EventType.CLOSE,(()=>{u||(u=!0,fE("Connection","WebChannel transport closed"),l.Vi())})),h(a,sE.EventType.ERROR,(e=>{u||(u=!0,gE("Connection","WebChannel transport errored:",e),l.Vi(new lE(uE.UNAVAILABLE,"The operation could not be completed")))})),h(a,sE.EventType.MESSAGE,(e=>{var t;if(!u){const n=e.data[0];yE(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){fE("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=SC[e];if(void 0!==t)return RC(t)}(e),n=i.message;void 0===t&&(t=uE.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),u=!0,l.Vi(new lE(t,n)),a.close()}else fE("Connection","WebChannel received:",n),l.Si(n)}})),h(i,nE.STAT_EVENT,(e=>{e.stat===rE?fE("Connection","Detected buffering proxy"):e.stat===iE&&fE("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.vi()}),0),l}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function iA(){return"undefined"!=typeof window?window:null}function sA(){return"undefined"!=typeof document?document:null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function oA(e){return new tk(e,!0)}class aA{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Se=e,this.timerId=t,this.Fi=n,this.Li=r,this.Bi=i,this.Ui=0,this.qi=null,this.Ki=Date.now(),this.reset()}reset(){this.Ui=0}Qi(){this.Ui=this.Bi}ji(e){this.cancel();const t=Math.floor(this.Ui+this.Wi()),n=Math.max(0,Date.now()-this.Ki),r=Math.max(0,t-n);r>0&&fE("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ui} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qi=this.Se.enqueueAfterDelay(this.timerId,r,(()=>(this.Ki=Date.now(),e()))),this.Ui*=this.Li,this.Ui<this.Fi&&(this.Ui=this.Fi),this.Ui>this.Bi&&(this.Ui=this.Bi)}Gi(){null!==this.qi&&(this.qi.skipDelay(),this.qi=null)}cancel(){null!==this.qi&&(this.qi.cancel(),this.qi=null)}Wi(){return(Math.random()-.5)*this.Ui}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cA{constructor(e,t,n,r,i,s){this.Se=e,this.zi=n,this.Hi=r,this.Ji=i,this.listener=s,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new aA(e,t)}tr(){return 1===this.state||2===this.state||4===this.state}er(){return 2===this.state}start(){3!==this.state?this.auth():this.nr()}async stop(){this.tr()&&await this.close(0)}sr(){this.state=0,this.Zi.reset()}ir(){this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(()=>this.rr())))}cr(e){this.ar(),this.stream.send(e)}async rr(){if(this.er())return this.close(0)}ar(){this.Xi&&(this.Xi.cancel(),this.Xi=null)}async close(e,t){this.ar(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():t&&t.code===uE.RESOURCE_EXHAUSTED?(pE(t.toString()),pE("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):t&&t.code===uE.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ur(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ri(t)}ur(){}auth(){this.state=1;const e=this.hr(this.Yi),t=this.Yi;this.Ji.getToken().then((e=>{this.Yi===t&&this.lr(e)}),(t=>{e((()=>{const e=new lE(uE.UNKNOWN,"Fetching auth token failed: "+t.message);return this.dr(e)}))}))}lr(e){const t=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii((()=>{t((()=>(this.state=2,this.listener.Ii())))})),this.stream.Ri((e=>{t((()=>this.dr(e)))})),this.stream.onMessage((e=>{t((()=>this.onMessage(e)))}))}nr(){this.state=4,this.Zi.ji((async()=>{this.state=0,this.start()}))}dr(e){return fE("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(3,e)}hr(e){return t=>{this.Se.enqueueAndForget((()=>this.Yi===e?t():(fE("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class uA extends cA{constructor(e,t,n,r,i){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,n,i),this.R=r}wr(e){return this.Hi.Mi("Listen",e)}onMessage(e){this.Zi.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:_E()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.I?(yE(void 0===t||"string"==typeof t),LE.fromBase64String(t||"")):(yE(void 0===t||t instanceof Uint8Array),LE.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?uE.UNKNOWN:RC(e.code);return new lE(t,e.message||"")}(o);n=new GC(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=uk(e,r.document.name),s=sk(r.document.updateTime),o=new oS({mapValue:{fields:r.document.fields}}),a=cS.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new KC(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=uk(e,r.document),s=r.readTime?sk(r.readTime):CE.min(),o=cS.newNoDocument(i,s),a=r.removedTargetIds||[];n=new KC([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=uk(e,r.document),s=r.removedTargetIds||[];n=new KC([],s,i,null)}else{if(!("filter"in t))return _E();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new EC(r),s=e.targetId;n=new HC(s,i)}}return n}(this.R,e),n=function(e){if(!("targetChange"in e))return CE.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?CE.min():t.readTime?sk(t.readTime):CE.min()}(e);return this.listener._r(t,n)}mr(e){const t={};t.database=dk(this.R),t.addTarget=function(e,t){let n;const r=t.target;return n=fS(r)?{documents:yk(e,r)}:{query:vk(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=rk(e,t.resumeToken):t.snapshotVersion.compareTo(CE.min())>0&&(n.readTime=nk(e,t.snapshotVersion.toTimestamp())),n}(this.R,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _E()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,e);n&&(t.labels=n),this.cr(t)}gr(e){const t={};t.database=dk(this.R),t.removeTarget=e,this.cr(t)}}class lA extends cA{constructor(e,t,n,r,i){super(e,"write_stream_connection_backoff","write_stream_idle",t,n,i),this.R=r,this.yr=!1}get pr(){return this.yr}start(){this.yr=!1,this.lastStreamToken=void 0,super.start()}ur(){this.yr&&this.Er([])}wr(e){return this.Hi.Mi("Write",e)}onMessage(e){if(yE(!!e.streamToken),this.lastStreamToken=e.streamToken,this.yr){this.Zi.reset();const t=function(e,t){return e&&e.length>0?(yE(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?sk(e.updateTime):sk(t);return n.isEqual(CE.min())&&(n=sk(t)),new cC(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=sk(e.commitTime);return this.listener.Tr(n,t)}return yE(!e.writeResults||0===e.writeResults.length),this.yr=!0,this.listener.Ir()}Ar(){const e={};e.database=dk(this.R),this.cr(e)}Er(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>mk(this.R,e)))};this.cr(t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hA extends class{}{constructor(e,t,n){super(),this.credentials=e,this.Hi=t,this.R=n,this.Rr=!1}Pr(){if(this.Rr)throw new lE(uE.FAILED_PRECONDITION,"The client has already been terminated.")}Ni(e,t,n){return this.Pr(),this.credentials.getToken().then((r=>this.Hi.Ni(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===uE.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new lE(uE.UNKNOWN,e.toString())}))}Oi(e,t,n){return this.Pr(),this.credentials.getToken().then((r=>this.Hi.Oi(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===uE.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new lE(uE.UNKNOWN,e.toString())}))}terminate(){this.Rr=!0}}class dA{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.br=0,this.vr=null,this.Vr=!0}Sr(){0===this.br&&(this.Dr("Unknown"),this.vr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.vr=null,this.Cr("Backend didn't respond within 10 seconds."),this.Dr("Offline"),Promise.resolve()))))}Nr(e){"Online"===this.state?this.Dr("Unknown"):(this.br++,this.br>=1&&(this.kr(),this.Cr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Dr("Offline")))}set(e){this.kr(),this.br=0,"Online"===e&&(this.Vr=!1),this.Dr(e)}Dr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Cr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Vr?(pE(t),this.Vr=!1):fE("OnlineStateTracker",t)}kr(){null!==this.vr&&(this.vr.cancel(),this.vr=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class fA{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.$r=[],this.Or=new Map,this.Mr=new Set,this.Fr=[],this.Lr=i,this.Lr.di((e=>{n.enqueueAndForget((async()=>{IA(this)&&(fE("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=vE(e);t.Mr.add(4),await gA(t),t.Br.set("Unknown"),t.Mr.delete(4),await pA(t)}(this))}))})),this.Br=new dA(n,r)}}async function pA(e){if(IA(e))for(const t of e.Fr)await t(!0)}async function gA(e){for(const t of e.Fr)await t(!1)}function mA(e,t){const n=vE(e);n.Or.has(t.targetId)||(n.Or.set(t.targetId,t),bA(n)?wA(n):qA(n).er()&&yA(n,t))}function _A(e,t){const n=vE(e),r=qA(n);n.Or.delete(t),r.er()&&vA(n,t),0===n.Or.size&&(r.er()?r.ir():IA(n)&&n.Br.set("Unknown"))}function yA(e,t){e.Ur.q(t.targetId),qA(e).mr(t)}function vA(e,t){e.Ur.q(t),qA(e).gr(t)}function wA(e){e.Ur=new YC({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.Or.get(t)||null}),qA(e).start(),e.Br.Sr()}function bA(e){return IA(e)&&!qA(e).tr()&&e.Or.size>0}function IA(e){return 0===vE(e).Mr.size}function TA(e){e.Ur=void 0}async function EA(e){e.Or.forEach(((t,n)=>{yA(e,t)}))}async function SA(e,t){TA(e),bA(e)?(e.Br.Nr(t),wA(e)):e.Br.set("Unknown")}async function CA(e,t,n){if(e.Br.set("Online"),t instanceof GC&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Or.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Or.delete(r),e.Ur.removeTarget(r))}(e,t)}catch(n){fE("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await kA(e,n)}else if(t instanceof KC?e.Ur.X(t):t instanceof HC?e.Ur.rt(t):e.Ur.et(t),!n.isEqual(CE.min()))try{const t=await TN(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ur.at(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Or.get(r);i&&e.Or.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.Or.get(t);if(!n)return;e.Or.set(t,n.withResumeToken(LE.EMPTY_BYTE_STRING,n.snapshotVersion)),vA(e,t);const r=new mR(n.target,t,1,n.sequenceNumber);yA(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){fE("RemoteStore","Failed to raise snapshot:",t),await kA(e,t)}}async function kA(e,t,n){if(!aR(t))throw t;e.Mr.add(1),await gA(e),e.Br.set("Offline"),n||(n=()=>TN(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{fE("RemoteStore","Retrying IndexedDB access"),await n(),e.Mr.delete(1),await pA(e)}))}function RA(e,t){return t().catch((n=>kA(e,n,t)))}async function NA(e){const t=vE(e),n=jA(t);let r=t.$r.length>0?t.$r[t.$r.length-1].batchId:-1;for(;AA(t);)try{const e=await SN(t.localStore,r);if(null===e){0===t.$r.length&&n.ir();break}r=e.batchId,PA(t,e)}catch(e){await kA(t,e)}xA(t)&&DA(t)}function AA(e){return IA(e)&&e.$r.length<10}function PA(e,t){e.$r.push(t);const n=jA(e);n.er()&&n.pr&&n.Er(t.mutations)}function xA(e){return IA(e)&&!jA(e).tr()&&e.$r.length>0}function DA(e){jA(e).start()}async function OA(e){jA(e).Ar()}async function LA(e){const t=jA(e);for(const n of e.$r)t.Er(n.mutations)}async function MA(e,t,n){const r=e.$r.shift(),i=gR.from(r,t,n);await RA(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await NA(e)}async function FA(e,t){t&&jA(e).pr&&await async function(e,t){if(kC(n=t.code)&&n!==uE.ABORTED){const n=e.$r.shift();jA(e).sr(),await RA(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await NA(e)}var n}(e,t),xA(e)&&DA(e)}async function UA(e,t){const n=vE(e);t?(n.Mr.delete(2),await pA(n)):t||(n.Mr.add(2),await gA(n),n.Br.set("Unknown"))}function qA(e){return e.qr||(e.qr=function(e,t,n){const r=vE(e);return r.Pr(),new uA(t,r.Hi,r.credentials,r.R,n)
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}(e.datastore,e.asyncQueue,{Ii:EA.bind(null,e),Ri:SA.bind(null,e),_r:CA.bind(null,e)}),e.Fr.push((async t=>{t?(e.qr.sr(),bA(e)?wA(e):e.Br.set("Unknown")):(await e.qr.stop(),TA(e))}))),e.qr}function jA(e){return e.Kr||(e.Kr=function(e,t,n){const r=vE(e);return r.Pr(),new lA(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:OA.bind(null,e),Ri:FA.bind(null,e),Ir:LA.bind(null,e),Tr:MA.bind(null,e)}),e.Fr.push((async t=>{t?(e.Kr.sr(),await NA(e)):(await e.Kr.stop(),e.$r.length>0&&(fE("RemoteStore",`Stopping write stream with ${e.$r.length} pending writes`),e.$r=[]))}))),e.Kr
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class VA{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new tR,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new VA(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new lE(uE.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function BA(e,t){if(pE("AsyncQueue",`${t}: ${e}`),aR(e))return new lE(uE.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class WA{constructor(e){this.comparator=e?(t,n)=>e(t,n)||KE.comparator(t.key,n.key):(e,t)=>KE.comparator(e.key,t.key),this.keyedMap=FC(),this.sortedSet=new NC(this.comparator)}static emptySet(e){return new WA(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof WA))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new WA;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $A{constructor(){this.Qr=new NC(KE.comparator)}track(e){const t=e.doc.key,n=this.Qr.get(t);n?0!==e.type&&3===n.type?this.Qr=this.Qr.insert(t,e):3===e.type&&1!==n.type?this.Qr=this.Qr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Qr=this.Qr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Qr=this.Qr.remove(t):1===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):_E():this.Qr=this.Qr.insert(t,e)}jr(){const e=[];return this.Qr.inorderTraversal(((t,n)=>{e.push(n)})),e}}class zA{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new zA(e,t,WA.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jS(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class KA{constructor(){this.Wr=void 0,this.listeners=[]}}class HA{constructor(){this.queries=new nN((e=>VS(e)),jS),this.onlineState="Unknown",this.Gr=new Set}}async function GA(e,t){const n=vE(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new KA),i)try{s.Wr=await n.onListen(r)}catch(e){const n=BA(e,`Initialization of query '${BS(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.zr(n.onlineState),s.Wr&&t.Hr(s.Wr)&&XA(n)}async function QA(e,t){const n=vE(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function YA(e,t){const n=vE(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.Hr(e)&&(r=!0);i.Wr=e}}r&&XA(n)}function JA(e,t,n){const r=vE(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function XA(e){e.Gr.forEach((e=>{e.next()}))}class ZA{constructor(e,t,n){this.query=e,this.Jr=t,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}Hr(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new zA(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),t=!0):this.eo(e,this.onlineState)&&(this.no(e),t=!0),this.Xr=e,t}onError(e){this.Jr.error(e)}zr(e){this.onlineState=e;let t=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),t=!0),t}eo(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.so&&n||e.docs.isEmpty()&&"Offline"!==t)}Zr(e){if(e.docChanges.length>0)return!0;const t=this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}no(e){e=zA.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eP{constructor(e,t){this.payload=e,this.byteLength=t}io(){return"metadata"in this.payload}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class tP{constructor(e){this.R=e}Un(e){return uk(this.R,e)}qn(e){return e.metadata.exists?gk(this.R,e.document,!1):cS.newNoDocument(this.Un(e.metadata.name),this.Kn(e.metadata.readTime))}Kn(e){return sk(e)}}class nP{constructor(e,t,n){this.ro=e,this.localStore=t,this.R=n,this.queries=[],this.documents=[],this.progress=rP(e)}oo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}co(e){const t=new Map,n=new tP(this.R);for(const r of e)if(r.metadata.queries){const e=n.Un(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||VC()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=vE(e);let s=VC(),o=LC(),a=qC();for(const e of n){const n=t.Un(e.metadata.name);e.document&&(s=s.add(n)),o=o.insert(n,t.qn(e)),a=a.insert(n,t.Kn(e.metadata.readTime))}const c=i.Mn.newChangeBuffer({trackRemovals:!0}),u=await CN(i,function(e){return US(PS(PE.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>EN(e,c,o,CE.min(),a).next((t=>(c.apply(e),t))).next((t=>i.Ue.removeMatchingKeysForTargetId(e,u.targetId).next((()=>i.Ue.addMatchingKeys(e,s,u.targetId))).next((()=>i.Fn.En(e,t))).next((()=>t))))))}(this.localStore,new tP(this.R),this.documents,this.ro.id),t=this.co(this.documents);for(const e of this.queries)await PN(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",new mN(Object.assign({},this.progress),e)}}function rP(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class iP{constructor(e){this.key=e}}class sP{constructor(e){this.key=e}}class oP{constructor(e,t){this.query=e,this.ao=t,this.uo=null,this.current=!1,this.ho=VC(),this.mutatedKeys=VC(),this.lo=$S(e),this.fo=new WA(this.lo)}get wo(){return this.ao}_o(e,t){const n=t?t.mo:new $A,r=t?t.fo:this.fo;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a=xS(this.query)&&r.size===this.query.limit?r.last():null,c=DS(this.query)&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=WS(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.yo(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.lo(l,a)>0||c&&this.lo(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),xS(this.query)||DS(this.query))for(;s.size>this.query.limit;){const e=xS(this.query)?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{fo:s,mo:n,Nn:o,mutatedKeys:i}}yo(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;const i=e.mo.jr();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _E()}};return n(e)-n(t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.type,t.type)||this.lo(e.doc,t.doc))),this.po(n);const s=t?this.Eo():[],o=0===this.ho.size&&this.current?1:0,a=o!==this.uo;return this.uo=o,0!==i.length||a?{snapshot:new zA(this.query,e.fo,r,i,e.mutatedKeys,0===o,a,!1),To:s}:{To:s}}zr(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({fo:this.fo,mo:new $A,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}}Io(e){return!this.ao.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations}po(e){e&&(e.addedDocuments.forEach((e=>this.ao=this.ao.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ao=this.ao.delete(e))),this.current=e.current)}Eo(){if(!this.current)return[];const e=this.ho;this.ho=VC(),this.fo.forEach((e=>{this.Io(e.key)&&(this.ho=this.ho.add(e.key))}));const t=[];return e.forEach((e=>{this.ho.has(e)||t.push(new sP(e))})),this.ho.forEach((n=>{e.has(n)||t.push(new iP(n))})),t}Ao(e){this.ao=e.Bn,this.ho=VC();const t=this._o(e.documents);return this.applyChanges(t,!0)}Ro(){return zA.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.uo)}}class aP{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class cP{constructor(e){this.key=e,this.Po=!1}}class uP{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.bo={},this.vo=new nN((e=>VS(e)),jS),this.Vo=new Map,this.So=new Set,this.Do=new NC(KE.comparator),this.Co=new Map,this.No=new DN,this.xo={},this.ko=new Map,this.$o=$R.Yt(),this.onlineState="Unknown",this.Oo=void 0}get isPrimaryClient(){return!0===this.Oo}}async function lP(e,t){const n=MP(e);let r,i;const s=n.vo.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ro();else{const e=await CN(n.localStore,US(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await hP(n,t,r,"current"===s),n.isPrimaryClient&&mA(n.remoteStore,e)}return i}async function hP(e,t,n,r){e.Mo=(t,n,r)=>async function(e,t,n,r){let i=t.view._o(n);i.Nn&&(i=await RN(e.localStore,t.query,!1).then((({documents:e})=>t.view._o(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return IP(e,t.targetId,o.To),o.snapshot}(e,t,n,r);const i=await RN(e.localStore,t,!0),s=new oP(t,i.Bn),o=s._o(i.documents),a=zC.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);IP(e,n,c.To);const u=new aP(t,n,s);return e.vo.set(t,u),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),c.snapshot}async function dP(e,t){const n=vE(e),r=n.vo.get(t),i=n.Vo.get(r.targetId);if(i.length>1)return n.Vo.set(r.targetId,i.filter((e=>!jS(e,t)))),void n.vo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await kN(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),_A(n.remoteStore,r.targetId),wP(n,r.targetId)})).catch(QR)):(wP(n,r.targetId),await kN(n.localStore,r.targetId,!0))}async function fP(e,t){const n=vE(e);try{const e=await function(e,t){const n=vE(e),r=t.snapshotVersion;let i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Mn.newChangeBuffer({trackRemovals:!0});i=n.kn;const o=[];t.targetChanges.forEach(((t,s)=>{const a=i.get(s);if(!a)return;o.push(n.Ue.removeMatchingKeys(e,t.removedDocuments,s).next((()=>n.Ue.addMatchingKeys(e,t.addedDocuments,s))));const c=t.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(s,u),function(e,t,n){return yE(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,u,t)&&o.push(n.Ue.updateTargetData(e,u))}}));let a=LC();if(t.documentUpdates.forEach(((r,i)=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(EN(e,s,t.documentUpdates,r,void 0).next((e=>{a=e}))),!r.isEqual(CE.min())){const t=n.Ue.getLastRemoteSnapshotVersion(e).next((t=>n.Ue.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return nR.waitFor(o).next((()=>s.apply(e))).next((()=>n.Fn.En(e,a))).next((()=>a))})).then((e=>(n.kn=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Co.get(t);r&&(yE(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Po=!0:e.modifiedDocuments.size>0?yE(r.Po):e.removedDocuments.size>0&&(yE(r.Po),r.Po=!1))})),await SP(n,e,t)}catch(e){await QR(e)}}function pP(e,t,n){const r=vE(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.vo.forEach(((n,r)=>{const i=r.view.zr(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=vE(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.zr(t)&&(r=!0)})),r&&XA(n)}(r.eventManager,t),e.length&&r.bo._r(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function gP(e,t,n){const r=vE(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Co.get(t),s=i&&i.key;if(s){let e=new NC(KE.comparator);e=e.insert(s,cS.newNoDocument(s,CE.min()));const n=VC().add(s),i=new $C(CE.min(),new Map,new xC(IE),e,n);await fP(r,i),r.Do=r.Do.remove(s),r.Co.delete(t),EP(r)}else await kN(r.localStore,t,!1).then((()=>wP(r,t,n))).catch(QR)}async function mP(e,t){const n=vE(e),r=t.batch.batchId;try{const e=await function(e,t){const n=vE(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Mn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=nR.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);yE(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))}))})),o.next((()=>e._n.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n._n.performConsistencyCheck(e))).next((()=>n.Fn.pn(e,r)))}))}(n.localStore,t);vP(n,r,null),yP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await SP(n,e)}catch(e){await QR(e)}}async function _P(e,t,n){const r=vE(e);try{const e=await function(e,t){const n=vE(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n._n.lookupMutationBatch(e,t).next((t=>(yE(null!==t),r=t.keys(),n._n.removeMutationBatch(e,t)))).next((()=>n._n.performConsistencyCheck(e))).next((()=>n.Fn.pn(e,r)))}))}(r.localStore,t);vP(r,t,n),yP(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await SP(r,e)}catch(n){await QR(n)}}function yP(e,t){(e.ko.get(t)||[]).forEach((e=>{e.resolve()})),e.ko.delete(t)}function vP(e,t,n){const r=vE(e);let i=r.xo[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function wP(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Vo.get(t))e.vo.delete(r),n&&e.bo.Fo(r,n);e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach((t=>{e.No.containsKey(t)||bP(e,t)}))}function bP(e,t){e.So.delete(t.path.canonicalString());const n=e.Do.get(t);null!==n&&(_A(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),EP(e))}function IP(e,t,n){for(const r of n)r instanceof iP?(e.No.addReference(r.key,t),TP(e,r)):r instanceof sP?(fE("SyncEngine","Document no longer in limbo: "+r.key),e.No.removeReference(r.key,t),e.No.containsKey(r.key)||bP(e,r.key)):_E()}function TP(e,t){const n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(fE("SyncEngine","New document in limbo: "+n),e.So.add(r),EP(e))}function EP(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){const t=e.So.values().next().value;e.So.delete(t);const n=new KE(PE.fromString(t)),r=e.$o.next();e.Co.set(r,new cP(n)),e.Do=e.Do.insert(n,r),mA(e.remoteStore,new mR(US(PS(n.path)),r,2,cE.o))}}async function SP(e,t,n){const r=vE(e),i=[],s=[],o=[];r.vo.isEmpty()||(r.vo.forEach(((e,a)=>{o.push(r.Mo(a,t,n).then((e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=yN.vn(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.bo._r(i),await async function(e,t){const n=vE(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>nR.forEach(t,(t=>nR.forEach(t.Pn,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>nR.forEach(t.bn,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!aR(e))throw e;fE("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.kn.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.kn=n.kn.insert(t,i)}}}(r.localStore,s))}async function CP(e,t){const n=vE(e);if(!n.currentUser.isEqual(t)){fE("SyncEngine","User change. New user:",t.toKey());const e=await IN(n.localStore,t);n.currentUser=t,function(e,t){e.ko.forEach((e=>{e.forEach((e=>{e.reject(new lE(uE.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.ko.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await SP(n,e.Ln)}}function kP(e,t){const n=vE(e),r=n.Co.get(t);if(r&&r.Po)return VC().add(r.key);{let e=VC();const r=n.Vo.get(t);if(!r)return e;for(const t of r){const r=n.vo.get(t);e=e.unionWith(r.view.wo)}return e}}async function RP(e,t){const n=vE(e),r=await RN(n.localStore,t.query,!0),i=t.view.Ao(r);return n.isPrimaryClient&&IP(n,t.targetId,i.To),i}async function NP(e){const t=vE(e);return AN(t.localStore).then((e=>SP(t,e)))}async function AP(e,t,n,r){const i=vE(e),s=await function(e,t){const n=vE(e),r=vE(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.jt(e,t).next((t=>t?n.Fn.pn(e,t):nR.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await NA(i.remoteStore):"acknowledged"===n||"rejected"===n?(vP(i,t,r||null),yP(i,t),function(e,t){vE(vE(e)._n).Gt(t)}(i.localStore,t)):_E(),await SP(i,s)):fE("SyncEngine","Cannot apply mutation batch with id: "+t)}async function PP(e,t,n){const r=vE(e),i=[],s=[];for(const e of t){let t;const n=r.Vo.get(e);if(n&&0!==n.length){t=await CN(r.localStore,US(n[0]));for(const e of n){const t=r.vo.get(e),n=await RP(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await NN(r.localStore,e);t=await CN(r.localStore,n),await hP(r,xP(n),e,!1)}i.push(t)}return r.bo._r(s),i}function xP(e){return AS(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function DP(e){const t=vE(e);return vE(vE(t.localStore).persistence).fn()}async function OP(e,t,n,r){const i=vE(e);if(i.Oo)fE("SyncEngine","Ignoring unexpected query state notification.");else if(i.Vo.has(t))switch(n){case"current":case"not-current":{const e=await AN(i.localStore),r=$C.createSynthesizedRemoteEventForCurrentChange(t,"current"===n);await SP(i,e,r);break}case"rejected":await kN(i.localStore,t,!0),wP(i,t,r);break;default:_E()}}async function LP(e,t,n){const r=MP(e);if(r.Oo){for(const e of t){if(r.Vo.has(e)){fE("SyncEngine","Adding an already active target "+e);continue}const t=await NN(r.localStore,e),n=await CN(r.localStore,t);await hP(r,xP(t),n.targetId,!1),mA(r.remoteStore,n)}for(const e of n)r.Vo.has(e)&&await kN(r.localStore,e,!1).then((()=>{_A(r.remoteStore,e),wP(r,e)})).catch(QR)}}function MP(e){const t=vE(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=fP.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=kP.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=gP.bind(null,t),t.bo._r=YA.bind(null,t.eventManager),t.bo.Fo=JA.bind(null,t.eventManager),t}function FP(e){const t=vE(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=mP.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=_P.bind(null,t),t}class UP{constructor(){this.synchronizeTabs=!1}async initialize(e){this.R=oA(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.Uo(e),await this.persistence.start(),this.gcScheduler=this.qo(e),this.localStore=this.Ko(e)}qo(e){return null}Ko(e){return bN(this.persistence,new vN,e.initialUser,this.R)}Uo(e){return new qN(VN.Ps,this.R)}Bo(e){return new XN}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class qP extends UP{constructor(e,t,n){super(),this.Qo=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await async function(e){const t=vE(e);return t.persistence.runTransaction("Synchronize last document change read time","readonly",(e=>function(e){const t=aN(e);let n=CE.min();return t.Ot({index:Wk.readTimeIndex,reverse:!0},((e,t,r)=>{t.readTime&&(n=bR(t.readTime)),r.done()})).next((()=>n))}(e))).then((e=>{t.On=e}))}(this.localStore),await this.Qo.initialize(this,e),await FP(this.Qo.syncEngine),await NA(this.Qo.remoteStore)}Ko(e){return bN(this.persistence,new vN,e.initialUser,this.R)}qo(e){const t=this.persistence.referenceDelegate.garbageCollector;return new XR(t,e.asyncQueue)}Uo(e){const t=gN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?MR.withCacheSize(this.cacheSizeBytes):MR.DEFAULT;return new dN(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,iA(),sA(),this.R,this.sharedClientState,!!this.forceOwnership)}Bo(e){return new XN}}class jP extends qP{constructor(e,t){super(e,t,!1),this.Qo=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Qo.syncEngine;this.sharedClientState instanceof JN&&(this.sharedClientState.syncEngine={ai:AP.bind(null,t),ui:OP.bind(null,t),hi:LP.bind(null,t),fn:DP.bind(null,t),ci:NP.bind(null,t)},await this.sharedClientState.start()),await this.persistence.He((async e=>{await async function(e,t){const n=vE(e);if(MP(n),FP(n),!0===t&&!0!==n.Oo){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await PP(n,e.toArray());n.Oo=!0,await UA(n.remoteStore,!0);for(const e of t)mA(n.remoteStore,e)}else if(!1===t&&!1!==n.Oo){const e=[];let t=Promise.resolve();n.Vo.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(wP(n,i),kN(n.localStore,i,!0)))),_A(n.remoteStore,i)})),await t,await PP(n,e),function(e){const t=vE(e);t.Co.forEach(((e,n)=>{_A(t.remoteStore,n)})),t.No.ts(),t.Co=new Map,t.Do=new NC(KE.comparator)}(n),n.Oo=!1,await UA(n.remoteStore,!1)}}(this.Qo.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop())}))}Bo(e){const t=iA();if(!JN.gt(t))throw new lE(uE.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=gN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new JN(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class VP{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>pP(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=CP.bind(null,this.syncEngine),await UA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new HA}createDatastore(e){const t=oA(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new rA(r));var r;return function(e,t,n){return new hA(e,t,n)}(e.credentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>pP(this.syncEngine,e,0),s=eA.gt()?new eA:new ZN,new fA(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new uP(e,t,n,r,i,s);return o&&(a.Oo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=vE(e);fE("RemoteStore","RemoteStore shutting down."),t.Mr.add(5),await gA(t),t.Lr.shutdown(),t.Br.set("Unknown")}(this.remoteStore)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function BP(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class WP{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.jo(this.observer.next,e)}error(e){this.observer.error?this.jo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Wo(){this.muted=!0}jo(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $P{constructor(e,t){this.Go=e,this.R=t,this.metadata=new tR,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((e=>{e&&e.io()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.payload)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Go.cancel()}async getMetadata(){return this.metadata.promise}async Lo(){return await this.getMetadata(),this.Ho()}async Ho(){const e=await this.Jo();if(null===e)return null;const t=this.zo.decode(e),n=Number(t);isNaN(n)&&this.Yo(`length string (${t}) is not valid number`);const r=await this.Xo(n);return new eP(JSON.parse(r),e.length+n)}Zo(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Jo(){for(;this.Zo()<0&&!await this.tc(););if(0===this.buffer.length)return null;const e=this.Zo();e<0&&this.Yo("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Xo(e){for(;this.buffer.length<e;)await this.tc()&&this.Yo("Reached the end of bundle when more is expected.");const t=this.zo.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Yo(e){throw this.Go.cancel(),new Error(`Invalid bundle format: ${e}`)}async tc(){const e=await this.Go.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zP{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new lE(uE.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=vE(e),r=dk(n.R)+"/documents",i={documents:t.map((e=>ck(n.R,e)))},s=await n.Oi("BatchGetDocuments",r,i),o=new Map;s.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){yE(!!t.found),t.found.name,t.found.updateTime;const n=uk(e,t.found.name),r=sk(t.found.updateTime),i=new oS({mapValue:{fields:t.found.fields}});return cS.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){yE(!!t.missing),yE(!!t.readTime);const n=uk(e,t.missing),r=sk(t.readTime);return cS.newNoDocument(n,r)}(e,t):_E()}(n.R,e);o.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=o.get(e.toString());yE(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new IC(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=KE.fromPath(t);this.mutations.push(new TC(n,this.precondition(n)))})),await async function(e,t){const n=vE(e),r=dk(n.R)+"/documents",i={writes:t.map((e=>mk(n.R,e)))};await n.Ni("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw _E();t=CE.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new lE(uE.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?uC.updateTime(t):uC.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(CE.min()))throw new lE(uE.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return uC.updateTime(t)}return uC.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class KP{constructor(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new aA(this.asyncQueue,"transaction_retry")}run(){this.nc()}nc(){this.Zi.ji((async()=>{const e=new zP(this.datastore),t=this.sc(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.ic(e)}))))})).catch((e=>{this.ic(e)}))}))}sc(e){try{const t=this.updateFunction(e);return!WE(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ic(e){this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget((()=>(this.nc(),Promise.resolve())))):this.deferred.reject(e)}rc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!kC(t)}return!1}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class HP{constructor(e,t,n){this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=BN.UNAUTHENTICATED,this.clientId=bE.u(),this.credentialListener=()=>Promise.resolve(),this.credentials.setChangeListener(t,(async e=>{fE("FirestoreClient","Received user=",e.uid),await this.credentialListener(e),this.user=e}))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new lE(uE.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new tR;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.removeChangeListener(),e.resolve()}catch(t){const n=BA(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function GP(e,t){e.asyncQueue.verifyOperationInProgress(),fE("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await IN(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}async function QP(e,t){e.asyncQueue.verifyOperationInProgress();const n=await YP(e);fE("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>async function(e,t){const n=vE(e);n.asyncQueue.verifyOperationInProgress(),fE("RemoteStore","RemoteStore received new credentials");const r=IA(n);n.Mr.add(3),await gA(n),r&&n.Br.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Mr.delete(3),await pA(n)}(t.remoteStore,e))),e.onlineComponents=t}async function YP(e){return e.offlineComponents||(fE("FirestoreClient","Using default OfflineComponentProvider"),await GP(e,new UP)),e.offlineComponents}async function JP(e){return e.onlineComponents||(fE("FirestoreClient","Using default OnlineComponentProvider"),await QP(e,new VP)),e.onlineComponents}function XP(e){return YP(e).then((e=>e.persistence))}function ZP(e){return YP(e).then((e=>e.localStore))}function ex(e){return JP(e).then((e=>e.remoteStore))}function tx(e){return JP(e).then((e=>e.syncEngine))}async function nx(e){const t=await JP(e),n=t.eventManager;return n.onListen=lP.bind(null,t.syncEngine),n.onUnlisten=dP.bind(null,t.syncEngine),n}function rx(e,t,n={}){const r=new tR;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new WP({next:s=>{t.enqueueAndForget((()=>QA(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new lE(uE.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new lE(uE.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new ZA(PS(n.path),s,{includeMetadataChanges:!0,so:!0});return GA(e,o)}(await nx(e),e.asyncQueue,t,n,r))),r.promise}function ix(e,t,n={}){const r=new tR;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new WP({next:n=>{t.enqueueAndForget((()=>QA(e,o))),n.fromCache&&"server"===r.source?i.reject(new lE(uE.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new ZA(n,s,{includeMetadataChanges:!0,so:!0});return GA(e,o)}(await nx(e),e.asyncQueue,t,n,r))),r.promise}function sx(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?(new TextEncoder).encode(e):e,function(e,t){return new $P(e,t)}(function(e,t){if(e instanceof Uint8Array)return BP(e,t);if(e instanceof ArrayBuffer)return BP(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,oA(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=vE(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=vE(e),r=sk(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Ke.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),void n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r));n._updateProgress(rP(r));const i=new nP(r,e.localStore,t.R);let s=await t.Lo();for(;s;){const e=await i.oo(s);e&&n._updateProgress(e),s=await t.Lo()}const o=await i.complete();await SP(e,o.wn,void 0),await function(e,t){const n=vE(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Ke.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress)}catch(e){gE("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */)(r,t,n).then((()=>{r.sharedClientState.notifyBundleLoaded()}))}(await tx(e),i,r)}))}class ox{constructor(e,t,n,r,i,s,o){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o}}class ax{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ax&&e.projectId===this.projectId&&e.database===this.database}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const cx=new Map;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ux{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}}class lx{constructor(){this.changeListener=null}getToken(){return Promise.resolve(null)}invalidateToken(){}setChangeListener(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(BN.UNAUTHENTICATED)))}removeChangeListener(){this.changeListener=null}}class hx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}setChangeListener(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}removeChangeListener(){this.changeListener=null}}class dx{constructor(e){this.currentUser=BN.UNAUTHENTICATED,this.oc=new tR,this.cc=0,this.changeListener=()=>Promise.resolve(),this.ac=!1,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=()=>{this.cc++,this.currentUser=this.hc(),this.oc.resolve(),this.ac&&this.asyncQueue.enqueueRetryable((()=>this.changeListener(this.currentUser)))};const t=e=>{fE("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.lc(),this.auth.addAuthTokenListener(this.uc)};e.onInit((e=>t(e))),setTimeout((()=>{if(!this.auth){const n=e.getImmediate({optional:!0});n?t(n):this.ac&&(fE("FirebaseCredentialsProvider","Auth not yet detected"),this.asyncQueue.enqueueRetryable((()=>this.changeListener(this.currentUser))))}}),0)}getToken(){const e=this.cc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.cc!==e?(fE("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(yE("string"==typeof t.accessToken),new ux(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}setChangeListener(e,t){this.ac=!0,this.asyncQueue=e,this.changeListener=t}removeChangeListener(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=()=>Promise.resolve()}hc(){const e=this.auth&&this.auth.getUid();return yE(null===e||"string"==typeof e),new BN(e)}lc(){this.ac&&(this.ac=!1,this.asyncQueue.enqueueRetryable((async()=>{await this.oc.promise,await this.changeListener(this.currentUser),this.ac=!0})))}}class fx{constructor(e,t,n){this.fc=e,this.dc=t,this.wc=n,this.type="FirstParty",this.user=BN.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.dc},t=this.fc.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.wc&&(e["X-Goog-Iam-Authorization-Token"]=this.wc),e}}class px{constructor(e,t,n){this.fc=e,this.dc=t,this.wc=n}getToken(){return Promise.resolve(new fx(this.fc,this.dc,this.wc))}setChangeListener(e,t){e.enqueueRetryable((()=>t(BN.FIRST_PARTY)))}removeChangeListener(){}invalidateToken(){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function gx(e,t,n){if(!n)throw new lE(uE.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function mx(e){if(!KE.isDocumentKey(e))throw new lE(uE.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function _x(e){if(KE.isDocumentKey(e))throw new lE(uE.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function yx(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){if(e.constructor){const t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":_E()}function vx(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new lE(uE.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=yx(e);throw new lE(uE.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function wx(e,t){if(t<=0)throw new lE(uE.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bx{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new lE(uE.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new lE(uE.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,function(e,t,n,r){if(!0===t&&!0===r)throw new lE(uE.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ix{constructor(e,t){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bx({}),this._settingsFrozen=!1,e instanceof ax?(this._databaseId=e,this._credentials=new lx):(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new lE(uE.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ax(e.options.projectId)}(e),this._credentials=new dx(t))}get app(){if(!this._app)throw new lE(uE.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new lE(uE.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bx(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new lx;switch(e.type){case"gapi":const t=e.client;return yE(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new px(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new lE(uE.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=cx.get(e);t&&(fE("ComponentProvider","Removing Datastore"),cx.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Tx{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sx(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tx(this.firestore,e,this._key)}}class Ex{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ex(this.firestore,e,this._query)}}class Sx extends Ex{constructor(e,t,n){super(e,t,PS(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tx(this.firestore,null,new KE(e))}withConverter(e){return new Sx(this.firestore,e,this._path)}}function Cx(e,t,...n){if(e=Ia(e),gx("collection","path",t),e instanceof Ix){const r=PE.fromString(t,...n);return _x(r),new Sx(e,null,r)}{if(!(e instanceof Tx||e instanceof Sx))throw new lE(uE.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=PE.fromString(e.path,...n).child(PE.fromString(t));return _x(r),new Sx(e.firestore,null,r)}}function kx(e,t,...n){if(e=Ia(e),1===arguments.length&&(t=bE.u()),gx("doc","path",t),e instanceof Ix){const r=PE.fromString(t,...n);return mx(r),new Tx(e,null,new KE(r))}{if(!(e instanceof Tx||e instanceof Sx))throw new lE(uE.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(PE.fromString(t,...n));return mx(r),new Tx(e.firestore,e instanceof Sx?e.converter:null,new KE(r))}}function Rx(e,t){return e=Ia(e),t=Ia(t),(e instanceof Tx||e instanceof Sx)&&(t instanceof Tx||t instanceof Sx)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Nx(e,t){return e=Ia(e),t=Ia(t),e instanceof Ex&&t instanceof Ex&&e.firestore===t.firestore&&jS(e._query,t._query)&&e.converter===t.converter
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class Ax{constructor(){this._c=Promise.resolve(),this.mc=[],this.gc=!1,this.yc=[],this.Ec=null,this.Tc=!1,this.Ic=[],this.Zi=new aA(this,"async_queue_retry"),this.Ac=()=>{const e=sA();e&&fE("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Zi.Gi()};const e=sA();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ac)}get isShuttingDown(){return this.gc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Rc(),this.Pc(e)}enterRestrictedMode(){if(!this.gc){this.gc=!0;const e=sA();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ac)}}enqueue(e){return this.Rc(),this.gc?new Promise((e=>{})):this.Pc(e)}enqueueRetryable(e){this.enqueueAndForget((()=>(this.mc.push(e),this.bc())))}async bc(){if(0!==this.mc.length){try{await this.mc[0](),this.mc.shift(),this.Zi.reset()}catch(e){if(!aR(e))throw e;fE("AsyncQueue","Operation failed with retryable error: "+e)}this.mc.length>0&&this.Zi.ji((()=>this.bc()))}}Pc(e){const t=this._c.then((()=>(this.Tc=!0,e().catch((e=>{throw this.Ec=e,this.Tc=!1,pE("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)),e})).then((e=>(this.Tc=!1,e))))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.Rc(),this.Ic.indexOf(e)>-1&&(t=0);const r=VA.createAndSchedule(this,e,t,n,(e=>this.vc(e)));return this.yc.push(r),r}Rc(){this.Ec&&_E()}verifyOperationInProgress(){}async Vc(){let e;do{e=this._c,await e}while(e!==this._c)}Sc(e){for(const t of this.yc)if(t.timerId===e)return!0;return!1}Dc(e){return this.Vc().then((()=>{this.yc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.yc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Vc()}))}Cc(e){this.Ic.push(e)}vc(e){const t=this.yc.indexOf(e);this.yc.splice(t,1)}}function Px(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}class xx{constructor(){this._progressObserver={},this._taskCompletionResolver=new tR,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Dx extends Ix{constructor(e,t){super(e,t),this.type="firestore",this._queue=new Ax,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Lx(this),this._firestoreClient.terminate()}}function Ox(e){return e._firestoreClient||Lx(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Lx(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new ox(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new HP(e._credentials,e._queue,r)}function Mx(e,t,n){const r=new tR;return e.asyncQueue.enqueue((async()=>{try{await GP(e,n),await QP(e,t),r.resolve()}catch(e){if(!function(e){return"FirebaseError"===e.name?e.code===uE.FAILED_PRECONDITION||e.code===uE.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(e))throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.reject(e)}})).then((()=>r.promise))}function Fx(e){return function(e){const t=new tR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=vE(e);IA(n.remoteStore)||fE("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=vE(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t._n.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.ko.get(e)||[];r.push(t),n.ko.set(e,r)}catch(e){const n=BA(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await tx(e),t))),t.promise}(Ox(e=vx(e,Dx)))}function Ux(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await XP(e),n=await ex(e);return t.setNetworkEnabled(!0),function(e){const t=vE(e);return t.Mr.delete(0),pA(t)}(n)}))}(Ox(e=vx(e,Dx)))}function qx(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await XP(e),n=await ex(e);return t.setNetworkEnabled(!1),async function(e){const t=vE(e);t.Mr.add(0),await gA(t),t.Br.set("Offline")}(n)}))}(Ox(e=vx(e,Dx)))}function jx(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=vE(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Ke.getNamedQuery(e,t)))}(await ZP(e),t)))}(Ox(e=vx(e,Dx)),t).then((t=>t?new Ex(e,null,t.query):null))}function Vx(e){if(e._initialized||e._terminated)throw new lE(uE.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Bx{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new lE(uE.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new DE(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Wx{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wx(LE.fromBase64String(e))}catch(e){throw new lE(uE.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Wx(LE.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $x{constructor(e){this._methodName=e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zx{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new lE(uE.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new lE(uE.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return IE(this._lat,e._lat)||IE(this._long,e._long)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Kx=/^__.*__$/;class Hx{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new yC(e,this.data,this.fieldMask,t,this.fieldTransforms):new _C(e,this.data,t,this.fieldTransforms)}}class Gx{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new yC(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Qx(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _E()}}class Yx{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get xc(){return this.settings.xc}kc(e){return new Yx(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}$c(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.kc({path:n,Oc:!1});return r.Mc(e),r}Fc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.kc({path:n,Oc:!1});return r.Nc(),r}Lc(e){return this.kc({path:void 0,Oc:!0})}Bc(e){return mD(e,this.settings.methodName,this.settings.Uc||!1,this.path,this.settings.qc)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Nc(){if(this.path)for(let e=0;e<this.path.length;e++)this.Mc(this.path.get(e))}Mc(e){if(0===e.length)throw this.Bc("Document fields must not be empty");if(Qx(this.xc)&&Kx.test(e))throw this.Bc('Document fields cannot begin and end with "__"')}}class Jx{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.R=n||oA(e)}Kc(e,t,n,r=!1){return new Yx({xc:e,methodName:t,qc:n,path:DE.emptyPath(),Oc:!1,Uc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)}}function Xx(e){const t=e._freezeSettings(),n=oA(e._databaseId);return new Jx(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Zx(e,t,n,r,i,s={}){const o=e.Kc(s.merge||s.mergeFields?2:0,t,n,i);dD("Data must be an object, but it was:",o,r);const a=lD(r,o);let c,u;if(s.merge)c=new OE(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=fD(t,r,n);if(!o.contains(i))throw new lE(uE.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);_D(e,i)||e.push(i)}c=new OE(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Hx(new oS(a),c,u)}class eD extends $x{_toFieldTransform(e){if(2!==e.xc)throw 1===e.xc?e.Bc(`${this._methodName}() can only appear at the top level of your update data`):e.Bc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof eD}}function tD(e,t,n){return new Yx({xc:3,qc:t.settings.qc,methodName:e._methodName,Oc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}class nD extends $x{_toFieldTransform(e){return new aC(e.path,new ZS)}isEqual(e){return e instanceof nD}}class rD extends $x{constructor(e,t){super(e),this.Qc=t}_toFieldTransform(e){const t=tD(this,e,!0),n=this.Qc.map((e=>uD(e,t))),r=new eC(n);return new aC(e.path,r)}isEqual(e){return this===e}}class iD extends $x{constructor(e,t){super(e),this.Qc=t}_toFieldTransform(e){const t=tD(this,e,!0),n=this.Qc.map((e=>uD(e,t))),r=new nC(n);return new aC(e.path,r)}isEqual(e){return this===e}}class sD extends $x{constructor(e,t){super(e),this.jc=t}_toFieldTransform(e){const t=new iC(e.R,GS(e.R,this.jc));return new aC(e.path,t)}isEqual(e){return this===e}}function oD(e,t,n,r){const i=e.Kc(1,t,n);dD("Data must be an object, but it was:",i,r);const s=[],o=oS.empty();RE(r,((e,r)=>{const a=gD(t,e,n);r=Ia(r);const c=i.Fc(a);if(r instanceof eD)s.push(a);else{const e=uD(r,c);null!=e&&(s.push(a),o.set(a,e))}}));const a=new OE(s);return new Gx(o,a,i.fieldTransforms)}function aD(e,t,n,r,i,s){const o=e.Kc(1,t,n),a=[fD(t,r,n)],c=[i];if(s.length%2!=0)throw new lE(uE.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(fD(t,s[e])),c.push(s[e+1]);const u=[],l=oS.empty();for(let e=a.length-1;e>=0;--e)if(!_D(u,a[e])){const t=a[e];let n=c[e];n=Ia(n);const r=o.Fc(t);if(n instanceof eD)u.push(t);else{const e=uD(n,r);null!=e&&(u.push(t),l.set(t,e))}}const h=new OE(u);return new Gx(l,h,o.fieldTransforms)}function cD(e,t,n,r=!1){return uD(n,e.Kc(r?4:3,t))}function uD(e,t){if(hD(e=Ia(e)))return dD("Unsupported field value:",t,e),lD(e,t);if(e instanceof $x)return function(e,t){if(!Qx(t.xc))throw t.Bc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Oc&&4!==t.xc)throw t.Bc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=uD(i,t.Lc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Ia(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return GS(t.R,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=SE.fromDate(e);return{timestampValue:nk(t.R,n)}}if(e instanceof SE){const n=new SE(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:nk(t.R,n)}}if(e instanceof zx)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Wx)return{bytesValue:rk(t.R,e._byteString)};if(e instanceof Tx){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ok(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Bc(`Unsupported field value: ${yx(e)}`)}(e,t)}function lD(e,t){const n={};return NE(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):RE(e,((e,r)=>{const i=uD(r,t.$c(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function hD(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof SE||e instanceof zx||e instanceof Wx||e instanceof Tx||e instanceof $x)}function dD(e,t,n){if(!hD(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=yx(n);throw"an object"===r?t.Bc(e+" a custom object"):t.Bc(e+" "+r)}}function fD(e,t,n){if((t=Ia(t))instanceof Bx)return t._internalPath;if("string"==typeof t)return gD(e,t);throw mD("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}const pD=new RegExp("[~\\*/\\[\\]]");function gD(e,t,n){if(t.search(pD)>=0)throw mD(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Bx(...t.split("."))._internalPath}catch(r){throw mD(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function mD(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new lE(uE.INVALID_ARGUMENT,a+e+c)}function _D(e,t){return e.some((e=>e.isEqual(t)))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yD{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Tx(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new vD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.toProto())}}get(e){if(this._document){const t=this._document.data.field(wD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class vD extends yD{data(){return super.data()}}function wD(e,t){return"string"==typeof t?gD(e,t):t instanceof Bx?t._internalPath:t._delegate._internalPath}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bD{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ID extends yD{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new TD(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.toProto(),e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(wD("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class TD extends ID{data(e={}){return super.data(e)}}class ED{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new bD(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new TD(this._firestore,this._userDataWriter,n.key,n,new bD(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new lE(uE.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t,n=0;return e._snapshot.docChanges.map((r=>{const i=new TD(e._firestore,e._userDataWriter,r.doc.key,r.doc,new bD(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return t=r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:n++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new TD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new bD(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:SD(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function SD(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _E()}}function CD(e,t){return e instanceof ID&&t instanceof ID?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof ED&&t instanceof ED&&e._firestore===t._firestore&&Nx(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function kD(e){if(DS(e)&&0===e.explicitOrderBy.length)throw new lE(uE.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class RD{}function ND(e,...t){for(const n of t)e=n._apply(e);return e}class AD extends RD{constructor(e,t,n){super(),this.Wc=e,this.Gc=t,this.zc=n,this.type="where"}_apply(e){const t=Xx(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new lE(uE.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){FD(o,s);const t=[];for(const n of o)t.push(MD(r,e,n));a={arrayValue:{values:t}}}else a=MD(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||FD(o,s),a=cD(n,"where",o,"in"===s||"not-in"===s);const c=pS.create(i,s,a);return function(e,t){if(t.g()){const n=LS(e);if(null!==n&&!n.isEqual(t.field))throw new lE(uE.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=OS(e);null!==r&&UD(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new lE(uE.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new lE(uE.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.Wc,this.Gc,this.zc);return new Ex(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new NS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}class PD extends RD{constructor(e,t){super(),this.Wc=e,this.Hc=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new lE(uE.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new lE(uE.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new SS(t,n);return function(e,t){if(null===OS(e)){const n=LS(e);null!==n&&UD(e,n,t.field)}}(e,r),r}(e._query,this.Wc,this.Hc);return new Ex(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new NS(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class xD extends RD{constructor(e,t,n){super(),this.type=e,this.Jc=t,this.Yc=n}_apply(e){return new Ex(e.firestore,e.converter,qS(e._query,this.Jc,this.Yc))}}class DD extends RD{constructor(e,t,n){super(),this.type=e,this.Xc=t,this.Zc=n}_apply(e){const t=LD(e,this.type,this.Xc,this.Zc);return new Ex(e.firestore,e.converter,function(e,t){return new NS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class OD extends RD{constructor(e,t,n){super(),this.type=e,this.Xc=t,this.Zc=n}_apply(e){const t=LD(e,this.type,this.Xc,this.Zc);return new Ex(e.firestore,e.converter,function(e,t){return new NS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function LD(e,t,n,r){if(n[0]=Ia(n[0]),n[0]instanceof yD)return function(e,t,n,r,i){if(!r)throw new lE(uE.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of FS(e))if(n.field.isKeyField())s.push(eS(t,r.key));else{const e=r.data.field(n.field);if(jE(e))throw new lE(uE.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new lE(uE.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new TS(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=Xx(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new lE(uE.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new lE(uE.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!MS(e)&&-1!==c.indexOf("/"))throw new lE(uE.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(PE.fromString(c));if(!KE.isDocumentKey(n))throw new lE(uE.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new KE(n);a.push(eS(t,i))}else{const e=cD(n,r,c);a.push(e)}}return new TS(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function MD(e,t,n){if("string"==typeof(n=Ia(n))){if(""===n)throw new lE(uE.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!MS(t)&&-1!==n.indexOf("/"))throw new lE(uE.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(PE.fromString(n));if(!KE.isDocumentKey(r))throw new lE(uE.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return eS(e,new KE(r))}if(n instanceof Tx)return eS(e,n._key);throw new lE(uE.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${yx(n)}.`)}function FD(e,t){if(!Array.isArray(e)||0===e.length)throw new lE(uE.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new lE(uE.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function UD(e,t,n){if(!n.isEqual(t))throw new lE(uE.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qD{convertValue(e,t="none"){switch(HE(e)){case 0:return null;case 1:return e.booleanValue;case 2:return UE(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qE(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw _E()}}convertObject(e,t){const n={};return RE(e.fields||{},((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new zx(UE(e.latitude),UE(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=VE(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(BE(e));default:return null}}convertTimestamp(e){const t=FE(e);return new SE(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=PE.fromString(e);yE(Pk(n));const r=new ax(n.get(1),n.get(3)),i=new KE(n.popFirst(5));return r.isEqual(t)||pE(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function jD(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class VD extends qD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wx(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tx(this.firestore,null,t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BD{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xx(e)}set(e,t,n){this._verifyNotCommitted();const r=WD(e,this._firestore),i=jD(r.converter,t,n),s=Zx(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,uC.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=WD(e,this._firestore);let s;return s="string"==typeof(t=Ia(t))||t instanceof Bx?aD(this._dataReader,"WriteBatch.update",i._key,t,n,r):oD(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,uC.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=WD(e,this._firestore);return this._mutations=this._mutations.concat(new IC(t._key,uC.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new lE(uE.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function WD(e,t){if((e=Ia(e)).firestore!==t)throw new lE(uE.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $D extends qD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wx(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tx(this.firestore,null,t)}}function zD(e){e=vx(e,Tx);const t=vx(e.firestore,Dx),n=Ox(t),r=new $D(t);return function(e,t){const n=new tR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=vE(e);return n.persistence.runTransaction("read document","readonly",(e=>n.Fn.mn(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new lE(uE.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=BA(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await ZP(e),t,n))),n.promise}(n,e._key).then((n=>new ID(t,r,e._key,n,new bD(null!==n&&n.hasLocalMutations,!0),e.converter)))}function KD(e){e=vx(e,Ex);const t=vx(e.firestore,Dx),n=Ox(t),r=new $D(t);return function(e,t){const n=new tR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await RN(e,t,!0),i=new oP(t,r.Bn),s=i._o(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=BA(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await ZP(e),t,n))),n.promise}(n,e._query).then((n=>new ED(t,r,e,n)))}function HD(e,t,n,...r){e=vx(e,Tx);const i=vx(e.firestore,Dx),s=Xx(i);let o;return o="string"==typeof(t=Ia(t))||t instanceof Bx?aD(s,"updateDoc",e._key,t,n,r):oD(s,"updateDoc",e._key,t),YD(i,[o.toMutation(e._key,uC.exists(!0))])}function GD(e,...t){var n,r,i;e=Ia(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Px(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Px(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof Tx)u=vx(e.firestore,Dx),l=PS(e._key.path),c={next:n=>{t[o]&&t[o](JD(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=vx(e,Ex);u=vx(n.firestore,Dx),l=n._query;const r=new $D(u);c={next:e=>{t[o]&&t[o](new ED(u,r,n,e))},error:t[o+1],complete:t[o+2]},kD(e._query)}return function(e,t,n,r){const i=new WP(r),s=new ZA(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>GA(await nx(e),s))),()=>{i.Wo(),e.asyncQueue.enqueueAndForget((async()=>QA(await nx(e),s)))}}(Ox(u),l,a,c)}function QD(e,t){return function(e,t){const n=new WP(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){vE(e).Gr.add(t),t.next()}(await nx(e),n))),()=>{n.Wo(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){vE(e).Gr.delete(t)}(await nx(e),n)))}}(Ox(e=vx(e,Dx)),Px(t)?t:{next:t})}function YD(e,t){return function(e,t){const n=new tR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=FP(e);try{const e=await function(e,t){const n=vE(e),r=SE.now(),i=t.reduce(((e,t)=>e.add(t.key)),VC());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>n.Fn.pn(e,i).next((i=>{s=i;const o=[];for(const e of t){const t=pC(e,s.get(e.key));null!=t&&o.push(new yC(e.key,t,aS(t.toProto().mapValue),uC.exists(!0)))}return n._n.addMutationBatch(e,r,o,t)})))).then((e=>(e.applyToLocalDocumentSet(s),{batchId:e.batchId,changes:s})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.xo[e.currentUser.toKey()];r||(r=new NC(IE)),r=r.insert(t,n),e.xo[e.currentUser.toKey()]=r}(r,e.batchId,n),await SP(r,e.changes),await NA(r.remoteStore)}catch(e){const t=BA(e,"Failed to persist write");n.reject(t)}}(await tx(e),t,n))),n.promise}(Ox(e),t)}function JD(e,t,n){const r=n.docs.get(t._key),i=new $D(e);return new ID(e,i,t._key,r,new bD(n.hasPendingWrites,n.fromCache),t.converter)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class XD extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Xx(e)}get(e){const t=WD(e,this._firestore),n=new VD(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return _E();const r=e[0];if(r.isFoundDocument())return new yD(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new yD(this._firestore,n,t._key,null,t.converter);throw _E()}))}set(e,t,n){const r=WD(e,this._firestore),i=jD(r.converter,t,n),s=Zx(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=WD(e,this._firestore);let s;return s="string"==typeof(t=Ia(t))||t instanceof Bx?aD(this._dataReader,"Transaction.update",i._key,t,n,r):oD(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=WD(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=WD(e,this._firestore),n=new $D(this._firestore);return super.get(e).then((e=>new ID(this._firestore,n,t._key,e._document,new bD(!1,!1),t.converter)))}}function ZD(e,t){return function(e,t){const n=new tR;return e.asyncQueue.enqueueAndForget((async()=>{const r=await function(e){return JP(e).then((e=>e.datastore))}(e);new KP(e.asyncQueue,r,t,n).run()})),n.promise}(Ox(e),(n=>t(new XD(e,n))))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */aE="9.0.0-beta.2",$a(new Ta("firestore-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=new Dx(n,e.getProvider("auth-internal"));return t&&r._setSettings(t),r}),"PUBLIC")),Ja("@firebase/firestore","0.0.900-exp.d92a36260",undefined);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const eO="(default)";class tO{constructor(e,t){this.projectId=e,this.database=t||eO}get isDefaultDatabase(){return this.database===eO}isEqual(e){return e instanceof tO&&e.projectId===this.projectId&&e.database===this.database}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let nO="8.6.1";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const rO=new Oa("@firebase/firestore");function iO(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function sO(e="Unexpected state"){const t=`FIRESTORE (${nO}) INTERNAL ASSERTION FAILED: `+e;throw function(e,...t){if(rO.logLevel<=ka.ERROR){const n=t.map(iO);rO.error(`Firestore (${nO}): ${e}`,...n)}}(t),new Error(t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const oO="invalid-argument",aO="failed-precondition",cO="unimplemented";class uO extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const lO="__name__";class hO{constructor(e,t,n){void 0===t?t=0:t>e.length&&sO(),void 0===n?n=e.length-t:n>e.length-t&&sO(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===hO.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof hO?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class dO extends hO{construct(e,t,n){return new dO(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new uO(oO,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new dO(t)}static emptyPath(){return new dO([])}}const fO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pO extends hO{construct(e,t,n){return new pO(e,t,n)}static isValidIdentifier(e){return fO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pO.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===lO}static keyField(){return new pO([lO])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new uO(oO,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new uO(oO,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new uO(oO,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new uO(oO,"Unterminated ` in path: "+e);return new pO(t)}static emptyPath(){return new pO([])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class gO{constructor(e){this.path=e}static fromPath(e){return new gO(dO.fromString(e))}static fromName(e){return new gO(dO.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===dO.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return dO.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new gO(new dO(e.slice()))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function mO(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new uO(oO,`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function _O(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new uO(oO,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){if(e.constructor){const t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":sO()}(e);throw new uO(oO,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function yO(){if("undefined"==typeof Uint8Array)throw new uO(cO,"Uint8Arrays are not available in this environment.")}function vO(){if("undefined"==typeof atob)throw new uO(cO,"Blobs are unavailable in Firestore in this environment.")}class wO{constructor(e){this._delegate=e}static fromBase64String(e){return vO(),new wO(Wx.fromBase64String(e))}static fromUint8Array(e){return yO(),new wO(Wx.fromUint8Array(e))}toBase64(){return vO(),this._delegate.toBase64()}toUint8Array(){return yO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function bO(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,["next","error","complete"])}class IO{enableIndexedDbPersistence(e,t){return function(e,t){Vx(e=vx(e,Dx));const n=Ox(e),r=e._freezeSettings(),i=new VP;return Mx(n,i,new qP(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){Vx(e=vx(e,Dx));const t=Ox(e),n=e._freezeSettings(),r=new VP;return Mx(t,r,new jP(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new lE(uE.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new tR;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!iR.gt())return Promise.resolve();const t=e+"main";await iR.delete(t)}(gN(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}(e._delegate)}}class TO{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof tO||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){e.merge&&delete(e=Object.assign(Object.assign({},this._delegate._getSettings()),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function(e,t,n,r={}){const i=(e=vx(e,Ix))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&gE("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){const t=Uo(r.mockUserToken),n=r.mockUserToken.sub||r.mockUserToken.user_id;if(!n)throw new lE(uE.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");e._credentials=new hx(new ux(t,new BN(n)))}}(this._delegate,e,t,n)}enableNetwork(){return Ux(this._delegate)}disableNetwork(){return qx(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,function(e,t,n,r){if(!0===t&&!0===r)throw new uO(oO,`${e} and ${n} cannot be used together.`)}("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore"),this._appCompat._removeServiceInstance("firestore-exp")),this._delegate._delete()}waitForPendingWrites(){return Fx(this._delegate)}onSnapshotsInSync(e){return QD(this._delegate,e)}get app(){if(!this._appCompat)throw new uO(aO,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new FO(this,Cx(this._delegate,e))}catch(e){throw NO(e,"collection()","Firestore.collection()")}}doc(e){try{return new RO(this,kx(this._delegate,e))}catch(e){throw NO(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new OO(this,function(e,t){if(e=vx(e,Ix),gx("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new lE(uE.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ex(e,null,function(e){return new NS(PE.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw NO(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return ZD(this._delegate,(t=>e(new SO(this,t))))}batch(){return Ox(this._delegate),new CO(new BD(this._delegate,(e=>YD(this._delegate,e))))}loadBundle(e){throw new uO(aO,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')}namedQuery(e){throw new uO(aO,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')}}class EO extends qD{constructor(e){super(),this.firestore=e}convertBytes(e){return new wO(new Wx(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return RO.forKey(t,this.firestore,null)}}class SO{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new EO(e)}get(e){const t=UO(e);return this._delegate.get(t).then((e=>new xO(this._firestore,new ID(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=UO(e);return n?(mO("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=UO(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=UO(e);return this._delegate.delete(t),this}}class CO{constructor(e){this._delegate=e}set(e,t,n){const r=UO(e);return n?(mO("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=UO(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=UO(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class kO{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new TD(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new DO(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=kO.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new kO(e,new EO(e),t),r.set(t,i)),i}}kO.INSTANCES=new WeakMap;class RO{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new EO(e)}static forPath(e,t,n){if(e.length%2!=0)throw new uO(oO,`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new RO(t,new Tx(t._delegate,n,new gO(e)))}static forKey(e,t,n){return new RO(t,new Tx(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new FO(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new FO(this.firestore,Cx(this._delegate,e))}catch(e){throw NO(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Ia(e))instanceof Tx&&Rx(this._delegate,e)}set(e,t){t=mO("DocumentReference.set",t);try{return function(e,t,n){e=vx(e,Tx);const r=vx(e.firestore,Dx),i=jD(e.converter,t,n);return YD(r,[Zx(Xx(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,uC.none())])}(this._delegate,e,t)}catch(e){throw NO(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?HD(this._delegate,e):HD(this._delegate,e,t,...n)}catch(e){throw NO(e,"updateDoc()","DocumentReference.update()")}}delete(){return function(e){return YD(vx(e.firestore,Dx),[new IC(e._key,uC.none())])}(this._delegate)}onSnapshot(...e){const t=AO(e),n=PO(e,(e=>new xO(this.firestore,new ID(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return GD(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?zD(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=vx(e,Tx);const t=vx(e.firestore,Dx);return rx(Ox(t),e._key,{source:"server"}).then((n=>JD(t,e,n)))}(this._delegate):function(e){e=vx(e,Tx);const t=vx(e.firestore,Dx);return rx(Ox(t),e._key).then((n=>JD(t,e,n)))}(this._delegate),t.then((e=>new xO(this.firestore,new ID(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new RO(this.firestore,e?this._delegate.withConverter(kO.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function NO(e,t,n){return e.message=e.message.replace(t,n),e}function AO(e){for(const t of e)if("object"==typeof t&&!bO(t))return t;return{}}function PO(e,t){var n,r;let i;return i=bO(e[0])?e[0]:bO(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class xO{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new RO(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return CD(this._delegate,e._delegate)}}class DO extends xO{data(e){return this._delegate.data(e)}}class OO{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new EO(e)}where(e,t,n){try{return new OO(this.firestore,ND(this._delegate,function(e,t,n){const r=t,i=wD("where",e);return new AD(i,r,n)}(e,t,n)))}catch(e){throw NO(e,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new OO(this.firestore,ND(this._delegate,function(e,t="asc"){const n=t,r=wD("orderBy",e);return new PD(r,n)}(e,t)))}catch(e){throw NO(e,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new OO(this.firestore,ND(this._delegate,function(e){return wx("limit",e),new xD("limit",e,"F")}(e)))}catch(e){throw NO(e,"limit()","Query.limit()")}}limitToLast(e){try{return new OO(this.firestore,ND(this._delegate,function(e){return wx("limitToLast",e),new xD("limitToLast",e,"L")}(e)))}catch(e){throw NO(e,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new OO(this.firestore,ND(this._delegate,function(...e){return new DD("startAt",e,!0)}(...e)))}catch(e){throw NO(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new OO(this.firestore,ND(this._delegate,function(...e){return new DD("startAfter",e,!1)}(...e)))}catch(e){throw NO(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new OO(this.firestore,ND(this._delegate,function(...e){return new OD("endBefore",e,!0)}(...e)))}catch(e){throw NO(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new OO(this.firestore,ND(this._delegate,function(...e){return new OD("endAt",e,!1)}(...e)))}catch(e){throw NO(e,"endAt()","Query.endAt()")}}isEqual(e){return Nx(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?KD(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=vx(e,Ex);const t=vx(e.firestore,Dx),n=Ox(t),r=new $D(t);return ix(n,e._query,{source:"server"}).then((n=>new ED(t,r,e,n)))}(this._delegate):function(e){e=vx(e,Ex);const t=vx(e.firestore,Dx),n=Ox(t),r=new $D(t);return kD(e._query),ix(n,e._query).then((n=>new ED(t,r,e,n)))}(this._delegate),t.then((e=>new MO(this.firestore,new ED(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(...e){const t=AO(e),n=PO(e,(e=>new MO(this.firestore,new ED(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return GD(this._delegate,t,n)}withConverter(e){return new OO(this.firestore,e?this._delegate.withConverter(kO.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class LO{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new DO(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class MO{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new OO(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new DO(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new LO(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new DO(this._firestore,n))}))}isEqual(e){return CD(this._delegate,e._delegate)}}class FO extends OO{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new RO(this.firestore,e):null}doc(e){try{return new RO(this.firestore,void 0===e?kx(this._delegate):kx(this._delegate,e))}catch(e){throw NO(e,"doc()","CollectionReference.doc()")}}add(e){return function(e,t){const n=vx(e.firestore,Dx),r=kx(e),i=jD(e.converter,t);return YD(n,[Zx(Xx(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,uC.exists(!1))]).then((()=>r))}(this._delegate,e).then((e=>new RO(this.firestore,e)))}isEqual(e){return Rx(this._delegate,e._delegate)}withConverter(e){return new FO(this.firestore,e?this._delegate.withConverter(kO.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function UO(e){return _O(e,Tx)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function qO(e){return function(e,t){const n=Ox(e=vx(e,Dx)),r=new xx;return sx(n,e._databaseId,t,r),r}(this._delegate,e)}function jO(e){return jx(this._delegate,e).then((e=>e?new OO(this,e):null))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class VO{constructor(...e){this._delegate=new Bx(...e)}static documentId(){return new VO(pO.keyField().canonicalString())}isEqual(e){return(e=Ia(e))instanceof Bx&&this._delegate._internalPath.isEqual(e._internalPath)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BO{constructor(e){this._delegate=e}static serverTimestamp(){const e=new nD("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new BO(e)}static delete(){const e=new eD("deleteField");return e._methodName="FieldValue.delete",new BO(e)}static arrayUnion(...e){const t=function(...e){return new rD("arrayUnion",e)}(...e);return t._methodName="FieldValue.arrayUnion",new BO(t)}static arrayRemove(...e){const t=function(...e){return new iD("arrayRemove",e)}(...e);return t._methodName="FieldValue.arrayRemove",new BO(t)}static increment(e){const t=function(e){return new sD("increment",e)}(e);return t._methodName="FieldValue.increment",new BO(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const WO={Firestore:TO,GeoPoint:zx,Timestamp:SE,Blob:wO,Transaction:SO,WriteBatch:CO,DocumentReference:RO,DocumentSnapshot:xO,Query:OO,QueryDocumentSnapshot:DO,QuerySnapshot:MO,CollectionReference:FO,FieldPath:VO,FieldValue:BO,setLogLevel:function(e){var t;t=e,rO.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){!function(e){nO=e}(e.SDK_VERSION),function(e,t){e.INTERNAL.registerComponent(new Ta("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore-exp").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},WO)))}(e,((e,t)=>new TO(e,t,new IO))),e.registerVersion("@firebase/firestore-compat","0.0.900-exp.d92a36260")}(oc),function(e){e.prototype.loadBundle=qO,e.prototype.namedQuery=jO}(TO);function $O(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function zO(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map((e=>zO(e)));if("function"==typeof e||"object"==typeof e)return $O(e,(e=>zO(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function KO(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>KO(e))):"function"==typeof e||"object"==typeof e?$O(e,(e=>KO(e))):e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const HO="functions-exp",GO={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QO extends Qo{constructor(e,t,n){super(`functions-exp/${e}`,t||""),this.details=n}}class YO{constructor(e,t){this.auth=null,this.messaging=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return this.messaging.getToken()}catch(e){return}}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken()}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const JO="us-central1";function XO(e){return new Promise(((t,n)=>{setTimeout((()=>{n(new QO("deadline-exceeded","deadline-exceeded"))}),e)}))}class ZO{constructor(e,t,n,r="us-central1",i){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new YO(t,n),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(r);this.customDomain=e.origin,this.region=JO}catch(e){this.customDomain=null,this.region=r}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function eL(e,t,n){return r=>async function(e,t,n,r){const i=e._url(t),s={data:n=zO(n)},o={},a=await e.contextProvider.getContext();a.authToken&&(o.Authorization="Bearer "+a.authToken);a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken);const c=r.timeout||7e4,u=await Promise.race([tL(i,s,o,e.fetchImpl),XO(c),e.cancelAllRequests]);if(!u)throw new QO("cancelled","Firebase Functions instance was deleted.");const l=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!GO[t])return new QO("internal","internal");r=GO[t],i=t}const s=e.message;"string"==typeof s&&(i=s),n=e.details,void 0!==n&&(n=KO(n))}}catch(e){}return"ok"===r?null:new QO(r,i,n)}(u.status,u.json);if(l)throw l;if(!u.json)throw new QO("internal","Response is not valid JSON object.");let h=u.json.data;void 0===h&&(h=u.json.result);if(void 0===h)throw new QO("internal","Response is missing data field.");return{data:KO(h)}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,r,n||{})}async function tL(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}function nL(e,t,n){!function(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}(Ia(e),t,n)}var rL;rL=fetch.bind(self),$a(new Ta(HO,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("messaging");return new ZO(n,r,i,t,rL)}),"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/functions-exp","0.0.900-exp.d92a36260");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class iL{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return function(e,t,n){return eL(Ia(e),t,n)}(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new Qo("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new Qo("functions","Port missing in origin provided to useFunctionsEmulator()");return nL(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return nL(this._delegate,e,t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const sL=(e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions-exp").getImmediate({identifier:null!=t?t:"us-central1"});return new iL(n,r)};function oL(e){return Array.prototype.slice.call(e)}function aL(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function cL(e,t,n){var r,i=new Promise((function(i,s){aL(r=e[t].apply(e,n)).then(i,s)}));return i.request=r,i}function uL(e,t,n){var r=cL(e,t,n);return r.then((function(e){if(e)return new gL(e,r.request)}))}function lL(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function hL(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return cL(this[t],r,arguments)})}))}function dL(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function fL(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return uL(this[t],r,arguments)})}))}function pL(e){this._index=e}function gL(e,t){this._cursor=e,this._request=t}function mL(e){this._store=e}function _L(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function yL(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new _L(n)}function vL(e){this._db=e}function wL(e,t,n){var r=cL(indexedDB,"open",[e,t]),i=r.request;return i&&(i.onupgradeneeded=function(e){n&&n(new yL(i.result,e.oldVersion,i.transaction))}),r.then((function(e){return new vL(e)}))}function bL(e){return cL(indexedDB,"deleteDatabase",[e])}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
!function(){const e={Functions:iL};oc.INTERNAL.registerComponent(new Ta("functions-compat",sL,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),oc.registerVersion("@firebase/functions-compat","0.0.900-exp.d92a36260"),lL(pL,"_index",["name","keyPath","multiEntry","unique"]),hL(pL,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),fL(pL,"_index",IDBIndex,["openCursor","openKeyCursor"]),lL(gL,"_cursor",["direction","key","primaryKey","value"]),hL(gL,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(gL.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,n),aL(t._request).then((function(e){if(e)return new gL(e,t._request)}))}))})})),mL.prototype.createIndex=function(){return new pL(this._store.createIndex.apply(this._store,arguments))},mL.prototype.index=function(){return new pL(this._store.index.apply(this._store,arguments))},lL(mL,"_store",["name","keyPath","indexNames","autoIncrement"]),hL(mL,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),fL(mL,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),dL(mL,"_store",IDBObjectStore,["deleteIndex"]),_L.prototype.objectStore=function(){return new mL(this._tx.objectStore.apply(this._tx,arguments))},lL(_L,"_tx",["objectStoreNames","mode"]),dL(_L,"_tx",IDBTransaction,["abort"]),yL.prototype.createObjectStore=function(){return new mL(this._db.createObjectStore.apply(this._db,arguments))},lL(yL,"_db",["name","version","objectStoreNames"]),dL(yL,"_db",IDBDatabase,["deleteObjectStore","close"]),vL.prototype.transaction=function(){return new _L(this._db.transaction.apply(this._db,arguments))},lL(vL,"_db",["name","version","objectStoreNames"]),dL(vL,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[mL,pL].forEach((function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t=oL(arguments),n=t[t.length-1],r=this._store||this._index,i=r[e].apply(r,t.slice(0,-1));i.onsuccess=function(){n(i.result)}})}))})),[pL,mL].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})}));const IL="0.0.900-exp.d92a36260",TL=1e4,EL=`w:${IL}`,SL="FIS_v2",CL=36e5,kL=new Yo("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function RL(e){return e instanceof Qo&&e.code.includes("request-failed")}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function NL({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function AL(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function PL(e,t){const n=(await t.json()).error;return kL.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function xL({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function DL(e,{refreshToken:t}){const n=xL(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t)),n}async function OL(e){const t=await e();return t.status>=500&&t.status<600?e():t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function LL(e){return new Promise((t=>{setTimeout(t,e)}))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const ML=/^[cdef][\w-]{21}$/;function FL(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e);return ML.test(t)?t:""}catch(e){return""}}function UL(e){return`${e.appName}!${e.appId}`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const qL=new Map;function jL(e,t){const n=UL(e);VL(n,t),function(e,t){const n=function(){!BL&&"BroadcastChannel"in self&&(BL=new BroadcastChannel("[Firebase] FID Change"),BL.onmessage=e=>{VL(e.data.key,e.data.fid)});return BL}();n&&n.postMessage({key:e,fid:t});0===qL.size&&BL&&(BL.close(),BL=null)}(n,t)}function VL(e,t){const n=qL.get(e);if(n)for(const e of n)e(t)}let BL=null;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const WL="firebase-installations-store";let $L=null;function zL(){return $L||($L=wL("firebase-installations-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(WL)}}))),$L}async function KL(e,t){const n=UL(e),r=(await zL()).transaction(WL,"readwrite"),i=r.objectStore(WL),s=await i.get(n);return await i.put(t,n),await r.complete,s&&s.fid===t.fid||jL(e,t.fid),t}async function HL(e){const t=UL(e),n=(await zL()).transaction(WL,"readwrite");await n.objectStore(WL).delete(t),await n.complete}async function GL(e,t){const n=UL(e),r=(await zL()).transaction(WL,"readwrite"),i=r.objectStore(WL),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.complete,!o||s&&s.fid===o.fid||jL(e,o.fid),o}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function QL(e){let t;const n=await GL(e,(n=>{const r=function(e){return XL(e||{fid:FL(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(kL.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:async function(e,t){try{return KL(e,await async function(e,{fid:t}){const n=NL(e),r=xL(e),i={fid:t,authVersion:SL,appId:e.appId,sdkVersion:EL},s={method:"POST",headers:r,body:JSON.stringify(i)},o=await OL((()=>fetch(n,s)));if(o.ok){const e=await o.json();return{fid:e.fid||t,registrationStatus:2,refreshToken:e.refreshToken,authToken:AL(e.authToken)}}throw await PL("Create Installation",o)}(e,t))}catch(n){throw RL(n)&&409===n.customData.serverCode?await HL(e):await KL(e,{fid:t.fid,registrationStatus:0}),n}}(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:YL(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function YL(e){let t=await JL(e);for(;1===t.registrationStatus;)await LL(100),t=await JL(e);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await QL(e);return n||t}return t}function JL(e){return GL(e,(e=>{if(!e)throw kL.create("installation-not-found");return XL(e)}))}function XL(e){return 1===(t=e).registrationStatus&&t.registrationTime+TL<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}async function ZL({appConfig:e,platformLoggerProvider:t},n){const r=function(e,{fid:t}){return`${NL(e)}/${t}/authTokens:generate`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,n),i=DL(e,n),s=t.getImmediate({optional:!0});s&&i.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:EL}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await OL((()=>fetch(r,a)));if(c.ok){return AL(await c.json())}throw await PL("Generate Auth Token",c)}async function eM(e,t=!1){let n;const r=await GL(e.appConfig,(r=>{if(!nM(r))throw kL.create("not-registered");const i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+CL}(e)}(i))return r;if(1===i.requestStatus)return n=async function(e,t){let n=await tM(e.appConfig);for(;1===n.authToken.requestStatus;)await LL(100),n=await tM(e.appConfig);const r=n.authToken;return 0===r.requestStatus?eM(e,t):r}(e,t),r;{if(!navigator.onLine)throw kL.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await ZL(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await KL(e.appConfig,r),n}catch(n){if(!RL(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await KL(e.appConfig,n)}else await HL(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function tM(e){return GL(e,(e=>{if(!nM(e))throw kL.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+TL<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}))}function nM(e){return void 0!==e&&2===e.registrationStatus}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function rM(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await QL(e);t&&await t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n.appConfig);return(await eM(n,t)).token}function iM(e){return kL.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const sM="installations-exp",oM=e=>{const t=za(e.getProvider("app-exp").getImmediate(),sM).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await QL(t.appConfig);return r?r.catch(console.error):eM(t).catch(console.error),n.fid}(t),getToken:e=>rM(t,e)}};$a(new Ta(sM,(e=>{const t=e.getProvider("app-exp").getImmediate();return{app:t,appConfig:function(e){if(!e||!e.options)throw iM("App Configuration");if(!e.name)throw iM("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw iM(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:za(t,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),$a(new Ta("installations-exp-internal",oM,"PRIVATE")),Ja("@firebase/installations-exp",IL);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const aM=new Yo("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function cM(e){return aM.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uM{constructor(e,t,n){this.onBackgroundMessageHandler=null,this.onMessageHandler=null;const r=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){if(!e||!e.options)throw cM("App Configuration Object");if(!e.name)throw cM("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw cM(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return this.deleteService()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const lM=e=>(
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(){return await Ho()&&"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}().then((e=>{if(!e)throw aM.create("unsupported-browser")})).catch((e=>{throw aM.create("indexed-db-unsupported")})),new uM(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate(),e.getProvider("analytics-internal")));
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const hM="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
   * in compliance with the License. You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software distributed under the License
   * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
   * or implied. See the License for the specific language governing permissions and limitations under
   * the License.
   */
var dM;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function fM(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function pM(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(dM||(dM={}));const gM="fcm_token_details_db",mM="fcm_token_object_Store";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const _M="firebase-messaging-store";let yM=null;function vM(){return yM||(yM=wL("firebase-messaging-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(_M)}}))),yM}async function wM(e){const t=IM(e),n=await vM(),r=await n.transaction(_M).objectStore(_M).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB&&!(await indexedDB.databases()).map((e=>e.name)).includes(gM))return null;let t=null;return(await wL(gM,5,(async n=>{var r;if(n.oldVersion<2)return;if(!n.objectStoreNames.contains(mM))return;const i=n.transaction.objectStore(mM),s=await i.index("fcmSenderId").get(e);if(await i.clear(),s)if(2===n.oldVersion){const e=s;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(r=e.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:fM(e.vapidKey)}}}else if(3===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:fM(e.auth),p256dh:fM(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:fM(e.vapidKey)}}}else if(4===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:fM(e.auth),p256dh:fM(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:fM(e.vapidKey)}}}}))).close(),await bL(gM),await bL("fcm_vapid_details_db"),await bL("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await bM(e,t),t}}async function bM(e,t){const n=IM(e),r=(await vM()).transaction(_M,"readwrite");return await r.objectStore(_M).put(t,n),await r.complete,t}function IM({appConfig:e}){return e.appId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function TM(e,t){const n={method:"DELETE",headers:await SM(e)};try{const r=await fetch(`${EM(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw aM.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw aM.create("token-unsubscribe-failed",{errorInfo:e})}}function EM({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function SM({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function CM({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==hM&&(i.web.applicationPubKey=r),i}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function kM(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:pM(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:fM(t.getKey("auth")),p256dh:fM(t.getKey("p256dh"))},r=await wM(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await SM(e),r=CM(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${EM(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw aM.create("token-update-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw aM.create("token-update-failed",{errorInfo:e})}if(!s.token)throw aM.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await bM(e.firebaseDependencies,r),n}catch(t){throw await RM(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await TM(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return NM(e.firebaseDependencies,n)}return NM(e.firebaseDependencies,n)}async function RM(e){const t=await wM(e.firebaseDependencies);t&&(await TM(e.firebaseDependencies,t.token),await async function(e){const t=IM(e),n=(await vM()).transaction(_M,"readwrite");await n.objectStore(_M).delete(t),await n.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function NM(e,t){const n={token:await async function(e,t){const n=await SM(e),r=CM(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(EM(e.appConfig),i);s=await t.json()}catch(e){throw aM.create("token-subscribe-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw aM.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw aM.create("token-subscribe-no-token");return s.token}(e,t),createTime:Date.now(),subscriptionOptions:t};return await bM(e,n),n.token}async function AM(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch((()=>{}))}catch(e){throw aM.create("failed-service-worker-registration",{browserErrorMessage:e.message})}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function PM(e,t){if(!navigator)throw aM.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw aM.create("permission-blocked");return await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=hM)}(e,null==t?void 0:t.vapidKey),await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){if(t||e.swRegistration||await AM(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw aM.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),kM(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function xM(e){return async function(e){if(!navigator)throw aM.create("only-available-in-window");return e.swRegistration||await AM(e),RM(e)}(e=Ia(e))}function DM(e,t){
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return function(e,t){if(!navigator)throw aM.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=Ia(e),t)}function OM(e,t){return function(e,t){if(void 0!==self.document)throw aM.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,()=>{e.onBackgroundMessageHandler=null}}(e=Ia(e),t)}$a(new Ta("messaging-exp",lM,"PUBLIC"));
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class LM{constructor(e,t){this.app=e,this._delegate=t,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.app=e,this._delegate=t}async getToken(e){return async function(e,t){return PM(e=Ia(e),t)}(this._delegate,e)}async deleteToken(){return xM(this._delegate)}onMessage(e){return DM(this._delegate,e)}onBackgroundMessage(e){return OM(this._delegate,e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const MM=e=>new LM(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-exp").getImmediate());
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var FM;oc.INTERNAL.registerComponent(new Ta("messaging-compat",MM,"PUBLIC")),oc.registerVersion("@firebase/messaging-compat","0.0.900-exp.d92a36260"),function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(FM||(FM={}));
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const UM="firebasestorage.googleapis.com";class qM extends Qo{constructor(e,t){super(jM(e),`Firebase Storage: ${t} (${jM(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,qM.prototype)}_codeEquals(e){return jM(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function jM(e){return"storage/"+e}function VM(){return new qM("unknown","An unknown error occurred, please check the error payload for server response.")}function BM(){return new qM("canceled","User canceled the upload/download.")}function WM(){return new qM("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function $M(e){return new qM("invalid-argument",e)}function zM(){return new qM("app-deleted","The Firebase app was deleted.")}function KM(e,t){return new qM("invalid-format","String does not match format '"+e+"': "+t)}function HM(e){throw new qM("internal-error","Internal error: "+e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class GM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=FM.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=FM.ABORT,e(this)})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=FM.NETWORK_ERROR,e(this)})),this.xhr_.addEventListener("load",(()=>{e(this)}))}))}send(e,t,n,r){if(this.sent_)throw HM("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw HM("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw HM("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponseText(){if(!this.sent_)throw HM("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QM{createXhrIo(){return new GM}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class YM{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=YM.makeFromUrl(e,t)}catch(t){return new YM(e,"")}if(""===n.path)return n;throw new qM("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===UM?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<a.length;t++){const r=a[t],i=r.regex.exec(e);if(i){const e=i[r.indices.bucket];let t=i[r.indices.path];t||(t=""),n=new YM(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new qM("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class JM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function XM(e){return"string"==typeof e||e instanceof String}function ZM(e){return eF()&&e instanceof Blob}function eF(){return"undefined"!=typeof Blob}function tF(e,t,n,r){if(r<t)throw $M(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw $M(`Invalid value for '${e}'. Expected ${n} or less.`)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function nF(e,t){const n=t.match(/^(\w+):\/\/.+/);let r=t;return null==(null==n?void 0:n[1])&&(r=`https://${t}`),`${r}/v0${e}`}function rF(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class iF{constructor(e,t,n,r,i,s,o,a,c,u,l){this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=this;function t(t,n){const r=e.resolve_,i=e.reject_,s=n.xhr;if(n.wasSuccessCode)try{const t=e.callback_(s,s.getResponseText());!
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){return void 0!==e}(t)?r():r(t)}catch(e){i(e)}else if(null!==s){const t=VM();t.serverResponse=s.getResponseText(),e.errorCallback_?i(e.errorCallback_(s,t)):i(t)}else if(n.canceled){i(e.appDelete_?zM():BM())}else{i(new qM("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}}this.canceled_?t(0,new sF(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=!1,o=0;function a(){return 2===o}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function l(t){i=setTimeout((()=>{i=null,e(h,a())}),t)}function h(e,...t){if(c)return;if(e)return void u.call(null,e,...t);if(a()||s)return void u.call(null,e,...t);let n;r<64&&(r*=2),1===o?(o=2,n=0):n=1e3*(r+Math.random()),l(n)}let d=!1;function f(e){d||(d=!0,c||(null!==i?(e||(o=2),clearTimeout(i),l(0)):e||(o=1)))}return l(0),setTimeout((()=>{s=!0,f(!0)}),n),f}((function(t,n){if(n)return void t(!1,new sF(!1,null,!0));const r=e.pool_.createXhrIo();function i(t){const n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)}e.pendingXhr_=r,null!==e.progressCallback_&&r.addUploadProgressListener(i),r.send(e.url_,e.method_,e.body_,e.headers_).then((n=>{null!==e.progressCallback_&&n.removeUploadProgressListener(i),e.pendingXhr_=null;const r=(n=n).getErrorCode()===FM.NO_ERROR,s=n.getStatus();if(!r||e.isRetryStatusCode_(s)){const e=n.getErrorCode()===FM.ABORT;return void t(!1,new sF(!1,null,e))}const o=-1!==e.successCodes_.indexOf(s);t(!0,new sF(o,n))}))}),t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class sF{constructor(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function oF(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function aF(...e){const t=oF();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(eF())return new Blob(e);throw new qM("unsupported-environment","This browser doesn't seem to support creating Blobs")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const cF="raw",uF="base64",lF="base64url",hF="data_url";class dF{constructor(e,t){this.data=e,this.contentType=t||null}}function fF(e,t){switch(e){case cF:return new dF(pF(t));case uF:case lF:return new dF(gF(e,t));case hF:return new dF(function(e){const t=new mF(e);return t.base64?gF(uF,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw KM(hF,"Malformed data URL.")}return pF(t)}(t.rest)}(t),new mF(t).contentType)}throw VM()}function pF(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function gF(e,t){switch(e){case uF:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw KM(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case lF:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw KM(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw KM(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class mF{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw KM(hF,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}class _F{constructor(e,t){let n=0,r="";ZM(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(ZM(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new _F(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new _F(n,!0)}}static getBlob(...e){if(eF()){const t=e.map((e=>e instanceof _F?e.data_:e));return new _F(aF.apply(null,t))}{const t=e.map((e=>XM(e)?fF(cF,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new _F(r,!0)}}uploadData(){return this.data_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function yF(e){let t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function vF(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function wF(e,t){return t}class bF{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||wF}}let IF=null;function TF(){if(IF)return IF;const e=[];e.push(new bF("bucket")),e.push(new bF("generation")),e.push(new bF("metageneration")),e.push(new bF("name","fullPath",!0));const t=new bF("name");t.xform=function(e,t){return function(e){return!XM(e)||e.length<2?e:vF(e)}(t)},e.push(t);const n=new bF("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new bF("timeCreated")),e.push(new bF("updated")),e.push(new bF("md5Hash",null,!0)),e.push(new bF("cacheControl",null,!0)),e.push(new bF("contentDisposition",null,!0)),e.push(new bF("contentEncoding",null,!0)),e.push(new bF("contentLanguage",null,!0)),e.push(new bF("contentType",null,!0)),e.push(new bF("metadata","customMetadata",!0)),IF=e,IF}function EF(e,t,n){const r={type:"file"},i=n.length;for(let e=0;e<i;e++){const i=n[e];r[i.local]=i.xform(r,t[i.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new YM(n,r);return t._makeStorageReference(i)}})}(r,e),r}function SF(e,t,n){const r=yF(t);if(null===r)return null;return EF(e,r,n)}function CF(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function kF(e,t,n){const r=yF(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(const i of n.prefixes){const n=i.replace(/\/$/,""),s=e._makeStorageReference(new YM(t,n));r.prefixes.push(s)}if(n.items)for(const i of n.items){const n=e._makeStorageReference(new YM(t,i.name));r.items.push(n)}return r}(e,t,r)}class RF{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function NF(e){if(!e)throw VM()}function AF(e,t){return function(n,r){const i=SF(e,r,t);return NF(null!==i),i}}function PF(e,t){return function(n,r){const i=SF(e,r,t);return NF(null!==i),function(e,t,n){const r=yF(t);if(null===r)return null;if(!XM(r.downloadTokens))return null;const i=r.downloadTokens;if(0===i.length)return null;const s=encodeURIComponent;return i.split(",").map((t=>{const r=e.bucket,i=e.fullPath;return nF("/b/"+s(r)+"/o/"+s(i),n)+rF({alt:"media",token:t})}))[0]}(i,r,e.host)}}function xF(e){return function(t,n){let r;var i;return 401===t.getStatus()?r=t.getResponseText().includes("Firebase App Check token is invalid")?new qM("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new qM("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new qM("quota-exceeded","Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):r=403===t.getStatus()?function(e){return new qM("unauthorized","User does not have permission to access '"+e+"'.")}(e.path):n,r.serverResponse=n.serverResponse,r}}function DF(e){const t=xF(e);return function(n,r){let i=t(n,r);return 404===n.getStatus()&&(i=function(e){return new qM("object-not-found","Object '"+e+"' does not exist.")}(e.path)),i.serverResponse=r.serverResponse,i}}function OF(e,t,n){const r=nF(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,s=new RF(r,"GET",AF(e,n),i);return s.errorHandler=DF(t),s}function LF(e,t,n,r,i){const s={};t.isRoot?s.prefix="":s.prefix=t.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=nF(t.bucketOnlyServerUrl(),e.host),a=e.maxOperationRetryTime,c=new RF(o,"GET",function(e,t){return function(n,r){const i=kF(e,t,r);return NF(null!==i),i}}(e,t.bucket),a);return c.urlParams=s,c.errorHandler=xF(t),c}function MF(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}class FF{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function UF(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){NF(!1)}return NF(!!n&&-1!==(t||["active"]).indexOf(n)),n}const qF=262144;function jF(e,t,n,r,i,s,o,a){const c=new FF(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new qM("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");const u=c.total-c.current;let l=u;i>0&&(l=Math.min(l,i));const h=c.current,d=h+l,f={"X-Goog-Upload-Command":l===u?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},p=r.slice(h,d);if(null===p)throw WM();const g=t.maxUploadRetryTime,m=new RF(n,"POST",(function(e,n){const i=UF(e,["active","final"]),o=c.current+l,a=r.size();let u;return u="final"===i?AF(t,s)(e,n):null,new FF(o,a,"final"===i,u)}),g);return m.headers=f,m.body=p.uploadData(),m.progressCallback=a||null,m.errorHandler=xF(e),m}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const VF="running",BF="paused",WF="success",$F="canceled",zF="error";function KF(e){switch(e){case"running":case"pausing":case"canceling":return VF;case"paused":return BF;case"success":return WF;case"canceled":return $F;case"error":default:return zF}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class HF{constructor(e,t,n){if(function(e){return"function"==typeof e}(e)||null!=t||null!=n)this.next=e,this.error=t,this.complete=n;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function GF(e){return(...t)=>{Promise.resolve().then((()=>e(...t)))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QF{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=TF(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{this._request=void 0,this._chunkMultiplier=1,e._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=e,this._transition("error"))},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals("canceled")?this.completeTransitions_():(this._error=e,this._transition("error"))},this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o=MF(t,r,i),a={name:o.fullPath},c=nF(s,e.host),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=CF(o,n),h=e.maxUploadRetryTime,d=new RF(c,"POST",(function(e){let t;UF(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){NF(!1)}return NF(XM(t)),t}),h);return d.urlParams=a,d.headers=u,d.body=l,d.errorHandler=xF(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=e.maxUploadRetryTime,s=new RF(n,"POST",(function(e){const t=UF(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){NF(!1)}n||NF(!1);const i=Number(n);return NF(!isNaN(i)),new FF(i,r.size(),"final"===t)}),i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=xF(t),s}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,t,n);this._request=i,i.getPromise().then((e=>{e=e,this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=qF*this._chunkMultiplier,t=new FF(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let s;try{s=jF(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const o=this._ref.storage._makeRequest(s,r,i);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){qF*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=OF(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=MF(t,r,i),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+CF(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=_F.getBlob(u,r,l);if(null===h)throw WM();const d={name:c.fullPath},f=nF(s,e.host),p=e.maxUploadRetryTime,g=new RF(f,"POST",AF(e,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=xF(t),g}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=BM(),this._state=e,this._notifyObservers();break;case"error":case"success":this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=KF(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new HF(t,n,r);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(KF(this._state)){case WF:GF(this._resolve.bind(null,this.snapshot))();break;case $F:case zF:GF(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(KF(this._state)){case VF:case BF:e.next&&GF(e.next.bind(e,this.snapshot))();break;case WF:e.complete&&GF(e.complete.bind(e))();break;case $F:case zF:e.error&&GF(e.error.bind(e,this._error))();break;default:e.error&&GF(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class YF{constructor(e,t){this._service=e,this._location=t instanceof YM?t:YM.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new YF(e,t)}get root(){const e=new YM(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return vF(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new YM(this._location.bucket,e);return new YF(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new qM("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function JF(e){const t={prefixes:[],items:[]};return XF(e,t).then((()=>t))}async function XF(e,t,n){const r={pageToken:n},i=await ZF(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await XF(e,t,i.nextPageToken)}async function ZF(e,t){null!=t&&"number"==typeof t.maxResults&&tF("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=LF(e.storage,e._location,"/",n.pageToken,n.maxResults);return(await e.storage.makeRequestWithTokens(r)).getPromise()}async function eU(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=nF(t.fullServerUrl(),e.host),s=CF(n,r),o=e.maxOperationRetryTime,a=new RF(i,"PATCH",AF(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=DF(t),a}(e.storage,e._location,t,TF());return(await e.storage.makeRequestWithTokens(n)).getPromise()}async function tU(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=nF(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,s=new RF(r,"GET",PF(e,n),i);return s.errorHandler=DF(t),s}(e.storage,e._location,TF());return(await e.storage.makeRequestWithTokens(t)).getPromise().then((e=>{if(null===e)throw new qM("no-download-url","The given file does not have any download URLs.");return e}))}async function nU(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=nF(t.fullServerUrl(),e.host),r=e.maxOperationRetryTime,i=new RF(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=DF(t),i}(e.storage,e._location);return(await e.storage.makeRequestWithTokens(t)).getPromise()}function rU(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new YM(e._location.bucket,n);return new YF(e.storage,r)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function iU(e,t){if(e instanceof aU){const n=e;if(null==n._bucket)throw new qM("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");const r=new YF(n,n._bucket);return null!=t?iU(r,t):r}if(void 0!==t){if(t.includes(".."))throw $M('`path` param cannot contain ".."');return rU(e,t)}return e}function sU(e,t){if(t&&function(e){return/^[A-Za-z]+:\/\//.test(e)}(t)){if(e instanceof aU)return new YF(e,t);throw $M("To use ref(service, url), the first argument must be a Storage instance.")}return iU(e,t)}function oU(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:YM.makeFromBucketSpec(n,e)}class aU{constructor(e,t,n,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=UM,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?YM.makeFromBucketSpec(i,this._host):oU(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=YM.makeFromBucketSpec(this._url,e):this._bucket=oU(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){tF("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){tF("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear(),Promise.resolve()}_makeStorageReference(e){return new YF(this,e)}_makeRequest(e,t,n){if(this._deleted)return new JM(zM());{const r=function(e,t,n,r,i,s){const o=rF(e.urlParams),a=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new iF(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i)}(e,this._appId,t,n,this._pool,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((()=>this._requests.delete(r)),(()=>this._requests.delete(r))),r}}async makeRequestWithTokens(e){const[t,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n)}}function cU(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new QF(e,new _F(t),n)}(e=Ia(e),t,n)}function uU(e){return async function(e){e._throwIfRoot("getMetadata");const t=OF(e.storage,e._location,TF());return(await e.storage.makeRequestWithTokens(t)).getPromise()}(e=Ia(e))}function lU(e,t){return sU(e=Ia(e),t)}function hU(e,{instanceIdentifier:t}){const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new aU(n,r,i,new QM,t,Ga)}$a(new Ta("storage-exp",hU,"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/storage","0.0.900-exp.d92a36260");class dU extends Qo{constructor(e,t){super(fU(e),`Firebase Storage: ${t} (${fU(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dU.prototype)}_codeEquals(e){return fU(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function fU(e){return"storage/"+e}function pU(e){return new dU("invalid-argument",e)}function gU(e,t){return new dU("invalid-format","String does not match format '"+e+"': "+t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const mU={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class _U{constructor(e,t){this.data=e,this.contentType=t||null}}function yU(e,t){switch(e){case mU.RAW:return new _U(vU(t));case mU.BASE64:case mU.BASE64URL:return new _U(wU(e,t));case mU.DATA_URL:return new _U(function(e){const t=new bU(e);return t.base64?wU(mU.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw gU(mU.DATA_URL,"Malformed data URL.")}return vU(t)}(t.rest)}(t),new bU(t).contentType)}throw new dU("unknown","An unknown error occurred, please check the error payload for server response.")}function vU(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function wU(e,t){switch(e){case mU.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw gU(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case mU.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw gU(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw gU(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class bU{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw gU(mU.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}const IU={STATE_CHANGED:"state_changed"},TU={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class EU{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class SU{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new EU(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new EU(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"==typeof t?e=>t(new EU(e,this,this._ref)):{next:t.next?e=>t.next(new EU(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class CU{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new kU(e,this._service)))}get items(){return this._delegate.items.map((e=>new kU(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *  http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class kU{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function(e,t){return rU(e,t)}(this._delegate,e);return new kU(t,this.storage)}get root(){return new kU(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new kU(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new SU(cU(this._delegate,e,t),this)}putString(e,t=cF,n){this._throwIfRoot("putString");const r=yU(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new SU(new QF(this._delegate,new _F(r.data,!0),i),this)}listAll(){return function(e){return JF(e=Ia(e))}(this._delegate).then((e=>new CU(e,this.storage)))}list(e){return function(e,t){return ZF(e=Ia(e),t)}(this._delegate,e||void 0).then((e=>new CU(e,this.storage)))}getMetadata(){return uU(this._delegate)}updateMetadata(e){return function(e,t){return eU(e=Ia(e),t)}(this._delegate,e)}getDownloadURL(){return function(e){return tU(e=Ia(e))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function(e){return nU(e=Ia(e))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw function(e){return new dU("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function RU(e){return/^[A-Za-z]+:\/\//.test(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class NU{constructor(e,t){this.app=e,this._delegate=t,this.INTERNAL={delete:()=>this._delegate._delete()}}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(RU(e))throw pU("ref() expected a child path but got a URL, use refFromURL instead.");return new kU(lU(this._delegate,e),this)}refFromURL(e){if(!RU(e))throw pU("refFromURL() expected a full URL but got a child path, use ref() instead.");try{YM.makeFromUrl(e,this._delegate.host)}catch(e){throw pU("refFromUrl() expected a valid full URL but got an invalid one.")}return new kU(lU(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t){!function(e,t,n){e.host=`http://${t}:${n}`}(this._delegate,e,t)}}function AU(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage-exp").getImmediate({identifier:t});return new NU(n,r)}!function(e){const t={TaskState:TU,TaskEvent:IU,StringFormat:mU,Storage:NU,Reference:kU};e.INTERNAL.registerComponent(new Ta("storage",AU,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.0.900-exp.d92a36260")}(oc);const PU="0.0.900-exp.d92a36260",xU=PU,DU="FB-PERF-TRACE-MEASURE",OU="_wt_",LU="_fcp",MU="_fid",FU="@firebase/performance/config",UU="@firebase/performance/configexpire",qU="Performance",jU=new Yo("performance",qU,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"Performance can only be initialized once."}),VU=new Oa(qU);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let BU,WU,$U,zU;VU.logLevel=ka.INFO;class KU{constructor(e){if(this.window=e,!e)throw jU.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Ko()||(VU.info("IndexedDB is not supported by current browswer"),!1):(VU.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver((e=>{for(const n of e.getEntries())t(n)})).observe({entryTypes:[e]})}static getInstance(){return void 0===BU&&(BU=new KU(WU)),BU}}function HU(){return $U}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function GU(e,t){const n=e.length-t.length;if(n<0||n>1)throw jU.create("invalid String merger input");const r=[];for(let n=0;n<e.length;n++)r.push(e.charAt(n)),t.length>n&&r.push(t.charAt(n));return r.join("")}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QU{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=GU("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=GU("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===zU&&(zU=new QU),zU}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var YU;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(YU||(YU={}));const JU=["firebase_","google_","ga_"],XU=new RegExp("^[a-zA-Z]\\w*$");function ZU(){const e=KU.getInstance().navigator;return"serviceWorker"in e?e.serviceWorker.controller?2:3:1}function eq(){switch(KU.getInstance().document.visibilityState){case"visible":return YU.VISIBLE;case"hidden":return YU.HIDDEN;default:return YU.UNKNOWN}}function tq(){const e=KU.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function nq(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.appId;if(!n)throw jU.create("no app id");return n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const rq="0.0.1",iq=!0,sq="FIREBASE_INSTALLATIONS_AUTH";function oq(e,t){const n=function(){const e=KU.getInstance().localStorage;if(!e)return;const t=e.getItem(UU);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;const r=e.getItem(FU);if(!r)return;try{return JSON.parse(r)}catch(e){return}}();return n?(cq(n),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then((e=>{})),t}(e.installations).then((n=>{const r=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!n)throw jU.create("no project id");return n}(e.app),i=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!n)throw jU.create("no api key");return n}(e.app),s=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${i}`,{method:"POST",headers:{Authorization:`${sq} ${n}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:n,app_id:nq(e.app),app_version:xU,sdk_version:rq})});return fetch(s).then((e=>{if(e.ok)return e.json();throw jU.create("RC response not ok")}))})).catch((()=>{VU.info(aq)}))}(e,t).then(cq).then((e=>function(e){const t=KU.getInstance().localStorage;if(!e||!t)return;t.setItem(FU,JSON.stringify(e)),t.setItem(UU,String(Date.now()+60*QU.getInstance().configTimeToLive*60*1e3))}(e)),(()=>{}))}const aq="Could not fetch config, will use default configs";function cq(e){if(!e)return e;const t=QU.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=iq,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=uq(t.tracesSamplingRate),t.logNetworkAfterSampling=uq(t.networkRequestsSamplingRate),e}function uq(e){return Math.random()<=e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let lq,hq=1;function dq(e){return hq=2,lq=lq||function(e){return function(){const e=KU.getInstance().document;return new Promise((t=>{if(e&&"complete"!==e.readyState){const n=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()}))}().then((()=>function(e){const t=e.getId();return t.then((e=>{$U=e})),t}(e.installations))).then((t=>oq(e,t))).then((()=>fq()),(()=>fq()))}(e),lq}function fq(){hq=3}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const pq=1e4;let gq,mq=3,_q=[],yq=!1;function vq(e){setTimeout((()=>{if(0!==mq)return _q.length?void function(){const e=_q.splice(0,1e3),t=e.map((e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)})));(function(e,t){return function(e){const t=QU.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then((e=>(e.ok||VU.info("Call to Firebase backend failed."),e.json()))).then((e=>{const n=Number(e.nextRequestWaitMillis);let r=pq;isNaN(n)||(r=Math.max(n,r));const i=e.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(_q=[...t,..._q],VU.info("Retry transport request later.")),mq=3,vq(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:QU.getInstance().logSource,log_event:t},e).catch((()=>{_q=[...e,..._q],mq--,VU.info(`Tries left: ${mq}.`),vq(pq)}))}():vq(pq)}),e)}function wq(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw jU.create("invalid cc log");_q=[..._q,e]}({message:e(...t),eventTime:Date.now()})}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function bq(e,t){gq||(gq=wq(Eq)),gq(e,t)}function Iq(e){const t=QU.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&KU.getInstance().requiredApisAvailable()&&(e.isAuto&&eq()!==YU.VISIBLE||(3===hq?Tq(e):dq(e.performanceController).then((()=>Tq(e)),(()=>Tq(e)))))}function Tq(e){if(!HU())return;const t=QU.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&setTimeout((()=>bq(e,1)),0)}function Eq(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:Sq(e.performanceController.app),network_request_metric:t};return JSON.stringify(n)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);const r={application_info:Sq(e.performanceController.app),trace_metric:t};return JSON.stringify(r)}(e)}function Sq(e){return{google_app_id:nq(e),app_instance_id:HU(),web_app_info:{sdk_version:xU,page_url:KU.getInstance().getUrl(),service_worker_status:ZU(),visibility_state:eq(),effective_connection_type:tq()},application_process_state:0}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Cq=["_fp",LU,MU];
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class kq{constructor(e,t,n=!1,r){this.performanceController=e,this.name=t,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=KU.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`FB-PERF-TRACE-MEASURE-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw jU.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw jU.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Iq(this)}record(e,t,n){if(e<=0)throw jU.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw jU.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const e of Object.keys(n.metrics))isNaN(Number(n.metrics[e]))||(this.counters[e]=Number(Math.floor(n.metrics[e])));Iq(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(!function(e,t){return!(0===e.length||e.length>100)&&(t&&t.startsWith(OU)&&Cq.indexOf(e)>-1||!e.startsWith("_"))}(e,this.name))throw jU.create("invalid custom metric name",{customMetricName:e});this.counters[e]=function(e){const t=Math.floor(e);return t<e&&VU.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(t)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const n=function(e){return!(0===e.length||e.length>40)&&(!JU.some((t=>e.startsWith(t)))&&!!e.match(XU))}(e),r=function(e){return 0!==e.length&&e.length<=100}(t);if(n&&r)this.customAttributes[e]=t;else{if(!n)throw jU.create("invalid attribute name",{attributeName:e});if(!r)throw jU.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n,r){const i=KU.getInstance().getUrl();if(!i)return;const s=new kq(e,OU+i,!0),o=Math.floor(1e3*KU.getInstance().getTimeOrigin());s.setStartTime(o),t&&t[0]&&(s.setDuration(Math.floor(1e3*t[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(n){const e=n.find((e=>"first-paint"===e.name));e&&e.startTime&&s.putMetric("_fp",Math.floor(1e3*e.startTime));const t=n.find((e=>"first-contentful-paint"===e.name));t&&t.startTime&&s.putMetric(LU,Math.floor(1e3*t.startTime)),r&&s.putMetric(MU,Math.floor(1e3*r))}Iq(s)}static createUserTimingTrace(e,t){Iq(new kq(e,t,!1,t))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Rq(e,t){const n=t;if(!n||void 0===n.responseStart)return;const r=KU.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(e){const t=QU.getInstance();if(!t.instrumentationEnabled)return;const n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout((()=>bq(e,0)),0)}({performanceController:e,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Nq(e){HU()&&(setTimeout((()=>function(e){const t=KU.getInstance(),n=t.getEntriesByType("navigation"),r=t.getEntriesByType("paint");if(t.onFirstInputDelay){let i=setTimeout((()=>{kq.createOobTrace(e,n,r),i=void 0}),5e3);t.onFirstInputDelay((t=>{i&&(clearTimeout(i),kq.createOobTrace(e,n,r,t))}))}else kq.createOobTrace(e,n,r)}(e)),0),setTimeout((()=>function(e){const t=KU.getInstance(),n=t.getEntriesByType("resource");for(const t of n)Rq(e,t);t.setupObserver("resource",(t=>Rq(e,t)))}(e)),0),setTimeout((()=>function(e){const t=KU.getInstance(),n=t.getEntriesByType("measure");for(const t of n)Aq(e,t);t.setupObserver("measure",(t=>Aq(e,t)))}(e)),0))}function Aq(e,t){const n=t.name;n.substring(0,DU.length)!==DU&&kq.createUserTimingTrace(e,n)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Pq{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),KU.getInstance().requiredApisAvailable()?Ho().then((e=>{e&&(yq||(vq(5500),yq=!0),dq(this).then((()=>Nq(this)),(()=>Nq(this))),this.initialized=!0)})).catch((e=>{VU.info(`Environment doesn't support IndexedDB: ${e}`)})):VU.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){QU.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return QU.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){QU.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return QU.getInstance().dataCollectionEnabled}}$a(new Ta("performance-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("installations-exp-internal").getImmediate();if("[DEFAULT]"!==n.name)throw jU.create("FB not default");if("undefined"==typeof window)throw jU.create("no window");!function(e){WU=e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(window);const i=new Pq(n,r);return i._init(t),i}),"PUBLIC")),Ja("@firebase/performance-exp",PU);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class xq{constructor(e,t){this.app=e,this._delegate=t}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return function(e,t){return e=Ia(e),new kq(e,t)}(this._delegate,e)}}function Dq(e){const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("performance-exp").getImmediate();return new xq(t,n)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var Oq;(Oq=oc).INTERNAL.registerComponent(new Ta("performance-compat",Dq,"PUBLIC")),Oq.registerVersion("@firebase/performance-compat","0.0.900-exp.d92a36260");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Lq="analytics-exp",Mq="https://www.googletagmanager.com/gtag/js",Fq=new Oa("@firebase/analytics");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Uq(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function qq(e,t,n,r){return async function(i,s,o){try{"event"===i?await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await Uq(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){Fq.error(e)}}(e,t,n,s,o):"config"===i?await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await Uq(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){Fq.error(e)}e("config",i,s)}(e,t,n,r,s,o):e("set",s)}catch(e){Fq.error(e)}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const jq=new Yo("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'});const Vq=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Bq(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Wq(e,t=Vq,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw jq.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw jq.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new zq;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),$q({appId:r,apiKey:i,measurementId:s},o,a,t)}async function $q(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=Vq){const{appId:s,measurementId:o}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(jq.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(o)return Fq.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:s,measurementId:o};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:Bq(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw jq.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(s),t}catch(t){if(!function(e){if(!(e instanceof Qo&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(s),o)return Fq.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:s,measurementId:o};throw t}const a=503===Number(t.customData.httpStatus)?ba(n,i.intervalMillis,30):ba(n,i.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return i.setThrottleMetadata(s,c),Fq.debug(`Calling attemptFetch again in ${a} millis`),$q(e,c,r,i)}}class zq{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Kq(e,t,n,r,i,s){const o=Wq(e);o.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Fq.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Fq.error(e))),t.push(o);const a=async function(){if(!Ko())return Fq.warn(jq.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await Ho()}catch(e){return Fq.warn(jq.create("indexeddb-unavailable",{errorInfo:e}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[c,u]=await Promise.all([o,a]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Mq))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${Mq}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,c.measurementId),i("js",new Date);const l={origin:"firebase",update:!0};return null!=u&&(l.firebase_id=u),i("config",c.measurementId,l),c.measurementId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Hq{constructor(e){this.app=e}_delete(){return delete Gq[this.app.options.appId],Promise.resolve()}}let Gq={},Qq=[];const Yq={};let Jq,Xq,Zq="dataLayer",ej="gtag",tj=!1;function nj(e){if(tj)throw jq.create("already-initialized");e.dataLayerName&&(Zq=e.dataLayerName),e.gtagName&&(ej=e.gtagName)}function rj(e,t){!function(){const e=[];if(Bo()&&e.push("This is a browser extension environment."),Go()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=jq.create("invalid-analytics-context",{errorInfo:t});Fq.warn(n.message)}}();const n=e.options.appId;if(!n)throw jq.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw jq.create("no-api-key");Fq.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Gq[n])throw jq.create("already-exists",{id:n});if(!tj){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(Zq);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=qq(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(Gq,Qq,Yq,Zq,ej);Xq=e,Jq=t,tj=!0}Gq[n]=Kq(e,Qq,Yq,t,Jq,Zq);return new Hq(e)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function ij(){if(Bo())return!1;if(!Go())return!1;if(!Ko())return!1;try{return await Ho()}catch(e){return!1}}function sj(e,t,n){e=Ia(e),async function(e,t,n,r){if(r&&r.global)return e("set",{screen_name:n}),Promise.resolve();e("config",await t,{update:!0,screen_name:n})}(Xq,Gq[e.app.options.appId],t,n).catch((e=>Fq.error(e)))}function oj(e,t,n){e=Ia(e),async function(e,t,n,r){if(r&&r.global)return e("set",{user_id:n}),Promise.resolve();e("config",await t,{update:!0,user_id:n})}(Xq,Gq[e.app.options.appId],t,n).catch((e=>Fq.error(e)))}function aj(e,t,n){e=Ia(e),async function(e,t,n,r){if(r&&r.global){const t={};for(const e of Object.keys(n))t[`user_properties.${e}`]=n[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}(Xq,Gq[e.app.options.appId],t,n).catch((e=>Fq.error(e)))}function cj(e,t){e=Ia(e),async function(e,t){const n=await e;window[`ga-disable-${n}`]=!t}(Gq[e.app.options.appId],t).catch((e=>Fq.error(e)))}function uj(e,t,n,r){e=Ia(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Xq,Gq[e.app.options.appId],t,n,r).catch((e=>Fq.error(e)))}$a(new Ta(Lq,(e=>rj(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate())),"PUBLIC")),$a(new Ta("analytics-internal",(function(e){try{const t=e.getProvider(Lq).getImmediate();return{logEvent:(e,n,r)=>uj(t,e,n,r)}}catch(e){throw jq.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Ja("@firebase/analytics-exp","0.0.900-exp.d92a36260");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class lj{constructor(e,t){this.app=e,this._delegate=t}logEvent(e,t,n){uj(this._delegate,e,t,n)}setCurrentScreen(e,t){sj(this._delegate,e,t)}setUserId(e,t){oj(this._delegate,e,t)}setUserProperties(e,t){aj(this._delegate,e,t)}setAnalyticsCollectionEnabled(e){cj(this._delegate,e)}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var hj;!function(e){e.ADD_SHIPPING_INFO="add_shipping_info",e.ADD_PAYMENT_INFO="add_payment_info",e.ADD_TO_CART="add_to_cart",e.ADD_TO_WISHLIST="add_to_wishlist",e.BEGIN_CHECKOUT="begin_checkout",e.CHECKOUT_PROGRESS="checkout_progress",e.EXCEPTION="exception",e.GENERATE_LEAD="generate_lead",e.LOGIN="login",e.PAGE_VIEW="page_view",e.PURCHASE="purchase",e.REFUND="refund",e.REMOVE_FROM_CART="remove_from_cart",e.SCREEN_VIEW="screen_view",e.SEARCH="search",e.SELECT_CONTENT="select_content",e.SELECT_ITEM="select_item",e.SELECT_PROMOTION="select_promotion",e.SET_CHECKOUT_OPTION="set_checkout_option",e.SHARE="share",e.SIGN_UP="sign_up",e.TIMING_COMPLETE="timing_complete",e.VIEW_CART="view_cart",e.VIEW_ITEM="view_item",e.VIEW_ITEM_LIST="view_item_list",e.VIEW_PROMOTION="view_promotion",e.VIEW_SEARCH_RESULTS="view_search_results"}(hj||(hj={}));
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const dj=e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("analytics-exp").getImmediate();return new lj(t,n)};!function(){const e={Analytics:lj,settings:nj,isSupported:ij,EventName:hj};oc.INTERNAL.registerComponent(new Ta("analytics-compat",dj,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),oc.registerVersion("@firebase/analytics-compat","0.0.900-exp.d92a36260");const fj="@firebase/remote-config-exp";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class pj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const gj=new Yo("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const mj=["1","true","t","yes","y","on"];class _j{constructor(e,t=""){this._source=e,this._value=t}asString(){return this._value}asBoolean(){return"static"!==this._source&&mj.indexOf(this._value.toLowerCase())>=0}asNumber(){if("static"===this._source)return 0;let e=Number(this._value);return isNaN(e)&&(e=0),e}getSource(){return this._source}}async function yj(e){const t=Ia(e),[n,r]=await Promise.all([t._storage.getLastSuccessfulFetchResponse(),t._storage.getActiveConfigEtag()]);return!!(n&&n.config&&n.eTag&&n.eTag!==r)&&(await Promise.all([t._storageCache.setActiveConfig(n.config),t._storage.setActiveConfigEtag(n.eTag)]),!0)}function vj(e){const t=Ia(e);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then((()=>{t._isInitializationComplete=!0}))),t._initializePromise}async function wj(e){const t=Ia(e),n=new pj;setTimeout((async()=>{n.abort()}),t.settings.fetchTimeoutMillis);try{await t._client.fetch({cacheMaxAgeMillis:t.settings.minimumFetchIntervalMillis,signal:n}),await t._storageCache.setLastFetchStatus("success")}catch(e){const n=function(e,t){return e instanceof Qo&&-1!==e.code.indexOf(t)}(e,"fetch-throttle")?"throttle":"failure";throw await t._storageCache.setLastFetchStatus(n),e}}function bj(e){const t=Ia(e);return function(e={},t={}){return Object.keys(Object.assign(Object.assign({},e),t))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t._storageCache.getActiveConfig(),t.defaultConfig).reduce(((t,n)=>(t[n]=Ij(e,n),t)),{})}function Ij(e,t){const n=Ia(e);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${t}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&void 0!==r[t]?new _j("remote",r[t]):n.defaultConfig&&void 0!==n.defaultConfig[t]?new _j("default",String(n.defaultConfig[t])):(n._logger.debug(`Returning static value for key "${t}". Define a default or remote value if this is unintentional.`),new _j("static"))}class Tj{constructor(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,r=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[t,n]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(n&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return n;e.eTag=n&&n.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===r.status&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Ej(e=navigator){return e.languages&&e.languages[0]||e.language}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Sj{constructor(e,t,n,r,i,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}async fetch(e){const[t,n]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),r=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,i={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:n,app_id:this.appId,language_code:Ej()},o={method:"POST",headers:i,body:JSON.stringify(s)},a=fetch(r,o),c=new Promise(((t,n)=>{e.signal.addEventListener((()=>{const e=new Error("The operation was aborted.");e.name="AbortError",n(e)}))}));let u;try{await Promise.race([a,c]),u=await a}catch(e){let t="fetch-client-network";throw"AbortError"===e.name&&(t="fetch-timeout"),gj.create(t,{originalErrorMessage:e.message})}let l=u.status;const h=u.headers.get("ETag")||void 0;let d,f;if(200===u.status){let e;try{e=await u.json()}catch(e){throw gj.create("fetch-client-parse",{originalErrorMessage:e.message})}d=e.entries,f=e.state}if("INSTANCE_STATE_UNSPECIFIED"===f?l=500:"NO_CHANGE"===f?l=304:"NO_TEMPLATE"!==f&&"EMPTY_CONFIG"!==f||(d={}),304!==l&&200!==l)throw gj.create("fetch-status",{httpStatus:l});return{status:l,eTag:h,config:d}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Cj{constructor(e,t){this.client=e,this.storage=t}async fetch(e){const t=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)}async attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(gj.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(e.signal,t);try{const t=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),t}catch(t){if(!function(e){if(!(e instanceof Qo&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t))throw t;const r={throttleEndTimeMillis:Date.now()+ba(n),backoffCount:n+1};return await this.storage.setThrottleMetadata(r),this.attemptFetch(e,r)}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class kj{constructor(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Rj(e,t){const n=e.target.error||void 0;return gj.create(t,{originalErrorMessage:n&&n.message})}const Nj="app_namespace_store";class Aj{constructor(e,t,n,r=function(){return new Promise(((e,t)=>{const n=indexedDB.open("firebase_remote_config",1);n.onerror=e=>{t(Rj(e,"storage-open"))},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{const t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(Nj,{keyPath:"compositeKey"})}}}))}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([Nj],"readonly").objectStore(Nj),s=this.createCompositeKey(e);try{const e=i.get(s);e.onerror=e=>{r(Rj(e,"storage-get"))},e.onsuccess=e=>{const t=e.target.result;n(t?t.value:void 0)}}catch(e){r(gj.create("storage-get",{originalErrorMessage:e&&e.message}))}}))}async set(e,t){const n=await this.openDbPromise;return new Promise(((r,i)=>{const s=n.transaction([Nj],"readwrite").objectStore(Nj),o=this.createCompositeKey(e);try{const e=s.put({compositeKey:o,value:t});e.onerror=e=>{i(Rj(e,"storage-set"))},e.onsuccess=()=>{r()}}catch(e){i(gj.create("storage-set",{originalErrorMessage:e&&e.message}))}}))}async delete(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([Nj],"readwrite").objectStore(Nj),s=this.createCompositeKey(e);try{const e=i.delete(s);e.onerror=e=>{r(Rj(e,"storage-delete"))},e.onsuccess=()=>{n()}}catch(e){r(gj.create("storage-delete",{originalErrorMessage:e&&e.message}))}}))}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Pj{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await t;i&&(this.lastSuccessfulFetchTimestampMillis=i);const s=await n;s&&(this.activeConfig=s)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */$a(new Ta("remote-config-exp",(function(e,{instanceIdentifier:t}){const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("installations-exp-internal").getImmediate();if("undefined"==typeof window)throw gj.create("registration-window");const{projectId:i,apiKey:s,appId:o}=n.options;if(!i)throw gj.create("registration-project-id");if(!s)throw gj.create("registration-api-key");if(!o)throw gj.create("registration-app-id");t=t||"firebase";const a=new Aj(o,n.name,t),c=new Pj(a),u=new Oa(fj);u.logLevel=ka.ERROR;const l=new Sj(r,Ga,t,i,s,o),h=new Cj(l,a),d=new Tj(h,a,c,u),f=new kj(n,d,c,a,u);return vj(f),f}),"PUBLIC").setMultipleInstances(!0)),Ja(fj,"0.0.900-exp.d92a36260");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class xj{constructor(e,t){this.app=e,this._delegate=t}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return yj(this._delegate)}ensureInitialized(){return vj(this._delegate)}fetch(){return wj(this._delegate)}fetchAndActivate(){
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e){return e=Ia(e),await wj(e),yj(e)}(this._delegate)}getAll(){return bj(this._delegate)}getBoolean(e){return function(e,t){return Ij(Ia(e),t).asBoolean()}(this._delegate,e)}getNumber(e){return function(e,t){return Ij(Ia(e),t).asNumber()}(this._delegate,e)}getString(e){return function(e,t){return Ij(Ia(e),t).asString()}(this._delegate,e)}getValue(e){return Ij(this._delegate,e)}setLogLevel(e){!function(e,t){const n=Ia(e);switch(t){case"debug":n._logger.logLevel=ka.DEBUG;break;case"silent":n._logger.logLevel=ka.SILENT;break;default:n._logger.logLevel=ka.ERROR}}(this._delegate,e)}}function Dj(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("remote-config-exp").getImmediate({identifier:t});return new xj(n,r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return function(e){e.INTERNAL.registerComponent(new Ta("remoteConfig-compat",Dj,"PUBLIC").setMultipleInstances(!0)),e.registerVersion("@firebase/remote-config-compat","0.0.900-exp.d92a36260")}(oc),
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),oc.registerVersion("firebase-exp","9.0.0-beta.2","compat-cdn"),oc}));
